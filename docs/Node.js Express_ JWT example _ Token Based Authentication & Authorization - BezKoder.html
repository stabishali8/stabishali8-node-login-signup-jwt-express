<!DOCTYPE html>
<!-- saved from url=(0054)https://bezkoder.com/node-js-jwt-authentication-mysql/ -->
<html class="no-js" lang="en-US"><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="theme-color" content=""><meta name="author" content="bezkoder"><link rel="profile" href="http://gmpg.org/xfn/11"><link media="all" href="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/autoptimize_92f4aee14f54fb0a07dd855c1e913392.css" rel="stylesheet"><title>Node.js Express: JWT example | Token Based Authentication &amp; Authorization - BezKoder</title><link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin=""><style type="text/css">@font-face {
 font-family: 'Open Sans';
 font-style: italic;
 font-weight: 400;
 font-display: swap;
 src: url(https://fonts.gstatic.com/s/opensans/v18/mem6YaGs126MiZpBA-UFUK0Zdcg.ttf) format('truetype');
}
@font-face {
 font-family: 'Open Sans';
 font-style: normal;
 font-weight: 400;
 font-display: swap;
 src: url(https://fonts.gstatic.com/s/opensans/v18/mem8YaGs126MiZpBA-UFVZ0e.ttf) format('truetype');
}
@font-face {
 font-family: 'Open Sans';
 font-style: normal;
 font-weight: 600;
 font-display: swap;
 src: url(https://fonts.gstatic.com/s/opensans/v18/mem5YaGs126MiZpBA-UNirkOUuhs.ttf) format('truetype');
}
@font-face {
 font-family: 'Open Sans';
 font-style: normal;
 font-weight: 700;
 font-display: swap;
 src: url(https://fonts.gstatic.com/s/opensans/v18/mem5YaGs126MiZpBA-UN7rgOUuhs.ttf) format('truetype');
}
@font-face {
 font-family: 'Roboto Slab';
 font-style: normal;
 font-weight: 300;
 font-display: swap;
 src: url(https://fonts.gstatic.com/s/robotoslab/v13/BngbUXZYTXPIvIBgJJSb6s3BzlRRfKOFbvjo0oSmb2Rm.ttf) format('truetype');
}
@font-face {
 font-family: 'Roboto Slab';
 font-style: normal;
 font-weight: 400;
 font-display: swap;
 src: url(https://fonts.gstatic.com/s/robotoslab/v13/BngbUXZYTXPIvIBgJJSb6s3BzlRRfKOFbvjojISmb2Rm.ttf) format('truetype');
}
@font-face {
 font-family: 'Roboto Slab';
 font-style: normal;
 font-weight: 700;
 font-display: swap;
 src: url(https://fonts.gstatic.com/s/robotoslab/v13/BngbUXZYTXPIvIBgJJSb6s3BzlRRfKOFbvjoa4Omb2Rm.ttf) format('truetype');
} </style><link rel="preload" as="font" href="https://fonts.googleapis.com/css?family=Open+Sans%3A400italic%2C400%2C600%2C700%7CRoboto+Slab%3A400%2C300%2C700&amp;display=swap" crossorigin=""><meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><link rel="canonical" href="https://bezkoder.com/node-js-jwt-authentication-mysql/"><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="Node.js Express: JWT example | Token Based Authentication &amp; Authorization - BezKoder"><meta property="og:description" content="In this tutorial, we’re gonna build a Node.js Express Rest API example that supports Token Based Authentication with JWT (JSONWebToken). You’ll know: Appropriate Flow for User Signup &amp; User Login with JWT Authentication Node.js Express Architecture with CORS, Authenticaton &amp; Authorization middlewares &amp; Sequelize How to configure Express routes to work with JWT How to […]"><meta property="og:url" content="https://bezkoder.com/node-js-jwt-authentication-mysql/"><meta property="og:site_name" content="BezKoder"><meta property="article:publisher" content="https://www.facebook.com/bezkoder"><meta property="article:published_time" content="2019-11-14T15:09:13+00:00"><meta property="article:modified_time" content="2020-12-25T08:13:39+00:00"><meta property="og:image" content="https://bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-feature-image.png"><meta property="og:image:width" content="750"><meta property="og:image:height" content="410"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:label1" content="Written by"><meta name="twitter:data1" content="bezkoder"><meta name="twitter:label2" content="Est. reading time"><meta name="twitter:data2" content="16 minutes"> <script type="text/javascript" async="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/analytics.js.download"></script><script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebSite","@id":"https://bezkoder.com/#website","url":"https://bezkoder.com/","name":"BezKoder","description":"Mobile &amp; Web App Development Tutorials","potentialAction":[{"@type":"SearchAction","target":"https://bezkoder.com/?s={search_term_string}","query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"ImageObject","@id":"https://bezkoder.com/node-js-jwt-authentication-mysql/#primaryimage","inLanguage":"en-US","url":"https://bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-feature-image.png","width":750,"height":410,"caption":"node-js-jwt-authentication-mysql-feature-image"},{"@type":"WebPage","@id":"https://bezkoder.com/node-js-jwt-authentication-mysql/#webpage","url":"https://bezkoder.com/node-js-jwt-authentication-mysql/","name":"Node.js Express: JWT example | Token Based Authentication & Authorization - BezKoder","isPartOf":{"@id":"https://bezkoder.com/#website"},"primaryImageOfPage":{"@id":"https://bezkoder.com/node-js-jwt-authentication-mysql/#primaryimage"},"datePublished":"2019-11-14T15:09:13+00:00","dateModified":"2020-12-25T08:13:39+00:00","author":{"@id":"https://bezkoder.com/#/schema/person/14b0bd934f1a56553942c69379c55586"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://bezkoder.com/node-js-jwt-authentication-mysql/"]}]},{"@type":"Person","@id":"https://bezkoder.com/#/schema/person/14b0bd934f1a56553942c69379c55586","name":"bezkoder","image":{"@type":"ImageObject","@id":"https://bezkoder.com/#personlogo","inLanguage":"en-US","url":"https://secure.gravatar.com/avatar/40150b9299e69015bc46c30598a81888?s=96&d=mm&r=g","caption":"bezkoder"}}]}</script><link href="https://fonts.gstatic.com/" crossorigin="anonymous" rel="preconnect"><link rel="alternate" type="application/rss+xml" title="BezKoder » Feed" href="https://bezkoder.com/feed/"><link rel="alternate" type="application/rss+xml" title="BezKoder » Comments Feed" href="https://bezkoder.com/comments/feed/"><link rel="alternate" type="application/rss+xml" title="BezKoder » Node.js Express: JWT example | Token Based Authentication &amp; Authorization Comments Feed" href="https://bezkoder.com/node-js-jwt-authentication-mysql/feed/"> <script type="text/javascript" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/jquery.min.js.download" id="jquery-core-js"></script> <script type="text/javascript" id="cookie-law-info-js-extra">var Cli_Data = {"nn_cookie_ids":[],"cookielist":[],"ccpaEnabled":"","ccpaRegionBased":"","ccpaBarEnabled":"","ccpaType":"gdpr","js_blocking":"","custom_integration":"","triggerDomRefresh":""};
var cli_cookiebar_settings = {"animate_speed_hide":"500","animate_speed_show":"500","background":"#FFF","border":"#b1a6a6c2","border_on":"","button_1_button_colour":"#eaeaea","button_1_button_hover":"#bbbbbb","button_1_link_colour":"#dd3333","button_1_as_button":"1","button_1_new_win":"","button_2_button_colour":"#333","button_2_button_hover":"#292929","button_2_link_colour":"#dd3333","button_2_as_button":"","button_2_hidebar":"","button_3_button_colour":"#000","button_3_button_hover":"#000000","button_3_link_colour":"#fff","button_3_as_button":"1","button_3_new_win":"","button_4_button_colour":"#000","button_4_button_hover":"#000000","button_4_link_colour":"#62a329","button_4_as_button":"","font_family":"inherit","header_fix":"","notify_animate_hide":"","notify_animate_show":"","notify_div_id":"#cookie-law-info-bar","notify_position_horizontal":"right","notify_position_vertical":"bottom","scroll_close":"","scroll_close_reload":"","accept_close_reload":"","reject_close_reload":"","showagain_tab":"","showagain_background":"#fff","showagain_border":"#000","showagain_div_id":"#cookie-law-info-again","showagain_x_position":"100px","text":"#383838","show_once_yn":"","show_once":"10000","logging_on":"","as_popup":"","popup_overlay":"1","bar_heading_text":"","cookie_bar_as":"banner","popup_showagain_position":"bottom-right","widget_position":"left"};
var log_object = {"ajax_url":"https:\/\/bezkoder.com\/wp-admin\/admin-ajax.php"};</script><link rel="https://api.w.org/" href="https://bezkoder.com/wp-json/"><link rel="alternate" type="application/json" href="https://bezkoder.com/wp-json/wp/v2/posts/2033"><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://bezkoder.com/xmlrpc.php?rsd"><link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://bezkoder.com/wp-includes/wlwmanifest.xml"><meta name="generator" content="WordPress 5.6.1"><link rel="shortlink" href="https://bezkoder.com/?p=2033"><link rel="alternate" type="application/json+oembed" href="https://bezkoder.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fbezkoder.com%2Fnode-js-jwt-authentication-mysql%2F"><link rel="alternate" type="text/xml+oembed" href="https://bezkoder.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fbezkoder.com%2Fnode-js-jwt-authentication-mysql%2F&amp;format=xml"> <script type="text/javascript">document.cookie = 'quads_browser_width='+screen.width;</script><link rel="pingback" href="https://bezkoder.com/xmlrpc.php"><link rel="icon" href="https://bezkoder.com/wp-content/uploads/2019/10/favicon-60x60.png" sizes="32x32"><link rel="icon" href="https://bezkoder.com/wp-content/uploads/2019/10/favicon.png" sizes="192x192"><link rel="apple-touch-icon" href="https://bezkoder.com/wp-content/uploads/2019/10/favicon.png"><meta name="msapplication-TileImage" content="https://bezkoder.com/wp-content/uploads/2019/10/favicon.png"> <script async="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/js"></script> <script>window.dataLayer = window.dataLayer || [];
 function gtag(){dataLayer.push(arguments);}
 gtag('js', new Date());  gtag('config', 'UA-141701321-1');</script> <script data-ad-client="ca-pub-9222145312954144" async="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/f.txt"></script></head><body class="post-template-default single single-post postid-2033 single-format-standard custom-background group-blog"> <a class="sr-only sr-only-focusable" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#content">Skip to main content</a><div id="page" class="hfeed site"><header id="masthead" class="site-header" role="banner"><nav class="navbar navbar-default 
 " role="navigation"><div class="container"><div class="row"><div class="site-navigation-inner col-sm-12"><div class="navbar-header"> <button type="button" class="btn navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button><div id="logo"> <a href="https://bezkoder.com/"><img src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/bezkoder-logo.svg" height="76" width="300" alt="BezKoder"></a></div></div><div class="collapse navbar-collapse navbar-ex1-collapse"><ul id="menu-top-menu" class="nav navbar-nav"><li id="menu-item-1943" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1943"><a href="https://bezkoder.com/category/full-stack/">Full Stack</a></li><li id="menu-item-1059" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1059"><a href="https://bezkoder.com/category/spring/">Spring</a></li><li id="menu-item-3190" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3190"><a href="https://bezkoder.com/node-js-tutorial/">Node</a></li><li id="menu-item-266" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-266"><a href="https://bezkoder.com/category/vue/">Vue</a></li><li id="menu-item-2393" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2393"><a href="https://bezkoder.com/category/angular/">Angular</a></li><li id="menu-item-3149" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3149"><a href="https://bezkoder.com/category/react/">React</a></li><li id="menu-item-5129" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-5129"><a href="https://bezkoder.com/category/firebase/">Firebase</a></li><li id="menu-item-3150" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3150"><a href="https://bezkoder.com/category/django/">Django</a></li><li id="menu-item-121" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-121"><a href="https://bezkoder.com/category/dart/">Dart</a></li><li id="menu-item-6096" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6096"><a href="https://bezkoder.com/categories/">Categories</a></li><li id="menu-item-2002" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2002"><a href="https://bezkoder.com/json-formatter/">JsonFormatter</a></li></ul></div></div></div></div></nav></header><div id="content" class="site-content"><div class="top-section"><div style="width: 100%; text-align:center; margin-top: 10px; height:90px;"><div class="aicp"> <script async="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/f.txt"></script> <ins class="adsbygoogle" style="display:block;height:90px" data-ad-client="ca-pub-9222145312954144" data-ad-slot="6826789696"></ins> <script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div></div></div><div class="container main-content-area"><div class="row side-pull-left"><div class="main-content-inner col-sm-12 col-md-8"><div id="primary" class="content-area"><main id="main" class="site-main" role="main"><article id="post-2033" class="post-2033 post type-post status-publish format-standard has-post-thumbnail hentry category-node-js category-security tag-authentication tag-authorization tag-express tag-jwt tag-mysql tag-node-js tag-security tag-sequelize tag-token-based-authentication"> <img width="750" height="410" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/node-js-jwt-authentication-mysql-feature-image.png" class="single-featured wp-post-image" alt="node-js-jwt-authentication-mysql-feature-image" loading="lazy" srcset="https://bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-feature-image.png 750w, https://bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-feature-image-300x164.png 300w" sizes="(max-width: 750px) 100vw, 750px"><div class="post-inner-content"><header class="entry-header page-header"><h1 class="entry-title ">Node.js Express: JWT example | Token Based Authentication &amp; Authorization</h1><div class="entry-meta"> <span class="posted-on"><i class="fa fa-calendar-alt"></i> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/" rel="bookmark"><time class="entry-date published" datetime="2020-12-25T08:13:39+00:00">Last modified: December 25, 2020</time></a></span><span class="byline"> <i class="fa fa-user"></i> <span class="author vcard"><a class="url fn n" href="https://bezkoder.com/author/bezkoder/">bezkoder</a></span></span> <span class="cat-links"><i class="fa fa-folder-open"></i> <a href="https://bezkoder.com/category/node-js/" rel="category tag">Node.js</a>, <a href="https://bezkoder.com/category/security/" rel="category tag">Security</a> </span></div></header><div class="entry-content"><p>In this tutorial, we’re gonna build a Node.js Express Rest API example that supports Token Based Authentication with JWT (<a href="https://www.npmjs.com/package/jsonwebtoken">JSONWebToken</a>). You’ll know:</p><ul><li>Appropriate Flow for User Signup &amp; User Login with JWT Authentication</li><li>Node.js Express Architecture with CORS, Authenticaton &amp; Authorization middlewares &amp; Sequelize</li><li>How to configure Express routes to work with JWT</li><li>How to define Data Models and association for Authentication and Authorization</li><li>Way to use Sequelize to interact with MySQL Database</li></ul><p><span id="more-2033"></span></p><hr><p>Related Posts:<br> – <a href="https://bezkoder.com/node-js-express-sequelize-mysql/">Node.js Rest APIs example with Express, Sequelize &amp; MySQL</a><br> – <a href="https://bezkoder.com/node-js-mongodb-auth-jwt/">Node.js + MongoDB: User Authentication &amp; Authorization with JWT</a><br> – <a href="https://bezkoder.com/node-js-jwt-authentication-postgresql/">Node.js + PostgreSQL: User Authentication &amp; Authorization with JWT</a></p><p>Fullstack (JWT Authentication &amp; Authorization example):<br> – <a href="https://bezkoder.com/node-express-vue-jwt-auth/">Node.js Express + Vue.js</a><br> – <a href="https://bezkoder.com/node-js-express-angular-jwt-auth/">Node.js Express + Angular 8</a><br> – <a href="https://bezkoder.com/node-js-express-angular-10-jwt-auth/">Node.js Express + Angular 10</a><br> – <a href="https://bezkoder.com/node-js-angular-11-jwt-authentication/">Node.js Express + Angular 11</a><br> – <a href="https://bezkoder.com/react-express-authentication-jwt/">Node.js Express + React</a></p><p>Deployment: <a href="https://bezkoder.com/deploy-node-js-app-heroku-cleardb-mysql/">Deploying/Hosting Node.js app on Heroku with MySQL database</a></p><div id="toc_container" class="no_bullets"><p class="toc_title">Contents <span class="toc_toggle">[<a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#">hide</a>]</span></p><ul class="toc_list"><li><a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#Token_Based_Authentication">Token Based Authentication</a></li><li><a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#Overview_of_Nodejs_JWT_Authentication_example">Overview of Node.js JWT Authentication example</a></li><li><a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#Flow_for_Signup_038_Login_with_JWT_Authentication">Flow for Signup &amp; Login with JWT Authentication</a></li><li><a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#Nodejs_Express_Architecture_with_Authentication_038_Authorization">Node.js Express Architecture with Authentication &amp; Authorization</a></li><li><a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#Technology">Technology</a></li><li><a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#Project_Structure">Project Structure</a></li><li><a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#Create_Nodejs_App">Create Node.js App</a></li><li><a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#Setup_Express_web_server">Setup Express web server</a></li><li><a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#Configure_MySQL_database_038_Sequelize">Configure MySQL database &amp; Sequelize</a></li><li><a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#Define_the_Sequelize_Model">Define the Sequelize Model</a></li><li><a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#Initialize_Sequelize">Initialize Sequelize</a></li><li><a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#Configure_Auth_Key">Configure Auth Key</a></li><li><a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#Create_Middleware_functions">Create Middleware functions</a></li><li><a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#Create_Controllers">Create Controllers</a><ul><li><a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#Controller_for_Authentication">Controller for Authentication</a></li><li><a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#Controller_for_testing_Authorization">Controller for testing Authorization</a></li></ul></li><li><a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#Define_Routes">Define Routes</a></li><li><a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#Run_Test_with_Results">Run &amp; Test with Results</a></li><li><a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#Conclusion">Conclusion</a></li><li><a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#Source_Code">Source Code</a></li><li><a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#Further_Reading">Further Reading</a></li></ul></div><h2><span id="Token_Based_Authentication">Token Based Authentication</span></h2><p>Comparing with Session-based Authentication that need to store Session on Cookie, the big advantage of Token-based Authentication is that we store the JSON Web Token (JWT) on Client side: Local Storage for Browser, Keychain for IOS and SharedPreferences for Android… So we don’t need to build another backend project that supports Native Apps or an additional Authentication module for Native App users.</p><p><img loading="lazy" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/in-depth-introduction-jwt-token-based-authentication.png" alt="in-depth-introduction-jwt-token-based-authentication" width="640" height="460" class="alignnone size-full wp-image-733" srcset="https://bezkoder.com/wp-content/uploads/2019/10/in-depth-introduction-jwt-token-based-authentication.png 640w, https://bezkoder.com/wp-content/uploads/2019/10/in-depth-introduction-jwt-token-based-authentication-300x216.png 300w" sizes="(max-width: 640px) 100vw, 640px"></p><div class="quads-location quads-ad1" id="quads-ad1" style="float:none;margin:30px 0 30px 0;text-align:center;"><div class="aicp"> <script async="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/f.txt"></script> <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9222145312954144" data-ad-slot="9066284388" data-ad-format="auto" data-full-width-responsive="true"></ins> <script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div></div><p>There are three important parts of a JWT: Header, Payload, Signature. Together they are combined to a standard structure: <code>header.payload.signature</code>.</p><p>The Client typically attaches JWT in <strong>Authorization</strong> header with Bearer prefix:</p><pre><code>Authorization: Bearer [header].[payload].[signature]
</code></pre><p>Or only in <strong>x-access-token</strong> header:</p><pre><code>x-access-token: [header].[payload].[signature]
</code></pre><p>For more details, you can visit:<br> <a href="https://bezkoder.com/jwt-json-web-token/">In-depth Introduction to JWT-JSON Web Token</a></p><h2><span id="Overview_of_Nodejs_JWT_Authentication_example">Overview of Node.js Express JWT Authentication example</span></h2><p>We will build a Node.js Express application in that:</p><ul><li>User can signup new account, or login with username &amp; password.</li><li>By User’s role (admin, moderator, user), we authorize the User to access resources</li></ul><p>This is our Node.js application demo running with MySQL database and test Rest Apis with Postman.</p><p><iframe width="853" height="480" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/fLcxkyMDW08.html" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></p><div class="quads-location quads-ad2" id="quads-ad2" style="float:none;margin:30px 0 30px 0;text-align:center;"> <script async="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/f.txt"></script> <ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-9222145312954144" data-ad-slot="8580577265"></ins> <script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div><p>These are APIs that we need to provide:</p><div class="table-responsive"><table class="table table-hover  table table-hover table table-hover" width="100%"><thead><tr><th>Methods</th><th>Urls</th><th>Actions</th></tr></thead><tbody><tr><td>POST</td><td>/api/auth/signup</td><td>signup new account</td></tr><tr><td>POST</td><td>/api/auth/signin</td><td>login an account</td></tr><tr><td>GET</td><td>/api/test/all</td><td>retrieve public content</td></tr><tr><td>GET</td><td>/api/test/user</td><td>access User’s content</td></tr><tr><td>GET</td><td>/api/test/mod</td><td>access Moderator’s content</td></tr><tr><td>GET</td><td>/api/test/admin</td><td>access Admin’s content</td></tr></tbody></table></div><h2><span id="Flow_for_Signup_038_Login_with_JWT_Authentication">Flow for Signup &amp; Login with JWT Authentication</span></h2><p>The diagram shows flow of User Registration, User Login and Authorization process.</p><p><img loading="lazy" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/node-js-jwt-authentication-mysql-flow.png" alt="node-js-jwt-authentication-mysql-flow" width="672" height="500" class="alignnone size-full wp-image-2014" srcset="https://bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-flow.png 672w, https://bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-flow-300x223.png 300w" sizes="(max-width: 672px) 100vw, 672px"></p><p>A legal JWT must be added to HTTP <strong>x-access-token</strong> Header if Client accesses protected resources.</p><h2><span id="Nodejs_Express_Architecture_with_Authentication_038_Authorization">Node.js Express Architecture with Authentication &amp; Authorization</span></h2><p>You can have an overview of our Node.js Express App with the diagram below:</p><p><img loading="lazy" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/node-js-jwt-authentication-mysql-architecture.png" alt="node-js-jwt-authentication-mysql-architecture" width="564" height="564" class="alignnone size-full wp-image-2015" srcset="https://bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-architecture.png 564w, https://bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-architecture-300x300.png 300w, https://bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-architecture-150x150.png 150w, https://bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-architecture-60x60.png 60w" sizes="(max-width: 564px) 100vw, 564px"></p><p>Via <em>Express</em> routes, <strong>HTTP request</strong> that matches a route will be checked by <strong>CORS Middleware</strong> before coming to <strong>Security</strong> layer.</p><p><strong>Security</strong> layer includes:</p><ul><li>JWT Authentication Middleware: verify SignUp, verify token</li><li>Authorization Middleware: check User’s roles with record in database</li></ul><p>If these middlewares throw any error, a message will be sent as HTTP response.</p><p><strong>Controllers</strong> interact with MySQL Database via <em>Sequelize</em> and send <strong>HTTP response</strong> (token, user information, data based on roles…) to client.</p><h2><span id="Technology">Technology</span></h2><ul><li>Express 4.17.1</li><li>bcryptjs 2.4.3</li><li>jsonwebtoken 8.5.1</li><li>Sequelize 5.21.3</li><li>MySQL</li></ul><h2><span id="Project_Structure">Project Structure</span></h2><p>This is directory structure for our Node.js Express application:</p><p><img loading="lazy" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/node-js-jwt-authentication-mysql-project-structure.png" alt="node-js-jwt-authentication-mysql-project-structure" width="220" height="520" class="alignnone size-full wp-image-2061" srcset="https://bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-project-structure.png 220w, https://bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-project-structure-127x300.png 127w" sizes="(max-width: 220px) 100vw, 220px"></p><p>– <strong>config</strong></p><ul><li>configure MySQL database &amp; Sequelize</li><li>configure Auth Key</li></ul><p>– <strong>routes</strong></p><ul><li><em>auth.routes.js</em>: POST signup &amp; signin</li><li><em>user.routes.js</em>: GET public &amp; protected resources</li></ul><p>– <strong>middlewares</strong></p><ul><li><em>verifySignUp.js</em>: check duplicate Username or Email</li><li><em>authJwt.js</em>: verify Token, check User roles in database</li></ul><p>– <strong>controllers</strong></p><ul><li><em>auth.controller.js</em>: handle signup &amp; signin actions</li><li><em>user.controller.js</em>: return public &amp; protected content</li></ul><p>– <strong>models</strong> for Sequelize Models</p><ul><li><em>user.model.js</em></li><li><em>role.model.js</em></li></ul><p>– <em>server.js</em>: import and initialize neccesary modules and routes, listen for connections.</p><h2><span id="Create_Nodejs_App">Create Node.js App</span></h2><p>First, we create a folder for our project:</p><pre><code>$ mkdir node-js-jwt-auth
$ cd node-js-jwt-auth
</code></pre><p>Then we initialize the Node.js App with a <em>package.json</em> file:</p><pre><code>npm init

name: (node-js-jwt-auth) 
version: (1.0.0) 
description: Node.js Demo for JWT Authentication
entry point: (index.js) server.js
test command: 
git repository: 
keywords: node.js, express, jwt, authentication, mysql
author: bezkoder
license: (ISC)

Is this ok? (yes) yes
</code></pre><p>We need to install necessary modules: <code>express</code>, <code>cors</code>, <code>body-parser</code>, <code>sequelize</code>, <code>mysql2</code>, <code>jsonwebtoken</code> and <code>bcryptjs</code>.<br> Run the command:</p><pre><code>npm install express sequelize mysql2 body-parser cors jsonwebtoken bcryptjs --save
</code></pre><p>The package.json file now looks like this:</p><pre class=" language-json"><code class=" language-json"><span class="token punctuation">{</span>
  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"node-js-jwt-auth"</span><span class="token punctuation">,</span>
  <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"1.0.0"</span><span class="token punctuation">,</span>
  <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"Node.js Demo for JWT Authentication"</span><span class="token punctuation">,</span>
  <span class="token property">"main"</span><span class="token operator">:</span> <span class="token string">"server.js"</span><span class="token punctuation">,</span>
  <span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"test"</span><span class="token operator">:</span> <span class="token string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"keywords"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">"node.js"</span><span class="token punctuation">,</span>
    <span class="token string">"jwt"</span><span class="token punctuation">,</span>
    <span class="token string">"authentication"</span><span class="token punctuation">,</span>
    <span class="token string">"express"</span><span class="token punctuation">,</span>
    <span class="token string">"mysql"</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">"author"</span><span class="token operator">:</span> <span class="token string">"bezkoder"</span><span class="token punctuation">,</span>
  <span class="token property">"license"</span><span class="token operator">:</span> <span class="token string">"ISC"</span><span class="token punctuation">,</span>
  <span class="token property">"dependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"bcryptjs"</span><span class="token operator">:</span> <span class="token string">"^2.4.3"</span><span class="token punctuation">,</span>
    <span class="token property">"body-parser"</span><span class="token operator">:</span> <span class="token string">"^1.19.0"</span><span class="token punctuation">,</span>
    <span class="token property">"cors"</span><span class="token operator">:</span> <span class="token string">"^2.8.5"</span><span class="token punctuation">,</span>
    <span class="token property">"express"</span><span class="token operator">:</span> <span class="token string">"^4.17.1"</span><span class="token punctuation">,</span>
    <span class="token property">"jsonwebtoken"</span><span class="token operator">:</span> <span class="token string">"^8.5.1"</span><span class="token punctuation">,</span>
    <span class="token property">"mysql2"</span><span class="token operator">:</span> <span class="token string">"^2.1.0"</span><span class="token punctuation">,</span>
    <span class="token property">"sequelize"</span><span class="token operator">:</span> <span class="token string">"^5.21.3"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><h2><span id="Setup_Express_web_server">Setup Express web server</span></h2><p>In the root folder, let’s create a new <em>server.js</em> file:</p><pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"express"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> bodyParser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"body-parser"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> cors <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"cors"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> corsOptions <span class="token operator">=</span> <span class="token punctuation">{</span>
  origin<span class="token operator">:</span> <span class="token string">"http://localhost:8081"</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="token function">cors</span><span class="token punctuation">(</span>corsOptions<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// parse requests of content-type - application/json</span>
app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// parse requests of content-type - application/x-www-form-urlencoded</span>
app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token method function property-access">urlencoded</span><span class="token punctuation">(</span><span class="token punctuation">{</span> extended<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// simple route</span>
app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span> message<span class="token operator">:</span> <span class="token string">"Welcome to bezkoder application."</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// set port, listen for requests</span>
<span class="token keyword">const</span> <span class="token constant">PORT</span> <span class="token operator">=</span> process<span class="token punctuation">.</span><span class="token property-access">env</span><span class="token punctuation">.</span><span class="token constant">PORT</span> <span class="token operator">||</span> <span class="token number">8080</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token method function property-access">listen</span><span class="token punctuation">(</span><span class="token constant">PORT</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Server is running on port </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">PORT</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>Let me explain what we’ve just done:<br> – import <code>express</code>, <code>body-parser</code> and <code>cors</code> modules:</p><ul><li>Express is for building the Rest apis</li><li><a href="https://www.npmjs.com/package/body-parser">body-parser</a> helps to parse the request and create the <code>req.body</code> object</li><li><a href="https://www.npmjs.com/package/cors">cors</a> provides Express middleware to enable CORS</li></ul><p>– create an Express app, then add <code>body-parser</code> and <code>cors</code> middlewares using <code>app.use()</code> method. Notice that we set origin: <code>http://localhost:8081</code>.<br> – define a GET route which is simple for test.<br> – listen on port 8080 for incoming requests.</p><p>Now let’s run the app with command: <code>node server.js</code>.<br> Open your browser with url <a href="http://localhost:8080/">http://localhost:8080/</a>, you will see:</p><p><img loading="lazy" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/node-js-jwt-authentication-mysql-example-setup-server.png" alt="node-js-jwt-authentication-mysql-example-setup-server" width="394" height="144" class="alignnone size-full wp-image-2019" srcset="https://bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-example-setup-server.png 394w, https://bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-example-setup-server-300x110.png 300w" sizes="(max-width: 394px) 100vw, 394px"></p><h2><span id="Configure_MySQL_database_038_Sequelize">Configure MySQL database &amp; Sequelize</span></h2><p>In the <strong>app</strong> folder, create <strong>config</strong> folder for configuration with <em>db.config.js</em> file like this:</p><pre class=" language-js"><code class=" language-js">module<span class="token punctuation">.</span><span class="token property-access">exports</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">HOST</span><span class="token operator">:</span> <span class="token string">"localhost"</span><span class="token punctuation">,</span>
  <span class="token constant">USER</span><span class="token operator">:</span> <span class="token string">"root"</span><span class="token punctuation">,</span>
  <span class="token constant">PASSWORD</span><span class="token operator">:</span> <span class="token string">"123456"</span><span class="token punctuation">,</span>
  <span class="token constant">DB</span><span class="token operator">:</span> <span class="token string">"testdb"</span><span class="token punctuation">,</span>
  dialect<span class="token operator">:</span> <span class="token string">"mysql"</span><span class="token punctuation">,</span>
  pool<span class="token operator">:</span> <span class="token punctuation">{</span>
    max<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
    min<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    acquire<span class="token operator">:</span> <span class="token number">30000</span><span class="token punctuation">,</span>
    idle<span class="token operator">:</span> <span class="token number">10000</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><p>First five parameters are for MySQL connection.<br> <code>pool</code> is optional, it will be used for Sequelize connection pool configuration:</p><ul><li><code>max</code>: maximum number of connection in pool</li><li><code>min</code>: minimum number of connection in pool</li><li><code>idle</code>: maximum time, in milliseconds, that a connection can be idle before being released</li><li><code>acquire</code>: maximum time, in milliseconds, that pool will try to get connection before throwing error</li></ul><p>For more details, please visit <a href="https://sequelize.org/master/class/lib/sequelize.js~Sequelize.html#instance-constructor-constructor">API Reference for the Sequelize constructor</a>.</p><h2><span id="Define_the_Sequelize_Model">Define the Sequelize Model</span></h2><p>In <em>models</em> folder, create <code>User</code> and <code>Role</code> data model as following code:</p><p><strong>models</strong>/<em>user.model.js</em></p><pre class=" language-js"><code class=" language-js">module<span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">sequelize<span class="token punctuation">,</span> <span class="token maybe-class-name">Sequelize</span></span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token maybe-class-name">User</span> <span class="token operator">=</span> sequelize<span class="token punctuation">.</span><span class="token method function property-access">define</span><span class="token punctuation">(</span><span class="token string">"users"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    username<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> <span class="token maybe-class-name">Sequelize</span><span class="token punctuation">.</span><span class="token constant">STRING</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    email<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> <span class="token maybe-class-name">Sequelize</span><span class="token punctuation">.</span><span class="token constant">STRING</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    password<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> <span class="token maybe-class-name">Sequelize</span><span class="token punctuation">.</span><span class="token constant">STRING</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token maybe-class-name">User</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><p><strong>models</strong>/<em>role.model.js</em></p><pre class=" language-js"><code class=" language-js">module<span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">sequelize<span class="token punctuation">,</span> <span class="token maybe-class-name">Sequelize</span></span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token maybe-class-name">Role</span> <span class="token operator">=</span> sequelize<span class="token punctuation">.</span><span class="token method function property-access">define</span><span class="token punctuation">(</span><span class="token string">"roles"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    id<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> <span class="token maybe-class-name">Sequelize</span><span class="token punctuation">.</span><span class="token constant">INTEGER</span><span class="token punctuation">,</span>
      primaryKey<span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> <span class="token maybe-class-name">Sequelize</span><span class="token punctuation">.</span><span class="token constant">STRING</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token maybe-class-name">Role</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><p>These Sequelize Models represents <strong>users</strong> &amp; <strong>roles</strong> table in MySQL database.</p><p>After initializing Sequelize, we don’t need to write CRUD functions, Sequelize supports all of them:</p><ul><li>create a new User: <code><a href="https://sequelize.org/master/class/lib/model.js~Model.html#static-method-create">create</a>(object)</code></li><li>find a User by id: <code><a href="https://sequelize.org/master/class/lib/model.js~Model.html#static-method-findByPk">findByPk</a>(id)</code></li><li>find a User by email: <code><a href="https://sequelize.org/master/class/lib/model.js~Model.html#static-method-findOne">findOne</a>({ where: { email: ... } })</code></li><li>get all Users: <code><a href="https://sequelize.org/master/class/lib/model.js~Model.html#static-method-findAll">findAll</a>()</code></li><li>find all Users by <em>username</em>: <code>findAll({ where: { username: ... } })</code></li></ul><p>These functions will be used in our Controllers and Middlewares.</p><h2><span id="Initialize_Sequelize">Initialize Sequelize</span></h2><p>Now create <strong>app</strong>/<strong>models</strong>/<em>index.js</em> with content like this:</p><pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"../config/db.config.js"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token maybe-class-name">Sequelize</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"sequelize"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> sequelize <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Sequelize</span><span class="token punctuation">(</span>
  config<span class="token punctuation">.</span><span class="token constant">DB</span><span class="token punctuation">,</span>
  config<span class="token punctuation">.</span><span class="token constant">USER</span><span class="token punctuation">,</span>
  config<span class="token punctuation">.</span><span class="token constant">PASSWORD</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    host<span class="token operator">:</span> config<span class="token punctuation">.</span><span class="token constant">HOST</span><span class="token punctuation">,</span>
    dialect<span class="token operator">:</span> config<span class="token punctuation">.</span><span class="token property-access">dialect</span><span class="token punctuation">,</span>
    operatorsAliases<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>

    pool<span class="token operator">:</span> <span class="token punctuation">{</span>
      max<span class="token operator">:</span> config<span class="token punctuation">.</span><span class="token property-access">pool</span><span class="token punctuation">.</span><span class="token property-access">max</span><span class="token punctuation">,</span>
      min<span class="token operator">:</span> config<span class="token punctuation">.</span><span class="token property-access">pool</span><span class="token punctuation">.</span><span class="token property-access">min</span><span class="token punctuation">,</span>
      acquire<span class="token operator">:</span> config<span class="token punctuation">.</span><span class="token property-access">pool</span><span class="token punctuation">.</span><span class="token property-access">acquire</span><span class="token punctuation">,</span>
      idle<span class="token operator">:</span> config<span class="token punctuation">.</span><span class="token property-access">pool</span><span class="token punctuation">.</span><span class="token property-access">idle</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

db<span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">Sequelize</span></span> <span class="token operator">=</span> <span class="token maybe-class-name">Sequelize</span><span class="token punctuation">;</span>
db<span class="token punctuation">.</span><span class="token property-access">sequelize</span> <span class="token operator">=</span> sequelize<span class="token punctuation">;</span>

db<span class="token punctuation">.</span><span class="token property-access">user</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"../models/user.model.js"</span><span class="token punctuation">)</span><span class="token punctuation">(</span>sequelize<span class="token punctuation">,</span> <span class="token maybe-class-name">Sequelize</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
db<span class="token punctuation">.</span><span class="token property-access">role</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"../models/role.model.js"</span><span class="token punctuation">)</span><span class="token punctuation">(</span>sequelize<span class="token punctuation">,</span> <span class="token maybe-class-name">Sequelize</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

db<span class="token punctuation">.</span><span class="token property-access">role</span><span class="token punctuation">.</span><span class="token method function property-access">belongsToMany</span><span class="token punctuation">(</span>db<span class="token punctuation">.</span><span class="token property-access">user</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  through<span class="token operator">:</span> <span class="token string">"user_roles"</span><span class="token punctuation">,</span>
  foreignKey<span class="token operator">:</span> <span class="token string">"roleId"</span><span class="token punctuation">,</span>
  otherKey<span class="token operator">:</span> <span class="token string">"userId"</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
db<span class="token punctuation">.</span><span class="token property-access">user</span><span class="token punctuation">.</span><span class="token method function property-access">belongsToMany</span><span class="token punctuation">(</span>db<span class="token punctuation">.</span><span class="token property-access">role</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  through<span class="token operator">:</span> <span class="token string">"user_roles"</span><span class="token punctuation">,</span>
  foreignKey<span class="token operator">:</span> <span class="token string">"userId"</span><span class="token punctuation">,</span>
  otherKey<span class="token operator">:</span> <span class="token string">"roleId"</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

db<span class="token punctuation">.</span><span class="token constant">ROLES</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"user"</span><span class="token punctuation">,</span> <span class="token string">"admin"</span><span class="token punctuation">,</span> <span class="token string">"moderator"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span><span class="token property-access">exports</span> <span class="token operator">=</span> db<span class="token punctuation">;</span>
</code></pre><p>The association between <em>Users</em> and <em>Roles</em> is Many-to-Many relationship:<br> – One User can have several Roles.<br> – One Role can be taken on by many Users.</p><p>We use <code>User.belongsToMany(Role)</code> to indicate that the <em>user</em> model can belong to many <em>Role</em>s and vice versa.</p><p>With <code>through, foreignKey, otherKey</code>, we’re gonna have a new table <strong>user_roles</strong> as connection between <strong>users</strong> and <strong>roles</strong> table via their primary key as foreign keys.</p><p>If you want to know more details about how to make Many-to-Many Association with Sequelize and Node.js, please visit:<br> <a href="https://bezkoder.com/sequelize-associate-many-to-many/">Sequelize Many-to-Many Association example – Node.js &amp; MySQL</a></p><p>Don’t forget to call <code>sync()</code> method in <em>server.js</em>.</p><pre class=" language-js"><code class=" language-js"><span class="token spread operator">...</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="token spread operator">...</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"./app/models"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token maybe-class-name">Role</span> <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token property-access">role</span><span class="token punctuation">;</span>

db<span class="token punctuation">.</span><span class="token property-access">sequelize</span><span class="token punctuation">.</span><span class="token method function property-access">sync</span><span class="token punctuation">(</span><span class="token punctuation">{</span>force<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'Drop and Resync Db'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">initial</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token spread operator">...</span>
<span class="token keyword">function</span> <span class="token function">initial</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token maybe-class-name">Role</span><span class="token punctuation">.</span><span class="token method function property-access">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    id<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token string">"user"</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token maybe-class-name">Role</span><span class="token punctuation">.</span><span class="token method function property-access">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    id<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token string">"moderator"</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token maybe-class-name">Role</span><span class="token punctuation">.</span><span class="token method function property-access">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    id<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token string">"admin"</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><p><code>initial()</code> function helps us to create 3 rows in database.<br> In development, you may need to drop existing tables and re-sync database. So you can use <code>force: true</code> as code above.</p><p>For production, just insert these rows manually and use <code>sync()</code> without parameters to avoid dropping data:</p><pre class=" language-js"><code class=" language-js"><span class="token spread operator">...</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="token spread operator">...</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"./app/models"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

db<span class="token punctuation">.</span><span class="token property-access">sequelize</span><span class="token punctuation">.</span><span class="token method function property-access">sync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token spread operator">...</span>
</code></pre><p>Learn how to implement Sequelize One-to-Many Relationship at:<br> <a href="https://bezkoder.com/sequelize-associate-one-to-many/">Sequelize Associations: One-to-Many example – Node.js, MySQL</a></p><h2><span id="Configure_Auth_Key">Configure Auth Key</span></h2><p><strong>jsonwebtoken</strong> functions such as <code>verify()</code> or <code>sign()</code> use algorithm that needs a secret key (as String) to encode and decode token.</p><p>In the <strong>app</strong>/<strong>config</strong> folder, create <em>auth.config.js</em> file with following code:</p><pre class=" language-js"><code class=" language-js">module<span class="token punctuation">.</span><span class="token property-access">exports</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  secret<span class="token operator">:</span> <span class="token string">"bezkoder-secret-key"</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><p>You can create your own <code>secret</code> String.</p><h2><span id="Create_Middleware_functions">Create Middleware functions</span></h2><p>To verify a Signup action, we need 2 functions:<br> – check if <code>username</code> or <code>email</code> is duplicate or not<br> – check if <code>roles</code> in the request is existed or not</p><p><strong>middleware</strong>/<em>verifySignUp.js</em></p><pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"../models"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">ROLES</span> <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token constant">ROLES</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token maybe-class-name">User</span> <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token property-access">user</span><span class="token punctuation">;</span>

<span class="token function-variable function">checkDuplicateUsernameOrEmail</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// Username</span>
  <span class="token maybe-class-name">User</span><span class="token punctuation">.</span><span class="token method function property-access">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    where<span class="token operator">:</span> <span class="token punctuation">{</span>
      username<span class="token operator">:</span> req<span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">.</span><span class="token property-access">username</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">user</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      res<span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        message<span class="token operator">:</span> <span class="token string">"Failed! Username is already in use!"</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Email</span>
    <span class="token maybe-class-name">User</span><span class="token punctuation">.</span><span class="token method function property-access">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      where<span class="token operator">:</span> <span class="token punctuation">{</span>
        email<span class="token operator">:</span> req<span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">.</span><span class="token property-access">email</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">user</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        res<span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          message<span class="token operator">:</span> <span class="token string">"Failed! Email is already in use!"</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function-variable function">checkRolesExisted</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">.</span><span class="token property-access">roles</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> req<span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">.</span><span class="token property-access">roles</span><span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token constant">ROLES</span><span class="token punctuation">.</span><span class="token method function property-access">includes</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">.</span><span class="token property-access">roles</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        res<span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          message<span class="token operator">:</span> <span class="token string">"Failed! Role does not exist = "</span> <span class="token operator">+</span> req<span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">.</span><span class="token property-access">roles</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> verifySignUp <span class="token operator">=</span> <span class="token punctuation">{</span>
  checkDuplicateUsernameOrEmail<span class="token operator">:</span> checkDuplicateUsernameOrEmail<span class="token punctuation">,</span>
  checkRolesExisted<span class="token operator">:</span> checkRolesExisted
<span class="token punctuation">}</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span><span class="token property-access">exports</span> <span class="token operator">=</span> verifySignUp<span class="token punctuation">;</span>
</code></pre><p>To process Authentication &amp; Authorization, we have these functions:<br> - check if <code>token</code> is provided, legal or not. We get token from <strong>x-access-token</strong> of HTTP headers, then use <strong>jsonwebtoken</strong>'s <code>verify()</code> function.<br> - check if <code>roles</code> of the user contains required role or not.</p><p><strong>middleware</strong>/<em>authJwt.js</em></p><pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> jwt <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"jsonwebtoken"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"../config/auth.config.js"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"../models"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token maybe-class-name">User</span> <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token property-access">user</span><span class="token punctuation">;</span>

<span class="token function-variable function">verifyToken</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> token <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token property-access">headers</span><span class="token punctuation">[</span><span class="token string">"x-access-token"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>token<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">403</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      message<span class="token operator">:</span> <span class="token string">"No token provided!"</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  jwt<span class="token punctuation">.</span><span class="token method function property-access">verify</span><span class="token punctuation">(</span>token<span class="token punctuation">,</span> config<span class="token punctuation">.</span><span class="token property-access">secret</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> decoded</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">401</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        message<span class="token operator">:</span> <span class="token string">"Unauthorized!"</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    req<span class="token punctuation">.</span><span class="token property-access">userId</span> <span class="token operator">=</span> decoded<span class="token punctuation">.</span><span class="token property-access">id</span><span class="token punctuation">;</span>
    <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function-variable function">isAdmin</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token maybe-class-name">User</span><span class="token punctuation">.</span><span class="token method function property-access">findByPk</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span><span class="token property-access">userId</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">user</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
    user<span class="token punctuation">.</span><span class="token method function property-access">getRoles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">roles</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> roles<span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>roles<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token property-access">name</span> <span class="token operator">===</span> <span class="token string">"admin"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>

      res<span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">403</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        message<span class="token operator">:</span> <span class="token string">"Require Admin Role!"</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function-variable function">isModerator</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token maybe-class-name">User</span><span class="token punctuation">.</span><span class="token method function property-access">findByPk</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span><span class="token property-access">userId</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">user</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
    user<span class="token punctuation">.</span><span class="token method function property-access">getRoles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">roles</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> roles<span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>roles<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token property-access">name</span> <span class="token operator">===</span> <span class="token string">"moderator"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>

      res<span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">403</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        message<span class="token operator">:</span> <span class="token string">"Require Moderator Role!"</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function-variable function">isModeratorOrAdmin</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token maybe-class-name">User</span><span class="token punctuation">.</span><span class="token method function property-access">findByPk</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span><span class="token property-access">userId</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">user</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
    user<span class="token punctuation">.</span><span class="token method function property-access">getRoles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">roles</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> roles<span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>roles<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token property-access">name</span> <span class="token operator">===</span> <span class="token string">"moderator"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>roles<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token property-access">name</span> <span class="token operator">===</span> <span class="token string">"admin"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>

      res<span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">403</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        message<span class="token operator">:</span> <span class="token string">"Require Moderator or Admin Role!"</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> authJwt <span class="token operator">=</span> <span class="token punctuation">{</span>
  verifyToken<span class="token operator">:</span> verifyToken<span class="token punctuation">,</span>
  isAdmin<span class="token operator">:</span> isAdmin<span class="token punctuation">,</span>
  isModerator<span class="token operator">:</span> isModerator<span class="token punctuation">,</span>
  isModeratorOrAdmin<span class="token operator">:</span> isModeratorOrAdmin
<span class="token punctuation">}</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span><span class="token property-access">exports</span> <span class="token operator">=</span> authJwt<span class="token punctuation">;</span>
</code></pre><p><strong>middleware</strong>/<em>index.js</em></p><pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> authJwt <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"./authJwt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> verifySignUp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"./verifySignUp"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span><span class="token property-access">exports</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  authJwt<span class="token punctuation">,</span>
  verifySignUp
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><h2><span id="Create_Controllers">Create Controllers</span></h2><h3><span id="Controller_for_Authentication">Controller for Authentication</span></h3><p>There are 2 main functions for Authentication:<br> - <code>signup</code>: create new User in database (role is <strong>user</strong> if not specifying role)<br> - <code>signin</code>:</p><ul><li>find <code>username</code> of the request in database, if it exists</li><li>compare <code>password</code> with <code>password</code> in database using <strong>bcrypt</strong>, if it is correct</li><li>generate a token using <strong>jsonwebtoken</strong></li><li>return user information &amp; access Token</li></ul><p><strong>controllers</strong>/<em>auth.controller.js</em></p><pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"../models"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"../config/auth.config"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token maybe-class-name">User</span> <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token property-access">user</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token maybe-class-name">Role</span> <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token property-access">role</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token maybe-class-name">Op</span> <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">Sequelize</span></span><span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">Op</span></span><span class="token punctuation">;</span>

<span class="token keyword">var</span> jwt <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"jsonwebtoken"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> bcrypt <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"bcryptjs"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

exports<span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">signup</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// Save User to Database</span>
  <span class="token maybe-class-name">User</span><span class="token punctuation">.</span><span class="token method function property-access">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    username<span class="token operator">:</span> req<span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">.</span><span class="token property-access">username</span><span class="token punctuation">,</span>
    email<span class="token operator">:</span> req<span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">.</span><span class="token property-access">email</span><span class="token punctuation">,</span>
    password<span class="token operator">:</span> bcrypt<span class="token punctuation">.</span><span class="token method function property-access">hashSync</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">.</span><span class="token property-access">password</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">user</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">.</span><span class="token property-access">roles</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token maybe-class-name">Role</span><span class="token punctuation">.</span><span class="token method function property-access">findAll</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          where<span class="token operator">:</span> <span class="token punctuation">{</span>
            name<span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token punctuation">[</span><span class="token maybe-class-name">Op</span><span class="token punctuation">.</span><span class="token property-access">or</span><span class="token punctuation">]</span><span class="token operator">:</span> req<span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">.</span><span class="token property-access">roles</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">roles</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
          user<span class="token punctuation">.</span><span class="token method function property-access">setRoles</span><span class="token punctuation">(</span>roles<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
            res<span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span> message<span class="token operator">:</span> <span class="token string">"User was registered successfully!"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// user role = 1</span>
        user<span class="token punctuation">.</span><span class="token method function property-access">setRoles</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
          res<span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span> message<span class="token operator">:</span> <span class="token string">"User was registered successfully!"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token method function property-access">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
      res<span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span> message<span class="token operator">:</span> err<span class="token punctuation">.</span><span class="token property-access">message</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

exports<span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">signin</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token maybe-class-name">User</span><span class="token punctuation">.</span><span class="token method function property-access">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    where<span class="token operator">:</span> <span class="token punctuation">{</span>
      username<span class="token operator">:</span> req<span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">.</span><span class="token property-access">username</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">user</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span> message<span class="token operator">:</span> <span class="token string">"User Not found."</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">var</span> passwordIsValid <span class="token operator">=</span> bcrypt<span class="token punctuation">.</span><span class="token method function property-access">compareSync</span><span class="token punctuation">(</span>
        req<span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">.</span><span class="token property-access">password</span><span class="token punctuation">,</span>
        user<span class="token punctuation">.</span><span class="token property-access">password</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>passwordIsValid<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">401</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          accessToken<span class="token operator">:</span> <span class="token keyword null nil">null</span><span class="token punctuation">,</span>
          message<span class="token operator">:</span> <span class="token string">"Invalid Password!"</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">var</span> token <span class="token operator">=</span> jwt<span class="token punctuation">.</span><span class="token method function property-access">sign</span><span class="token punctuation">(</span><span class="token punctuation">{</span> id<span class="token operator">:</span> user<span class="token punctuation">.</span><span class="token property-access">id</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> config<span class="token punctuation">.</span><span class="token property-access">secret</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        expiresIn<span class="token operator">:</span> <span class="token number">86400</span> <span class="token comment">// 24 hours</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">var</span> authorities <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      user<span class="token punctuation">.</span><span class="token method function property-access">getRoles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">roles</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> roles<span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          authorities<span class="token punctuation">.</span><span class="token method function property-access">push</span><span class="token punctuation">(</span><span class="token string">"ROLE_"</span> <span class="token operator">+</span> roles<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token property-access">name</span><span class="token punctuation">.</span><span class="token method function property-access">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        res<span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          id<span class="token operator">:</span> user<span class="token punctuation">.</span><span class="token property-access">id</span><span class="token punctuation">,</span>
          username<span class="token operator">:</span> user<span class="token punctuation">.</span><span class="token property-access">username</span><span class="token punctuation">,</span>
          email<span class="token operator">:</span> user<span class="token punctuation">.</span><span class="token property-access">email</span><span class="token punctuation">,</span>
          roles<span class="token operator">:</span> authorities<span class="token punctuation">,</span>
          accessToken<span class="token operator">:</span> token
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token method function property-access">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
      res<span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span> message<span class="token operator">:</span> err<span class="token punctuation">.</span><span class="token property-access">message</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><h3><span id="Controller_for_testing_Authorization">Controller for testing Authorization</span></h3><p>There are 4 functions:<br> – <code>/api/test/all</code> for public access<br> – <code>/api/test/user</code> for loggedin users (role: <strong>user</strong>/<strong>moderator</strong>/<strong>admin</strong>)<br> – <code>/api/test/mod</code> for users having <strong>moderator</strong> role<br> – <code>/api/test/admin</code> for users having <strong>admin</strong> role</p><p><strong>controllers</strong>/<em>user.controller.js</em></p><pre class=" language-js"><code class=" language-js">exports<span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">allAccess</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token string">"Public Content."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

exports<span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">userBoard</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token string">"User Content."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

exports<span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">adminBoard</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token string">"Admin Content."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

exports<span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">moderatorBoard</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token string">"Moderator Content."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><p>Now, do you have any question? Would you like to know how we can combine middlewares with controller functions?<br> Let's do it in the next section.</p><h2><span id="Define_Routes">Define Routes</span></h2><p>When a client sends request for an endpoint using HTTP request (GET, POST, PUT, DELETE), we need to determine how the server will response by setting up the routes.</p><p>We can separate our routes into 2 part: for Authentication and for Authorization (accessing protected resources).</p><p><strong>Authentication:</strong></p><ul><li>POST <code>/api/auth/signup</code></li><li>POST <code>/api/auth/signin</code></li></ul><p><strong>routes</strong>/<em>auth.routes.js</em></p><pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> <span class="token punctuation">{</span> verifySignUp <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"../middleware"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> controller <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"../controllers/auth.controller"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">app</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token method function property-access">header</span><span class="token punctuation">(</span>
      <span class="token string">"Access-Control-Allow-Headers"</span><span class="token punctuation">,</span>
      <span class="token string">"x-access-token, Origin, Content-Type, Accept"</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  app<span class="token punctuation">.</span><span class="token method function property-access">post</span><span class="token punctuation">(</span>
    <span class="token string">"/api/auth/signup"</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span>
      verifySignUp<span class="token punctuation">.</span><span class="token property-access">checkDuplicateUsernameOrEmail</span><span class="token punctuation">,</span>
      verifySignUp<span class="token punctuation">.</span><span class="token property-access">checkRolesExisted</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    controller<span class="token punctuation">.</span><span class="token property-access">signup</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

  app<span class="token punctuation">.</span><span class="token method function property-access">post</span><span class="token punctuation">(</span><span class="token string">"/api/auth/signin"</span><span class="token punctuation">,</span> controller<span class="token punctuation">.</span><span class="token property-access">signin</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><p><strong>Authorization:</strong></p><ul><li>GET <code>/api/test/all</code></li><li>GET <code>/api/test/user</code> for loggedin users (user/moderator/admin)</li><li>GET <code>/api/test/mod</code> for moderator</li><li>GET <code>/api/test/admin</code> for admin</li></ul><p><strong>routes</strong>/<em>user.routes.js</em></p><pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> <span class="token punctuation">{</span> authJwt <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"../middleware"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> controller <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"../controllers/user.controller"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">app</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token method function property-access">header</span><span class="token punctuation">(</span>
      <span class="token string">"Access-Control-Allow-Headers"</span><span class="token punctuation">,</span>
      <span class="token string">"x-access-token, Origin, Content-Type, Accept"</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">"/api/test/all"</span><span class="token punctuation">,</span> controller<span class="token punctuation">.</span><span class="token property-access">allAccess</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span>
    <span class="token string">"/api/test/user"</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span>authJwt<span class="token punctuation">.</span><span class="token property-access">verifyToken</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    controller<span class="token punctuation">.</span><span class="token property-access">userBoard</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

  app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span>
    <span class="token string">"/api/test/mod"</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span>authJwt<span class="token punctuation">.</span><span class="token property-access">verifyToken</span><span class="token punctuation">,</span> authJwt<span class="token punctuation">.</span><span class="token property-access">isModerator</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    controller<span class="token punctuation">.</span><span class="token property-access">moderatorBoard</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

  app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span>
    <span class="token string">"/api/test/admin"</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span>authJwt<span class="token punctuation">.</span><span class="token property-access">verifyToken</span><span class="token punctuation">,</span> authJwt<span class="token punctuation">.</span><span class="token property-access">isAdmin</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    controller<span class="token punctuation">.</span><span class="token property-access">adminBoard</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><p>Don't forget to add these routes in <em>server.js</em>:</p><pre class=" language-js"><code class=" language-js"><span class="token spread operator">...</span>
<span class="token comment">// routes</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./app/routes/auth.routes'</span><span class="token punctuation">)</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./app/routes/user.routes'</span><span class="token punctuation">)</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// set port, listen for requests</span>
<span class="token spread operator">...</span>
</code></pre><h2><span id="Run_Test_with_Results">Run &amp; Test with Results</span></h2><p>Run Node.js application with command: <code>node server.js</code></p><p>Tables that we define in <em>models</em> package will be automatically generated in MySQL Database.<br> If you check the database, you can see things like this:</p><pre class=" language-sql"><code class=" language-sql">mysql<span class="token operator">&gt;</span> <span class="token keyword">describe</span> users<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">-----------+--------------+------+-----+---------+----------------+</span>
<span class="token operator">|</span> Field     <span class="token operator">|</span> <span class="token keyword">Type</span>         <span class="token operator">|</span> <span class="token boolean">Null</span> <span class="token operator">|</span> <span class="token keyword">Key</span> <span class="token operator">|</span> <span class="token keyword">Default</span> <span class="token operator">|</span> Extra          <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----------+--------------+------+-----+---------+----------------+</span>
<span class="token operator">|</span> id        <span class="token operator">|</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>      <span class="token operator">|</span> <span class="token keyword">NO</span>   <span class="token operator">|</span> PRI <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span> <span class="token keyword">auto_increment</span> <span class="token operator">|</span>
<span class="token operator">|</span> username  <span class="token operator">|</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">|</span> YES  <span class="token operator">|</span>     <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span>                <span class="token operator">|</span>
<span class="token operator">|</span> email     <span class="token operator">|</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">|</span> YES  <span class="token operator">|</span>     <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span>                <span class="token operator">|</span>
<span class="token operator">|</span> password  <span class="token operator">|</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">|</span> YES  <span class="token operator">|</span>     <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span>                <span class="token operator">|</span>
<span class="token operator">|</span> createdAt <span class="token operator">|</span> <span class="token keyword">datetime</span>     <span class="token operator">|</span> <span class="token keyword">NO</span>   <span class="token operator">|</span>     <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span>                <span class="token operator">|</span>
<span class="token operator">|</span> updatedAt <span class="token operator">|</span> <span class="token keyword">datetime</span>     <span class="token operator">|</span> <span class="token keyword">NO</span>   <span class="token operator">|</span>     <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span>                <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----------+--------------+------+-----+---------+----------------+</span>


mysql<span class="token operator">&gt;</span> <span class="token keyword">describe</span> roles<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">-----------+--------------+------+-----+---------+-------+</span>
<span class="token operator">|</span> Field     <span class="token operator">|</span> <span class="token keyword">Type</span>         <span class="token operator">|</span> <span class="token boolean">Null</span> <span class="token operator">|</span> <span class="token keyword">Key</span> <span class="token operator">|</span> <span class="token keyword">Default</span> <span class="token operator">|</span> Extra <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----------+--------------+------+-----+---------+-------+</span>
<span class="token operator">|</span> id        <span class="token operator">|</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>      <span class="token operator">|</span> <span class="token keyword">NO</span>   <span class="token operator">|</span> PRI <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span>       <span class="token operator">|</span>
<span class="token operator">|</span> name      <span class="token operator">|</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">|</span> YES  <span class="token operator">|</span>     <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span>       <span class="token operator">|</span>
<span class="token operator">|</span> createdAt <span class="token operator">|</span> <span class="token keyword">datetime</span>     <span class="token operator">|</span> <span class="token keyword">NO</span>   <span class="token operator">|</span>     <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span>       <span class="token operator">|</span>
<span class="token operator">|</span> updatedAt <span class="token operator">|</span> <span class="token keyword">datetime</span>     <span class="token operator">|</span> <span class="token keyword">NO</span>   <span class="token operator">|</span>     <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span>       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----------+--------------+------+-----+---------+-------+</span>


mysql<span class="token operator">&gt;</span> <span class="token keyword">describe</span> user_roles<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">-----------+----------+------+-----+---------+-------+</span>
<span class="token operator">|</span> Field     <span class="token operator">|</span> <span class="token keyword">Type</span>     <span class="token operator">|</span> <span class="token boolean">Null</span> <span class="token operator">|</span> <span class="token keyword">Key</span> <span class="token operator">|</span> <span class="token keyword">Default</span> <span class="token operator">|</span> Extra <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----------+----------+------+-----+---------+-------+</span>
<span class="token operator">|</span> createdAt <span class="token operator">|</span> <span class="token keyword">datetime</span> <span class="token operator">|</span> <span class="token keyword">NO</span>   <span class="token operator">|</span>     <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span>       <span class="token operator">|</span>
<span class="token operator">|</span> updatedAt <span class="token operator">|</span> <span class="token keyword">datetime</span> <span class="token operator">|</span> <span class="token keyword">NO</span>   <span class="token operator">|</span>     <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span>       <span class="token operator">|</span>
<span class="token operator">|</span> roleId    <span class="token operator">|</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>  <span class="token operator">|</span> <span class="token keyword">NO</span>   <span class="token operator">|</span> PRI <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span>       <span class="token operator">|</span>
<span class="token operator">|</span> userId    <span class="token operator">|</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>  <span class="token operator">|</span> <span class="token keyword">NO</span>   <span class="token operator">|</span> PRI <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span>       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-----------+----------+------+-----+---------+-------+</span>


mysql<span class="token operator">&gt;</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> roles<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">----+-----------+---------------------+---------------------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> name      <span class="token operator">|</span> createdAt           <span class="token operator">|</span> updatedAt           <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+-----------+---------------------+---------------------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">user</span>      <span class="token operator">|</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">13</span> <span class="token number">09</span>:<span class="token number">05</span>:<span class="token number">39</span> <span class="token operator">|</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">13</span> <span class="token number">09</span>:<span class="token number">05</span>:<span class="token number">39</span> <span class="token operator">|</span>
<span class="token operator">|</span>  <span class="token number">2</span> <span class="token operator">|</span> moderator <span class="token operator">|</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">13</span> <span class="token number">09</span>:<span class="token number">05</span>:<span class="token number">39</span> <span class="token operator">|</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">13</span> <span class="token number">09</span>:<span class="token number">05</span>:<span class="token number">39</span> <span class="token operator">|</span>
<span class="token operator">|</span>  <span class="token number">3</span> <span class="token operator">|</span> admin     <span class="token operator">|</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">13</span> <span class="token number">09</span>:<span class="token number">05</span>:<span class="token number">39</span> <span class="token operator">|</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">13</span> <span class="token number">09</span>:<span class="token number">05</span>:<span class="token number">39</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+-----------+---------------------+---------------------+</span>
</code></pre><p>Register some users with <code>/signup</code> API:</p><ul><li><strong>admin</strong> with <code>admin</code> role</li><li><strong>mod</strong> with <code>moderator</code> and <code>user</code> roles</li><li><strong>zkoder</strong> with <code>user</code> role</li></ul><p><img loading="lazy" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/node-js-jwt-authentication-mysql-signup-new-user.png" alt="node-js-jwt-authentication-mysql-signup-new-user" width="600" height="450" class="alignnone size-full wp-image-2025" srcset="https://bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-signup-new-user.png 600w, https://bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-signup-new-user-300x225.png 300w" sizes="(max-width: 600px) 100vw, 600px"></p><p>Our tables after signup could look like this.</p><pre class=" language-sql"><code class=" language-sql">mysql<span class="token operator">&gt;</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> users<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">----+----------+--------------------+--------------------------------------------------------------+---------------------+---------------------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span> username <span class="token operator">|</span> email              <span class="token operator">|</span> password                                                     <span class="token operator">|</span> createdAt           <span class="token operator">|</span> updatedAt           <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+----------+--------------------+--------------------------------------------------------------+---------------------+---------------------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> admin    <span class="token operator">|</span> admin<span class="token variable">@bezkoder.com</span> <span class="token operator">|</span> $<span class="token number">2</span>a$<span class="token number">08</span>$w3cYCF<span class="token punctuation">.</span>N0UQZO19z8CQSZ<span class="token punctuation">.</span>whzxFS5vMoi9k51g3TQx9r5tkwrIXO2 <span class="token operator">|</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">13</span> <span class="token number">09</span>:<span class="token number">21</span>:<span class="token number">51</span> <span class="token operator">|</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">13</span> <span class="token number">09</span>:<span class="token number">21</span>:<span class="token number">51</span> <span class="token operator">|</span>
<span class="token operator">|</span>  <span class="token number">2</span> <span class="token operator">|</span> mod      <span class="token operator">|</span> mod<span class="token variable">@bezkoder.com</span>   <span class="token operator">|</span> $<span class="token number">2</span>a$<span class="token number">08</span>$tTj1l28esAxPSSvl3YqKl<span class="token punctuation">.</span><span class="token operator">/</span>nz35vQF7Y76jGtzcYUhHtGy6d<span class="token punctuation">.</span><span class="token number">1</span><span class="token operator">/</span>ze <span class="token operator">|</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">13</span> <span class="token number">09</span>:<span class="token number">22</span>:<span class="token number">01</span> <span class="token operator">|</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">13</span> <span class="token number">09</span>:<span class="token number">22</span>:<span class="token number">01</span> <span class="token operator">|</span>
<span class="token operator">|</span>  <span class="token number">3</span> <span class="token operator">|</span> zkoder   <span class="token operator">|</span> <span class="token keyword">user</span><span class="token variable">@bezkoder.com</span>  <span class="token operator">|</span> $<span class="token number">2</span>a$<span class="token number">08</span>$U2F07dLyYZjzTxQbFMCAcOd1k8V1o9f6E4TGVJHpy0V6<span class="token operator">/</span>DC7iS0CS <span class="token operator">|</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">13</span> <span class="token number">09</span>:<span class="token number">23</span>:<span class="token number">25</span> <span class="token operator">|</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">13</span> <span class="token number">09</span>:<span class="token number">23</span>:<span class="token number">25</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+----------+--------------------+--------------------------------------------------------------+---------------------+---------------------+</span>


mysql<span class="token operator">&gt;</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> user_roles<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------------+---------------------+--------+--------+</span>
<span class="token operator">|</span> createdAt           <span class="token operator">|</span> updatedAt           <span class="token operator">|</span> roleId <span class="token operator">|</span> userId <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+---------------------+--------+--------+</span>
<span class="token operator">|</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">13</span> <span class="token number">09</span>:<span class="token number">22</span>:<span class="token number">01</span> <span class="token operator">|</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">13</span> <span class="token number">09</span>:<span class="token number">22</span>:<span class="token number">01</span> <span class="token operator">|</span>      <span class="token number">1</span> <span class="token operator">|</span>      <span class="token number">2</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">13</span> <span class="token number">09</span>:<span class="token number">23</span>:<span class="token number">25</span> <span class="token operator">|</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">13</span> <span class="token number">09</span>:<span class="token number">23</span>:<span class="token number">25</span> <span class="token operator">|</span>      <span class="token number">1</span> <span class="token operator">|</span>      <span class="token number">3</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">13</span> <span class="token number">09</span>:<span class="token number">22</span>:<span class="token number">01</span> <span class="token operator">|</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">13</span> <span class="token number">09</span>:<span class="token number">22</span>:<span class="token number">01</span> <span class="token operator">|</span>      <span class="token number">2</span> <span class="token operator">|</span>      <span class="token number">2</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">13</span> <span class="token number">09</span>:<span class="token number">21</span>:<span class="token number">51</span> <span class="token operator">|</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">13</span> <span class="token number">09</span>:<span class="token number">21</span>:<span class="token number">51</span> <span class="token operator">|</span>      <span class="token number">3</span> <span class="token operator">|</span>      <span class="token number">1</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------------+---------------------+--------+--------+</span>
</code></pre><p><strong>Access public resource:</strong> GET <code>/api/test/all</code></p><p><img loading="lazy" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/node-js-jwt-authentication-mysql-get-public-content.png" alt="node-js-jwt-authentication-mysql-get-public-content" width="600" height="220" class="alignnone size-full wp-image-2026" srcset="https://bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-get-public-content.png 600w, https://bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-get-public-content-300x110.png 300w" sizes="(max-width: 600px) 100vw, 600px"></p><p><strong>Access protected resource:</strong> GET <code>/api/test/user</code></p><p><img loading="lazy" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/node-js-jwt-authentication-mysql-get-user-content-not-loggedin.png" alt="node-js-jwt-authentication-mysql-get-user-content-not-loggedin" width="608" height="408" class="alignnone size-full wp-image-2027" srcset="https://bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-get-user-content-not-loggedin.png 608w, https://bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-get-user-content-not-loggedin-300x201.png 300w" sizes="(max-width: 608px) 100vw, 608px"></p><p><strong>Login an account (with wrong password):</strong> POST <code>/api/auth/signin</code></p><p><img loading="lazy" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/node-js-jwt-authentication-mysql-user-signin-wrong-password.png" alt="node-js-jwt-authentication-mysql-user-signin-wrong-password" width="584" height="420" class="alignnone size-full wp-image-2028" srcset="https://bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-user-signin-wrong-password.png 584w, https://bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-user-signin-wrong-password-300x216.png 300w" sizes="(max-width: 584px) 100vw, 584px"></p><p><strong>Login an account:</strong> POST <code>/api/auth/signin</code></p><p><img loading="lazy" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/node-js-jwt-authentication-mysql-user-signin.png" alt="node-js-jwt-authentication-mysql-user-signin" width="590" height="528" class="alignnone size-full wp-image-2029" srcset="https://bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-user-signin.png 590w, https://bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-user-signin-300x268.png 300w" sizes="(max-width: 590px) 100vw, 590px"></p><p><strong>Access protected resources:</strong> GET <code>/api/test/user</code></p><p><img loading="lazy" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/node-js-jwt-authentication-mysql-get-authorized-content.png" alt="node-js-jwt-authentication-mysql-get-authorized-content" width="590" height="1232" class="alignnone size-full wp-image-2031" srcset="https://bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-get-authorized-content.png 590w, https://bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-get-authorized-content-144x300.png 144w, https://bezkoder.com/wp-content/uploads/2020/01/node-js-jwt-authentication-mysql-get-authorized-content-490x1024.png 490w" sizes="(max-width: 590px) 100vw, 590px"></p><h2><span id="Conclusion">Conclusion</span></h2><p>Congratulation!</p><p>Today we've learned so many interesting things about Node.js Token Based Authentication with JWT - JSONWebToken in just a Node.js Express Rest Api example.<br> Despite we wrote a lot of code, I hope you will understand the overall architecture of the application, and apply it in your project at ease.</p><p>If you need a working front-end for this back-end, you can find Client App in the post:<br> - <a href="https://bezkoder.com/jwt-vue-vuex-authentication/">Vue.js JWT Authentication with Vuex and Vue Router</a><br> - <a href="https://bezkoder.com/angular-jwt-authentication/">Angular 8 JWT Authentication example with Web Api</a><br> - <a href="https://bezkoder.com/angular-10-jwt-auth/">Angular 10 JWT Authentication example with Web Api</a><br> - <a href="https://bezkoder.com/angular-11-jwt-auth/">Angular 11 JWT Authentication example with Web Api</a><br> - <a href="https://bezkoder.com/react-jwt-auth/">React JWT Authentication (without Redux) example</a><br> - <a href="https://bezkoder.com/react-hooks-jwt-auth/">React Hooks: JWT Authentication (without Redux) example</a><br> - <a href="https://bezkoder.com/react-redux-jwt-auth/">React Redux: JWT Authentication example</a></p><p>Happy learning! See you again.</p><h2><span id="Further_Reading">Further Reading</span></h2><ul><li><a href="https://www.npmjs.com/package/express">https://www.npmjs.com/package/express</a></li><li><a href="http://expressjs.com/en/guide/routing.html">http://expressjs.com/en/guide/routing.html</a></li><li><a href="https://bezkoder.com/jwt-json-web-token/">In-depth Introduction to JWT-JSON Web Token</a></li><li><a href="https://sequelize.org/master/manual/associations.html">Sequelize Associations</a></li></ul><h2><span id="Source_Code">Source Code</span></h2><p>You can find the complete source code for this tutorial on <a href="https://github.com/bezkoder/node-js-jwt-auth">Github</a>.</p><div class="quads-location quads-ad3" id="quads-ad3" style="float:none;margin:30px 0 30px 0;text-align:center;"><div class="aicp"> <script async="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/f.txt"></script> <ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-9222145312954144" data-ad-slot="4842295194"></ins> <script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div></div></div> <script async="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/f.txt"></script> <ins class="adsbygoogle" style="display:block" data-ad-format="autorelaxed" data-ad-client="ca-pub-9222145312954144" data-ad-slot="2534441724"></ins> <script>(adsbygoogle = window.adsbygoogle || []).push({});</script><footer class="entry-meta"><div class="tagcloud"> <a href="https://bezkoder.com/tag/authentication/">authentication</a> <a href="https://bezkoder.com/tag/authorization/">authorization</a> <a href="https://bezkoder.com/tag/express/">express</a> <a href="https://bezkoder.com/tag/jwt/">jwt</a> <a href="https://bezkoder.com/tag/mysql/">mysql</a> <a href="https://bezkoder.com/tag/node-js/">node.js</a> <a href="https://bezkoder.com/tag/security/">security</a> <a href="https://bezkoder.com/tag/sequelize/">sequelize</a> <a href="https://bezkoder.com/tag/token-based-authentication/">token based authentication</a></div></footer></div></article><div id="comments" class="comments-area"><h2 class="comments-title"> 132 thoughts to “Node.js Express: JWT example | Token Based Authentication &amp; Authorization”</h2><ol class="comment-list"><li id="comment-274" class="comment even thread-even depth-1 parent"><article id="div-comment-274" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/b9c2cf3cab4010c6788356a3db490d29.jpeg" srcset="https://secure.gravatar.com/avatar/b9c2cf3cab4010c6788356a3db490d29?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Encrypter</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-274"><time datetime="2020-01-30T09:33:15+00:00">January 30, 2020 at 9:33 am</time></a></div></footer><div class="comment-content"><p>Great job, thanks a lot!<br> Just one question, can we integrate this with sequelize migrate due to the fact that it makes the job easier for entitites</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-274" data-commentid="274" data-postid="2033" data-belowelement="div-comment-274" data-respondelement="respond" data-replyto="Reply to Encrypter" aria-label="Reply to Encrypter">Reply</a></div></article><ol class="children"><li id="comment-278" class="comment byuser comment-author-bezkoder bypostauthor odd alt depth-2 parent"><article id="div-comment-278" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/40150b9299e69015bc46c30598a81888.png" srcset="https://secure.gravatar.com/avatar/40150b9299e69015bc46c30598a81888?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">bezkoder</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-278"><time datetime="2020-01-31T08:30:40+00:00">January 31, 2020 at 8:30 am</time></a></div></footer><div class="comment-content"><p>Yes, we can. But in this tutorial, I want to keep everything simple and clean, so we don’t use sequelize migrate 🙂</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-278" data-commentid="278" data-postid="2033" data-belowelement="div-comment-278" data-respondelement="respond" data-replyto="Reply to bezkoder" aria-label="Reply to bezkoder">Reply</a></div></article><ol class="children"><li id="comment-292" class="comment even depth-3"><article id="div-comment-292" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/b9c2cf3cab4010c6788356a3db490d29.jpeg" srcset="https://secure.gravatar.com/avatar/b9c2cf3cab4010c6788356a3db490d29?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Encrypter</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-292"><time datetime="2020-02-04T09:26:37+00:00">February 4, 2020 at 9:26 am</time></a></div></footer><div class="comment-content"><p>Thanks a lot, this is the best explanation I’ve found, I’m learning a lot from your articles, If I will find you on social media (Medium and others) I’ll be following you.</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-292" data-commentid="292" data-postid="2033" data-belowelement="div-comment-292" data-respondelement="respond" data-replyto="Reply to Encrypter" aria-label="Reply to Encrypter">Reply</a></div></article></li><li id="comment-4860" class="comment odd alt depth-3 parent"><article id="div-comment-4860" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/2ec8c3038dcd6f6d4318aa8d83cbe615.png" srcset="https://secure.gravatar.com/avatar/2ec8c3038dcd6f6d4318aa8d83cbe615?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Hirwa Blessing</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4860"><time datetime="2020-09-26T14:05:06+00:00">September 26, 2020 at 2:05 pm</time></a></div></footer><div class="comment-content"><p>Great work, thanks a bunch.<br> I have a simple question, you’re using those methods which you didn’t define like user.getRoles() but you never defined these methods. I tried to read on sequelize custom setters and getters but about setters and getters they must be defined on a model but these were used without definition so I wanted to know where they’re coming from.</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4860" data-commentid="4860" data-postid="2033" data-belowelement="div-comment-4860" data-respondelement="respond" data-replyto="Reply to Hirwa Blessing" aria-label="Reply to Hirwa Blessing">Reply</a></div></article><ol class="children"><li id="comment-5575" class="comment even depth-4"><article id="div-comment-5575" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/f5b0d62ef1ec1149418942cffb1bcc3f.png" srcset="https://secure.gravatar.com/avatar/f5b0d62ef1ec1149418942cffb1bcc3f?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">M. Tayyab Ferozi</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-5575"><time datetime="2020-11-27T04:43:36+00:00">November 27, 2020 at 4:43 am</time></a></div></footer><div class="comment-content"><p>This is the magic of sequelize, please read the docs</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-5575" data-commentid="5575" data-postid="2033" data-belowelement="div-comment-5575" data-respondelement="respond" data-replyto="Reply to M. Tayyab Ferozi" aria-label="Reply to M. Tayyab Ferozi">Reply</a></div></article></li></ol></li></ol></li></ol></li><li id="comment-354" class="comment odd alt thread-odd thread-alt depth-1 parent"><article id="div-comment-354" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/ec4cae19480e679f921a0a82a387de77.jpeg" srcset="https://secure.gravatar.com/avatar/ec4cae19480e679f921a0a82a387de77?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Pedro Schmitt</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-354"><time datetime="2020-02-13T16:03:12+00:00">February 13, 2020 at 4:03 pm</time></a></div></footer><div class="comment-content"><p>Great walkthrough! Helped a lot.<br> I like the way that you organize the models, controllers and routes in every tutorial.</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-354" data-commentid="354" data-postid="2033" data-belowelement="div-comment-354" data-respondelement="respond" data-replyto="Reply to Pedro Schmitt" aria-label="Reply to Pedro Schmitt">Reply</a></div></article><ol class="children"><li id="comment-355" class="comment byuser comment-author-bezkoder bypostauthor even depth-2"><article id="div-comment-355" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/40150b9299e69015bc46c30598a81888.png" srcset="https://secure.gravatar.com/avatar/40150b9299e69015bc46c30598a81888?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">bezkoder</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-355"><time datetime="2020-02-13T23:50:14+00:00">February 13, 2020 at 11:50 pm</time></a></div></footer><div class="comment-content"><p>Thanks! I’m so happy to here that.</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-355" data-commentid="355" data-postid="2033" data-belowelement="div-comment-355" data-respondelement="respond" data-replyto="Reply to bezkoder" aria-label="Reply to bezkoder">Reply</a></div></article></li></ol></li><li id="comment-462" class="comment odd alt thread-even depth-1 parent"><article id="div-comment-462" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/a063a933a0d5e6539eee60399c6835fe.png" srcset="https://secure.gravatar.com/avatar/a063a933a0d5e6539eee60399c6835fe?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Ben</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-462"><time datetime="2020-03-05T18:14:11+00:00">March 5, 2020 at 6:14 pm</time></a></div></footer><div class="comment-content"><p>Great Tutorial, thank you very much! It helped very much with my project 🙂 I still have one question though – I hope you’ll be able to help:</p><p>Everything is working and I am trying to build a page where an admin can change the User Roles of a specific user. Right now, I have no Idea what to change or how I would implement this on the backend site. How can I update a User and send a new array of roles to the backend and update the belongsToMany association?</p><p>Thanks in advance!</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-462" data-commentid="462" data-postid="2033" data-belowelement="div-comment-462" data-respondelement="respond" data-replyto="Reply to Ben" aria-label="Reply to Ben">Reply</a></div></article><ol class="children"><li id="comment-464" class="comment byuser comment-author-bezkoder bypostauthor even depth-2"><article id="div-comment-464" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/40150b9299e69015bc46c30598a81888.png" srcset="https://secure.gravatar.com/avatar/40150b9299e69015bc46c30598a81888?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">bezkoder</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-464"><time datetime="2020-03-06T02:04:56+00:00">March 6, 2020 at 2:04 am</time></a></div></footer><div class="comment-content"><p>Hi, you can add a new route with <code>[authJwt.verifyToken, authJwt.isAdmin]</code> middlewares. This route calls controller method that updates just one table: <em>user_roles</em>.</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-464" data-commentid="464" data-postid="2033" data-belowelement="div-comment-464" data-respondelement="respond" data-replyto="Reply to bezkoder" aria-label="Reply to bezkoder">Reply</a></div></article></li><li id="comment-2204" class="comment odd alt depth-2 parent"><article id="div-comment-2204" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/b9c2cf3cab4010c6788356a3db490d29.jpeg" srcset="https://secure.gravatar.com/avatar/b9c2cf3cab4010c6788356a3db490d29?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Encrypter</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2204"><time datetime="2020-05-10T15:10:14+00:00">May 10, 2020 at 3:10 pm</time></a></div></footer><div class="comment-content"><p>Hi Ben, I’m trying to implement the same thing.<br> Did you achieve a solution to it?</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2204" data-commentid="2204" data-postid="2033" data-belowelement="div-comment-2204" data-respondelement="respond" data-replyto="Reply to Encrypter" aria-label="Reply to Encrypter">Reply</a></div></article><ol class="children"><li id="comment-2226" class="comment even depth-3"><article id="div-comment-2226" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/b9c2cf3cab4010c6788356a3db490d29.jpeg" srcset="https://secure.gravatar.com/avatar/b9c2cf3cab4010c6788356a3db490d29?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Encrypter</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2226"><time datetime="2020-05-11T08:31:33+00:00">May 11, 2020 at 8:31 am</time></a></div></footer><div class="comment-content"><p>Solved, thanks a lot Bezkoder!</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2226" data-commentid="2226" data-postid="2033" data-belowelement="div-comment-2226" data-respondelement="respond" data-replyto="Reply to Encrypter" aria-label="Reply to Encrypter">Reply</a></div></article></li></ol></li></ol></li><li id="comment-465" class="comment odd alt thread-odd thread-alt depth-1 parent"><article id="div-comment-465" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/71b7febaf585e8a0683f2b6324ab7acd.png" srcset="https://secure.gravatar.com/avatar/71b7febaf585e8a0683f2b6324ab7acd?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Patrick Seewald</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-465"><time datetime="2020-03-06T09:45:43+00:00">March 6, 2020 at 9:45 am</time></a></div></footer><div class="comment-content"><p>Hi, really Great Tutorial, but i have the problem, that the Signup doesnt work</p><p>I checked out your source code from github, but i get the following message:</p><p>Unhandled rejection Error: WHERE parameter “username” has invalid “undefined” value</p><p>I think it is inside the verifysignup middleware – maybe you can imagine whats wrong?</p><p>Thanks in Advance</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-465" data-commentid="465" data-postid="2033" data-belowelement="div-comment-465" data-respondelement="respond" data-replyto="Reply to Patrick Seewald" aria-label="Reply to Patrick Seewald">Reply</a></div></article><ol class="children"><li id="comment-467" class="comment byuser comment-author-bezkoder bypostauthor even depth-2 parent"><article id="div-comment-467" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/40150b9299e69015bc46c30598a81888.png" srcset="https://secure.gravatar.com/avatar/40150b9299e69015bc46c30598a81888?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">bezkoder</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-467"><time datetime="2020-03-06T14:00:24+00:00">March 6, 2020 at 2:00 pm</time></a></div></footer><div class="comment-content"><p>Hi, how did you send POST request? Did you set appropriate Header: <code>Content-Type: application/json</code>?</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-467" data-commentid="467" data-postid="2033" data-belowelement="div-comment-467" data-respondelement="respond" data-replyto="Reply to bezkoder" aria-label="Reply to bezkoder">Reply</a></div></article><ol class="children"><li id="comment-6090" class="comment odd alt depth-3"><article id="div-comment-6090" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/a94bf20b22ce8c9ace9bfa94d1415740.png" srcset="https://secure.gravatar.com/avatar/a94bf20b22ce8c9ace9bfa94d1415740?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Shannon Lee</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-6090"><time datetime="2021-01-05T18:40:17+00:00">January 5, 2021 at 6:40 pm</time></a></div></footer><div class="comment-content"><p>Thank you! In postman, I had to change the content type from Text to JSON, and now it works 🙂</p><p>For those looking for it, it’s below the text field where you input “http://localhost:8080/api/auth/signup”</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-6090" data-commentid="6090" data-postid="2033" data-belowelement="div-comment-6090" data-respondelement="respond" data-replyto="Reply to Shannon Lee" aria-label="Reply to Shannon Lee">Reply</a></div></article></li></ol></li><li id="comment-2569" class="comment even depth-2 parent"><article id="div-comment-2569" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/0914ac3b80a788acd1d4331c56e33720.jpeg" srcset="https://secure.gravatar.com/avatar/0914ac3b80a788acd1d4331c56e33720?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Rahul Sahni</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2569"><time datetime="2020-05-18T12:35:15+00:00">May 18, 2020 at 12:35 pm</time></a></div></footer><div class="comment-content"><p>shift these lines:<br> // routes<br> require(‘./app/routes/auth.routes’)(app);<br> require(‘./app/routes/user.routes’)(app);</p><p>below :</p><p>// parse requests of content-type – application/json<br> app.use(bodyParser.json());</p><p>// parse requests of content-type – application/x-www-form-urlencoded<br> app.use(bodyParser.urlencoded({ extended: true }));</p><p>It will work, the issue is routes are called before parsing JSON so it gets undefined in the body.<br> Hope this will help someone facing the same issue.<br> Thanks a lot, bezkoder for this great tutorial 🙂</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2569" data-commentid="2569" data-postid="2033" data-belowelement="div-comment-2569" data-respondelement="respond" data-replyto="Reply to Rahul Sahni" aria-label="Reply to Rahul Sahni">Reply</a></div></article><ol class="children"><li id="comment-2691" class="comment odd alt depth-3 parent"><article id="div-comment-2691" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/245e0fdd249d546ff2a9a7a2c6c32329.png" srcset="https://secure.gravatar.com/avatar/245e0fdd249d546ff2a9a7a2c6c32329?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Robson</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2691"><time datetime="2020-05-20T14:33:23+00:00">May 20, 2020 at 2:33 pm</time></a></div></footer><div class="comment-content"><p>Did not work.</p><p>TypeError: Cannot read property ‘username’ of undefined</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2691" data-commentid="2691" data-postid="2033" data-belowelement="div-comment-2691" data-respondelement="respond" data-replyto="Reply to Robson" aria-label="Reply to Robson">Reply</a></div></article><ol class="children"><li id="comment-4825" class="comment even depth-4"><article id="div-comment-4825" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/6438860b760d80509b11f2d7c63a9c22.png" srcset="https://secure.gravatar.com/avatar/6438860b760d80509b11f2d7c63a9c22?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Arman</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4825"><time datetime="2020-09-23T22:03:55+00:00">September 23, 2020 at 10:03 pm</time></a></div></footer><div class="comment-content"><p>Try to restart node server..</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4825" data-commentid="4825" data-postid="2033" data-belowelement="div-comment-4825" data-respondelement="respond" data-replyto="Reply to Arman" aria-label="Reply to Arman">Reply</a></div></article></li></ol></li><li id="comment-3397" class="comment odd alt depth-3"><article id="div-comment-3397" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/340ff4010d243fceea6995bf7e4f8f47.png" srcset="https://secure.gravatar.com/avatar/340ff4010d243fceea6995bf7e4f8f47?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Luky</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3397"><time datetime="2020-06-22T06:57:29+00:00">June 22, 2020 at 6:57 am</time></a></div></footer><div class="comment-content"><p>Thankyou Rahul, your solution works just awesome</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3397" data-commentid="3397" data-postid="2033" data-belowelement="div-comment-3397" data-respondelement="respond" data-replyto="Reply to Luky" aria-label="Reply to Luky">Reply</a></div></article></li></ol></li></ol></li><li id="comment-506" class="comment even thread-even depth-1 parent"><article id="div-comment-506" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/8ba20070a5e04f37a83928e4edba2d28.png" srcset="https://secure.gravatar.com/avatar/8ba20070a5e04f37a83928e4edba2d28?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">tony</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-506"><time datetime="2020-03-12T11:41:27+00:00">March 12, 2020 at 11:41 am</time></a></div></footer><div class="comment-content"><p>Hi. I have a problem whereby every time I start the server through “node server.js”  command everything in the database gets reset. It’s making development a bit harder. Can you help with this??</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-506" data-commentid="506" data-postid="2033" data-belowelement="div-comment-506" data-respondelement="respond" data-replyto="Reply to tony" aria-label="Reply to tony">Reply</a></div></article><ol class="children"><li id="comment-507" class="comment byuser comment-author-bezkoder bypostauthor odd alt depth-2"><article id="div-comment-507" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/40150b9299e69015bc46c30598a81888.png" srcset="https://secure.gravatar.com/avatar/40150b9299e69015bc46c30598a81888?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">bezkoder</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-507"><time datetime="2020-03-12T13:17:32+00:00">March 12, 2020 at 1:17 pm</time></a></div></footer><div class="comment-content"><p>Hi, you can change:<br> <code>db.sequelize.sync({force: true})</code><br> to:<br> <code>db.sequelize.sync()</code></p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-507" data-commentid="507" data-postid="2033" data-belowelement="div-comment-507" data-respondelement="respond" data-replyto="Reply to bezkoder" aria-label="Reply to bezkoder">Reply</a></div></article></li></ol></li><li id="comment-513" class="comment even thread-odd thread-alt depth-1 parent"><article id="div-comment-513" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/7a3156931a17c1058720bafd39e0ae40.png" srcset="https://secure.gravatar.com/avatar/7a3156931a17c1058720bafd39e0ae40?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Mrudang</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-513"><time datetime="2020-03-13T04:02:20+00:00">March 13, 2020 at 4:02 am</time></a></div></footer><div class="comment-content"><p>I am not able to signup and login based on User Mod,Admin</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-513" data-commentid="513" data-postid="2033" data-belowelement="div-comment-513" data-respondelement="respond" data-replyto="Reply to Mrudang" aria-label="Reply to Mrudang">Reply</a></div></article><ol class="children"><li id="comment-528" class="comment byuser comment-author-bezkoder bypostauthor odd alt depth-2"><article id="div-comment-528" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/40150b9299e69015bc46c30598a81888.png" srcset="https://secure.gravatar.com/avatar/40150b9299e69015bc46c30598a81888?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">bezkoder</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-528"><time datetime="2020-03-14T08:51:50+00:00">March 14, 2020 at 8:51 am</time></a></div></footer><div class="comment-content"><p>Hi, please make sure that you’ve inserted 3 rows into Roles table first.</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-528" data-commentid="528" data-postid="2033" data-belowelement="div-comment-528" data-respondelement="respond" data-replyto="Reply to bezkoder" aria-label="Reply to bezkoder">Reply</a></div></article></li></ol></li><li id="comment-546" class="comment even thread-even depth-1 parent"><article id="div-comment-546" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/af2b30e4c82af445612e7207c97b1fde.png" srcset="https://secure.gravatar.com/avatar/af2b30e4c82af445612e7207c97b1fde?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Louis Philippe Facun</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-546"><time datetime="2020-03-16T14:11:37+00:00">March 16, 2020 at 2:11 pm</time></a></div></footer><div class="comment-content"><p>Can we have a version without serialize please? I already made my tables using serialize messes my erd design 🙁</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-546" data-commentid="546" data-postid="2033" data-belowelement="div-comment-546" data-respondelement="respond" data-replyto="Reply to Louis Philippe Facun" aria-label="Reply to Louis Philippe Facun">Reply</a></div></article><ol class="children"><li id="comment-562" class="comment byuser comment-author-bezkoder bypostauthor odd alt depth-2"><article id="div-comment-562" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/40150b9299e69015bc46c30598a81888.png" srcset="https://secure.gravatar.com/avatar/40150b9299e69015bc46c30598a81888?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">bezkoder</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-562"><time datetime="2020-03-18T01:01:37+00:00">March 18, 2020 at 1:01 am</time></a></div></footer><div class="comment-content"><p>Hi, you can find it here: <a href="https://bezkoder.com/node-js-rest-api-express-mysql/">Build Node.js Rest APIs with Express &amp; MySQL</a></p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-562" data-commentid="562" data-postid="2033" data-belowelement="div-comment-562" data-respondelement="respond" data-replyto="Reply to bezkoder" aria-label="Reply to bezkoder">Reply</a></div></article></li></ol></li><li id="comment-600" class="comment even thread-odd thread-alt depth-1 parent"><article id="div-comment-600" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/af491143c925b525af5537c18e816b93.jpeg" srcset="https://secure.gravatar.com/avatar/af491143c925b525af5537c18e816b93?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Khairul</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-600"><time datetime="2020-03-23T10:17:06+00:00">March 23, 2020 at 10:17 am</time></a></div></footer><div class="comment-content"><p>Hi, really Great Tutorial, but i have the problem,<br> when Access protected resources: GET /api/test/mod<br> Access protected resources: GET /api/test/mod<br> Error: Unhandled rejection TypeError: Cannot read property ‘getRoles’ of null</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-600" data-commentid="600" data-postid="2033" data-belowelement="div-comment-600" data-respondelement="respond" data-replyto="Reply to Khairul" aria-label="Reply to Khairul">Reply</a></div></article><ol class="children"><li id="comment-601" class="comment odd alt depth-2"><article id="div-comment-601" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/af491143c925b525af5537c18e816b93.jpeg" srcset="https://secure.gravatar.com/avatar/af491143c925b525af5537c18e816b93?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Khairul</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-601"><time datetime="2020-03-23T10:18:13+00:00">March 23, 2020 at 10:18 am</time></a></div></footer><div class="comment-content"><p>Access protected resources: GET /api/test/admin</p><p>Error: Unhandled rejection TypeError: Cannot read property ‘getRoles’ of null</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-601" data-commentid="601" data-postid="2033" data-belowelement="div-comment-601" data-respondelement="respond" data-replyto="Reply to Khairul" aria-label="Reply to Khairul">Reply</a></div></article></li><li id="comment-602" class="comment byuser comment-author-bezkoder bypostauthor even depth-2"><article id="div-comment-602" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/40150b9299e69015bc46c30598a81888.png" srcset="https://secure.gravatar.com/avatar/40150b9299e69015bc46c30598a81888?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">bezkoder</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-602"><time datetime="2020-03-23T11:35:56+00:00">March 23, 2020 at 11:35 am</time></a></div></footer><div class="comment-content"><p>Hi, did you run <code>initial()</code> function to create 3 row in <code>roles</code> table?</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-602" data-commentid="602" data-postid="2033" data-belowelement="div-comment-602" data-respondelement="respond" data-replyto="Reply to bezkoder" aria-label="Reply to bezkoder">Reply</a></div></article></li></ol></li><li id="comment-635" class="comment odd alt thread-even depth-1"><article id="div-comment-635" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/80bcd228afd794c7d64a4aa4e9d065f9.png" srcset="https://secure.gravatar.com/avatar/80bcd228afd794c7d64a4aa4e9d065f9?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">cherif</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-635"><time datetime="2020-03-25T13:24:43+00:00">March 25, 2020 at 1:24 pm</time></a></div></footer><div class="comment-content"><p>HI, I love your work i found this walk through complete.</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-635" data-commentid="635" data-postid="2033" data-belowelement="div-comment-635" data-respondelement="respond" data-replyto="Reply to cherif" aria-label="Reply to cherif">Reply</a></div></article></li><li id="comment-721" class="comment even thread-odd thread-alt depth-1"><article id="div-comment-721" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/10e29f09c9bbe8f7a79eaa51aa0ee7e3.png" srcset="https://secure.gravatar.com/avatar/10e29f09c9bbe8f7a79eaa51aa0ee7e3?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Lomas</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-721"><time datetime="2020-04-03T16:51:46+00:00">April 3, 2020 at 4:51 pm</time></a></div></footer><div class="comment-content"><p>Thank you so much, this is one of the best Node.js JWT tutorial I’ve read!</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-721" data-commentid="721" data-postid="2033" data-belowelement="div-comment-721" data-respondelement="respond" data-replyto="Reply to Lomas" aria-label="Reply to Lomas">Reply</a></div></article></li><li id="comment-728" class="comment odd alt thread-even depth-1"><article id="div-comment-728" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/0cfde679535e331968e9bfe797a3b58a.png" srcset="https://secure.gravatar.com/avatar/0cfde679535e331968e9bfe797a3b58a?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">lightfan</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-728"><time datetime="2020-04-04T14:12:55+00:00">April 4, 2020 at 2:12 pm</time></a></div></footer><div class="comment-content"><p>Thanks for sharing your code for this Node.js JWT auth. It works like a charm!</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-728" data-commentid="728" data-postid="2033" data-belowelement="div-comment-728" data-respondelement="respond" data-replyto="Reply to lightfan" aria-label="Reply to lightfan">Reply</a></div></article></li><li id="comment-841" class="comment even thread-odd thread-alt depth-1 parent"><article id="div-comment-841" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/6ecfe173331c0e09a4c7f60a1d198416.png" srcset="https://secure.gravatar.com/avatar/6ecfe173331c0e09a4c7f60a1d198416?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Sunflower</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-841"><time datetime="2020-04-12T09:52:01+00:00">April 12, 2020 at 9:52 am</time></a></div></footer><div class="comment-content"><p>Bezkoder, your tutorials are just awesome, thank you very much for your work 🙂<br> Maybe u have this version without roles(admin, moder) only user?<br> If yes, could you please share it?</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-841" data-commentid="841" data-postid="2033" data-belowelement="div-comment-841" data-respondelement="respond" data-replyto="Reply to Sunflower" aria-label="Reply to Sunflower">Reply</a></div></article><ol class="children"><li id="comment-856" class="comment byuser comment-author-bezkoder bypostauthor odd alt depth-2"><article id="div-comment-856" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/40150b9299e69015bc46c30598a81888.png" srcset="https://secure.gravatar.com/avatar/40150b9299e69015bc46c30598a81888?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">bezkoder</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-856"><time datetime="2020-04-14T03:36:15+00:00">April 14, 2020 at 3:36 am</time></a></div></footer><div class="comment-content"><p>Hi, admin or moderator is just a role. You can remove them in the define steps of the model.<br> Try your best to do it. 🙂</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-856" data-commentid="856" data-postid="2033" data-belowelement="div-comment-856" data-respondelement="respond" data-replyto="Reply to bezkoder" aria-label="Reply to bezkoder">Reply</a></div></article></li></ol></li><li id="comment-891" class="comment even thread-even depth-1 parent"><article id="div-comment-891" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/126e35d72316200d5949c790194b85d6.png" srcset="https://secure.gravatar.com/avatar/126e35d72316200d5949c790194b85d6?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">MOHSEN</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-891"><time datetime="2020-04-17T05:59:16+00:00">April 17, 2020 at 5:59 am</time></a></div></footer><div class="comment-content"><p>Thanks for this useful tutorial. When I run the node server.js after cloned the source code from GitHub I have following error. Unfortunately I couldn’t find any solution for that. Do you have any suggestions for that?</p><p>Unhandled rejection SequelizeConnectionRefusedError: connect ECONNREFUSED 127.0.0.1:3306<br> at C:\Users\ShojaMo\webApp\tasktracker\node_modules\sequelize\lib\dialects\mysql\connection-manager.js:123:19<br> at tryCatcher (C:\Users\ShojaMo\webApp\tasktracker\node_modules\bluebird\js\release\util.js:16:23)<br> at Promise._settlePromiseFromHandler (C:\Users\ShojaMo\webApp\tasktracker\node_modules\bluebird\js\release\promise.js:547:31)<br> at Promise._settlePromise (C:\Users\ShojaMo\webApp\tasktracker\node_modules\bluebird\js\release\promise.js:604:18)<br> at Promise._settlePromise0 (C:\Users\ShojaMo\webApp\tasktracker\node_modules\bluebird\js\release\promise.js:649:10)<br> at Promise._settlePromises (C:\Users\ShojaMo\webApp\tasktracker\node_modules\bluebird\js\release\promise.js:725:18)<br> at _drainQueueStep (C:\Users\ShojaMo\webApp\tasktracker\node_modules\bluebird\js\release\async.js:93:12)<br> at _drainQueue (C:\Users\ShojaMo\webApp\tasktracker\node_modules\bluebird\js\release\async.js:86:9)<br> at Async._drainQueues (C:\Users\ShojaMo\webApp\tasktracker\node_modules\bluebird\js\release\async.js:102:5)<br> at Immediate.Async.drainQueues [as _onImmediate] (C:\Users\ShojaMo\webApp\tasktracker\node_modules\bluebird\js\release\async.js:15:14)<br> at processImmediate (internal/timers.js:456:21)</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-891" data-commentid="891" data-postid="2033" data-belowelement="div-comment-891" data-respondelement="respond" data-replyto="Reply to MOHSEN" aria-label="Reply to MOHSEN">Reply</a></div></article><ol class="children"><li id="comment-892" class="comment byuser comment-author-bezkoder bypostauthor odd alt depth-2 parent"><article id="div-comment-892" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/40150b9299e69015bc46c30598a81888.png" srcset="https://secure.gravatar.com/avatar/40150b9299e69015bc46c30598a81888?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">bezkoder</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-892"><time datetime="2020-04-17T06:02:08+00:00">April 17, 2020 at 6:02 am</time></a></div></footer><div class="comment-content"><p>Hi, please make sure that you’ve already run MySQL database with correct configuration.</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-892" data-commentid="892" data-postid="2033" data-belowelement="div-comment-892" data-respondelement="respond" data-replyto="Reply to bezkoder" aria-label="Reply to bezkoder">Reply</a></div></article><ol class="children"><li id="comment-894" class="comment even depth-3"><article id="div-comment-894" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/126e35d72316200d5949c790194b85d6.png" srcset="https://secure.gravatar.com/avatar/126e35d72316200d5949c790194b85d6?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">MOHSEN</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-894"><time datetime="2020-04-17T06:28:43+00:00">April 17, 2020 at 6:28 am</time></a></div></footer><div class="comment-content"><p>Thank you for quick response 🙂</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-894" data-commentid="894" data-postid="2033" data-belowelement="div-comment-894" data-respondelement="respond" data-replyto="Reply to MOHSEN" aria-label="Reply to MOHSEN">Reply</a></div></article></li><li id="comment-1847" class="comment odd alt depth-3 parent"><article id="div-comment-1847" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/b35d9464e017c4683845cc6663f1f101.png" srcset="https://secure.gravatar.com/avatar/b35d9464e017c4683845cc6663f1f101?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Felipe</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-1847"><time datetime="2020-04-30T21:25:37+00:00">April 30, 2020 at 9:25 pm</time></a></div></footer><div class="comment-content"><p>Hi, I’m connecting in my db normaly using MySQL Workbench, but when I try to conect the application with database I have the follow error:</p><p>Unhandled rejection SequelizeConnectionRefusedError: connect ECONNREFUSED 127.0.0.1:3306</p><p>How said Mohsen , infortunately I couldn’t find any solution for that. Do you have any others suggestions for that?</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-1847" data-commentid="1847" data-postid="2033" data-belowelement="div-comment-1847" data-respondelement="respond" data-replyto="Reply to Felipe" aria-label="Reply to Felipe">Reply</a></div></article><ol class="children"><li id="comment-1848" class="comment even depth-4"><article id="div-comment-1848" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/b35d9464e017c4683845cc6663f1f101.png" srcset="https://secure.gravatar.com/avatar/b35d9464e017c4683845cc6663f1f101?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Felipe</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-1848"><time datetime="2020-04-30T21:38:05+00:00">April 30, 2020 at 9:38 pm</time></a></div></footer><div class="comment-content"><p>Resolved! My config db was wrong kkkkkkk</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-1848" data-commentid="1848" data-postid="2033" data-belowelement="div-comment-1848" data-respondelement="respond" data-replyto="Reply to Felipe" aria-label="Reply to Felipe">Reply</a></div></article></li></ol></li></ol></li><li id="comment-893" class="comment odd alt depth-2"><article id="div-comment-893" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/126e35d72316200d5949c790194b85d6.png" srcset="https://secure.gravatar.com/avatar/126e35d72316200d5949c790194b85d6?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">MOHSEN</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-893"><time datetime="2020-04-17T06:17:17+00:00">April 17, 2020 at 6:17 am</time></a></div></footer><div class="comment-content"><p>Actually, I ran the code on Win and Mac and both have the same issue! It looks like something is wrong when it tries to run the database. Thanks in advance for any suggestions.</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-893" data-commentid="893" data-postid="2033" data-belowelement="div-comment-893" data-respondelement="respond" data-replyto="Reply to MOHSEN" aria-label="Reply to MOHSEN">Reply</a></div></article></li></ol></li><li id="comment-1015" class="comment even thread-odd thread-alt depth-1 parent"><article id="div-comment-1015" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/70b0782db9f153bf85a7457d7617b5f1.png" srcset="https://secure.gravatar.com/avatar/70b0782db9f153bf85a7457d7617b5f1?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Patrickson</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-1015"><time datetime="2020-04-21T01:06:48+00:00">April 21, 2020 at 1:06 am</time></a></div></footer><div class="comment-content"><p>Hi Mr Bezkoder,<br> Congratulations on this excellent tutorial. That’s what I’ve been looking for ever since.<br> However, I have a hard time integrating this Backend into uen Development FrontEnd React with Redux and JWT Passport.</p><p>Could you help me? I’m new to ReactJS Development.<br> Thank you</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-1015" data-commentid="1015" data-postid="2033" data-belowelement="div-comment-1015" data-respondelement="respond" data-replyto="Reply to Patrickson" aria-label="Reply to Patrickson">Reply</a></div></article><ol class="children"><li id="comment-1034" class="comment byuser comment-author-bezkoder bypostauthor odd alt depth-2"><article id="div-comment-1034" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/40150b9299e69015bc46c30598a81888.png" srcset="https://secure.gravatar.com/avatar/40150b9299e69015bc46c30598a81888?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">bezkoder</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-1034"><time datetime="2020-04-21T03:15:40+00:00">April 21, 2020 at 3:15 am</time></a></div></footer><div class="comment-content"><p>Hi, I will write the tutorial when having time 🙂</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-1034" data-commentid="1034" data-postid="2033" data-belowelement="div-comment-1034" data-respondelement="respond" data-replyto="Reply to bezkoder" aria-label="Reply to bezkoder">Reply</a></div></article></li></ol></li><li id="comment-1123" class="comment even thread-even depth-1 parent"><article id="div-comment-1123" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/46ddab28d09b5a30382311633e245e45.png" srcset="https://secure.gravatar.com/avatar/46ddab28d09b5a30382311633e245e45?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Megha</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-1123"><time datetime="2020-04-22T08:16:40+00:00">April 22, 2020 at 8:16 am</time></a></div></footer><div class="comment-content"><p>how can i integrate in your existing crud application model? that is tutorials?</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-1123" data-commentid="1123" data-postid="2033" data-belowelement="div-comment-1123" data-respondelement="respond" data-replyto="Reply to Megha" aria-label="Reply to Megha">Reply</a></div></article><ol class="children"><li id="comment-1283" class="comment byuser comment-author-bezkoder bypostauthor odd alt depth-2"><article id="div-comment-1283" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/40150b9299e69015bc46c30598a81888.png" srcset="https://secure.gravatar.com/avatar/40150b9299e69015bc46c30598a81888?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">bezkoder</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-1283"><time datetime="2020-04-22T22:51:48+00:00">April 22, 2020 at 10:51 pm</time></a></div></footer><div class="comment-content"><p>Hi, you can create more routes and controllers, then apply auth middleware on the routes 🙂</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-1283" data-commentid="1283" data-postid="2033" data-belowelement="div-comment-1283" data-respondelement="respond" data-replyto="Reply to bezkoder" aria-label="Reply to bezkoder">Reply</a></div></article></li></ol></li><li id="comment-1793" class="comment even thread-odd thread-alt depth-1 parent"><article id="div-comment-1793" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/20f9eca02533c2c726fd72993d0f67c7.png" srcset="https://secure.gravatar.com/avatar/20f9eca02533c2c726fd72993d0f67c7?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Kusuma</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-1793"><time datetime="2020-04-29T18:24:46+00:00">April 29, 2020 at 6:24 pm</time></a></div></footer><div class="comment-content"><p>Hi really great tutorial.<br> how to insert data to multiple tables at a time – parent/child relationship in nodejs to mySql ?<br> Could you help me? I’m new to node.js Development.</p><p>Relationship between Product &amp; ProductDetails tables.<br> Sample JSON object:</p><pre class=" language-bash"><code class=" language-bash">{
"productName":"laptop",
"inv_date":"2020-04-01",
"productDetails":[
		{
			"name":"HP 15.6inc 64GB",
			"price":34052
		},
		{
			"name":"Dell 16.4inc 64GB",
			"price":37761
		},
		{
			"name":"Acer 14inc Spin 3",
			"price":32464
		},
		{
			"name":"Refurb HP Spectre x360 ",
			"price":54150
		}
	]
}
</code></pre></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-1793" data-commentid="1793" data-postid="2033" data-belowelement="div-comment-1793" data-respondelement="respond" data-replyto="Reply to Kusuma" aria-label="Reply to Kusuma">Reply</a></div></article><ol class="children"><li id="comment-1802" class="comment byuser comment-author-bezkoder bypostauthor odd alt depth-2 parent"><article id="div-comment-1802" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/40150b9299e69015bc46c30598a81888.png" srcset="https://secure.gravatar.com/avatar/40150b9299e69015bc46c30598a81888?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">bezkoder</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-1802"><time datetime="2020-04-29T23:56:37+00:00">April 29, 2020 at 11:56 pm</time></a></div></footer><div class="comment-content"><p>Hi, I think you should rename the entities first, for example:<br> – ProductName -&gt; Category<br> – ProductDetails -&gt; Product</p><p>Then you can read this tutorial for working with One-to-Many Relationship in Node.js:<br> <a href="https://bezkoder.com/sequelize-associate-one-to-many/">Sequelize One-to-Many Association example with Node.js &amp; MySQL</a></p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-1802" data-commentid="1802" data-postid="2033" data-belowelement="div-comment-1802" data-respondelement="respond" data-replyto="Reply to bezkoder" aria-label="Reply to bezkoder">Reply</a></div></article><ol class="children"><li id="comment-1855" class="comment even depth-3"><article id="div-comment-1855" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/20f9eca02533c2c726fd72993d0f67c7.png" srcset="https://secure.gravatar.com/avatar/20f9eca02533c2c726fd72993d0f67c7?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Kusuma</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-1855"><time datetime="2020-05-01T10:28:29+00:00">May 1, 2020 at 10:28 am</time></a></div></footer><div class="comment-content"><p>Thank you so much , its improves productivity in less time and works fine 🙂</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-1855" data-commentid="1855" data-postid="2033" data-belowelement="div-comment-1855" data-respondelement="respond" data-replyto="Reply to Kusuma" aria-label="Reply to Kusuma">Reply</a></div></article></li><li id="comment-1870" class="comment odd alt depth-3"><article id="div-comment-1870" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/20f9eca02533c2c726fd72993d0f67c7.png" srcset="https://secure.gravatar.com/avatar/20f9eca02533c2c726fd72993d0f67c7?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Kusuma</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-1870"><time datetime="2020-05-02T07:27:50+00:00">May 2, 2020 at 7:27 am</time></a></div></footer><div class="comment-content"><p>Hi,<br> Really it’s a good tutorial.Is there anyway to generate( swagger integration) some default documentation without writing the API Documentations (comments)  manually? Like in ASP.NET core.</p><p>Sample swagger documentation comments in each routing page:<br> /**<br> * @swagger<br> * /registerUser:<br> *   post:<br> *     tags:<br> *       – Users<br> *     name: Register<br> *     summary: Register a new user<br> *     consumes:<br> *       – application/json<br> *     produces:<br> *       – application/json<br> *     parameters:<br> *       – name: body<br> *         in: body<br> *         schema:<br> *           $ref: ‘#/definitions/User’<br> *           type: object<br> *           properties:<br> *             first_name:<br> *               type: string<br> *             last_name:<br> *               type: string<br> *             username:<br> *               type: string<br> *             email:<br> *               type: string<br> *             password:<br> *               type: string<br> *               format: password<br> *         required:<br> *           – username<br> *           – email<br> *           – password<br> *     responses:<br> *       ‘200’:<br> *         description: User created<br> *       ‘403’:<br> *         description: Username or email already taken<br> */</p><p>Thanks in advance.</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-1870" data-commentid="1870" data-postid="2033" data-belowelement="div-comment-1870" data-respondelement="respond" data-replyto="Reply to Kusuma" aria-label="Reply to Kusuma">Reply</a></div></article></li></ol></li><li id="comment-3805" class="comment even depth-2"><article id="div-comment-3805" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/21e041fa6e482d2160d0c6ce203eb65a.png" srcset="https://secure.gravatar.com/avatar/21e041fa6e482d2160d0c6ce203eb65a?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Venkatesh Krishnappa</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3805"><time datetime="2020-07-18T04:45:35+00:00">July 18, 2020 at 4:45 am</time></a></div></footer><div class="comment-content"><p>You can check out Sequelize, an ORM for Node.  It is easy to use and provides ability to represent such relationships</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3805" data-commentid="3805" data-postid="2033" data-belowelement="div-comment-3805" data-respondelement="respond" data-replyto="Reply to Venkatesh Krishnappa" aria-label="Reply to Venkatesh Krishnappa">Reply</a></div></article></li></ol></li><li id="comment-2086" class="comment odd alt thread-even depth-1 parent"><article id="div-comment-2086" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/857dade87d4b56e51a8638ee3560dde3.png" srcset="https://secure.gravatar.com/avatar/857dade87d4b56e51a8638ee3560dde3?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Manish Upadhyaya</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2086"><time datetime="2020-05-08T04:40:22+00:00">May 8, 2020 at 4:40 am</time></a></div></footer><div class="comment-content"><p>I am having an issue with <code>user.setRoles()</code> is not a function in my <code>signUp</code> request:</p><p>{<br> “message”: “user.setRoles is not a function”<br> }</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2086" data-commentid="2086" data-postid="2033" data-belowelement="div-comment-2086" data-respondelement="respond" data-replyto="Reply to Manish Upadhyaya" aria-label="Reply to Manish Upadhyaya">Reply</a></div></article><ol class="children"><li id="comment-2092" class="comment byuser comment-author-bezkoder bypostauthor even depth-2 parent"><article id="div-comment-2092" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/40150b9299e69015bc46c30598a81888.png" srcset="https://secure.gravatar.com/avatar/40150b9299e69015bc46c30598a81888?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">bezkoder</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2092"><time datetime="2020-05-08T06:34:29+00:00">May 8, 2020 at 6:34 am</time></a></div></footer><div class="comment-content"><p>Hi, please make sure that you’ve initialized Sequelize object and models correctly.</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2092" data-commentid="2092" data-postid="2033" data-belowelement="div-comment-2092" data-respondelement="respond" data-replyto="Reply to bezkoder" aria-label="Reply to bezkoder">Reply</a></div></article><ol class="children"><li id="comment-2753" class="comment odd alt depth-3 parent"><article id="div-comment-2753" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/bf1c84d802a2ed20ca6ffd3ab8949b8d.png" srcset="https://secure.gravatar.com/avatar/bf1c84d802a2ed20ca6ffd3ab8949b8d?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">TJ</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2753"><time datetime="2020-05-22T16:31:42+00:00">May 22, 2020 at 4:31 pm</time></a></div></footer><div class="comment-content"><p>Hi i have the same error, I was wondering if you could explain where the setRoles function is coming from, is it automatically generated?</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2753" data-commentid="2753" data-postid="2033" data-belowelement="div-comment-2753" data-respondelement="respond" data-replyto="Reply to TJ" aria-label="Reply to TJ">Reply</a></div></article><ol class="children"><li id="comment-2868" class="comment byuser comment-author-bezkoder bypostauthor even depth-4 parent"><article id="div-comment-2868" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/40150b9299e69015bc46c30598a81888.png" srcset="https://secure.gravatar.com/avatar/40150b9299e69015bc46c30598a81888?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">bezkoder</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2868"><time datetime="2020-05-24T01:43:30+00:00">May 24, 2020 at 1:43 am</time></a></div></footer><div class="comment-content"><p>Hi, it is automatically generated by Sequelize 🙂</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2868" data-commentid="2868" data-postid="2033" data-belowelement="div-comment-2868" data-respondelement="respond" data-replyto="Reply to bezkoder" aria-label="Reply to bezkoder">Reply</a></div></article><ol class="children"><li id="comment-3152" class="comment odd alt depth-5"><article id="div-comment-3152" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/1d2d7b927005d083046c87af697adbfa.png" srcset="https://secure.gravatar.com/avatar/1d2d7b927005d083046c87af697adbfa?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">SofaDev39</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3152"><time datetime="2020-06-08T18:47:01+00:00">June 8, 2020 at 6:47 pm</time></a></div></footer><div class="comment-content"><p>Hi, thanks for your tutorial 🙂<br> I fixed this issue with an alias :</p><pre class=" language-js"><code class=" language-js">db<span class="token punctuation">.</span><span class="token property-access">user</span><span class="token punctuation">.</span><span class="token method function property-access">belongsToMany</span><span class="token punctuation">(</span>db<span class="token punctuation">.</span><span class="token property-access">role</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  through<span class="token operator">:</span> <span class="token string">"Table_User_Roles"</span><span class="token punctuation">,</span>
  foreignKey<span class="token operator">:</span> <span class="token string">"idUser"</span><span class="token punctuation">,</span>
  otherKey<span class="token operator">:</span> <span class="token string">"idRole"</span><span class="token punctuation">,</span>
  <span class="token keyword module">as</span><span class="token operator">:</span> <span class="token string">"roles"</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>I hope that help you 😉</p></div></article></li></ol></li></ol></li></ol></li></ol></li><li id="comment-2494" class="comment even thread-odd thread-alt depth-1 parent"><article id="div-comment-2494" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/53e2c46a2e09ee6f12e0887d40c087e8.png" srcset="https://secure.gravatar.com/avatar/53e2c46a2e09ee6f12e0887d40c087e8?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Milquebits</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2494"><time datetime="2020-05-16T13:05:50+00:00">May 16, 2020 at 1:05 pm</time></a></div></footer><div class="comment-content"><p>Love your tutorials! Quick question, can you explain why the corsOptions.origin is set to <a href="http://localhost:8081/" rel="nofollow ugc">http://localhost:8081</a>, when the server is setup to listen on <a href="http://localhost:8080/" rel="nofollow ugc">http://localhost:8080</a>?</p><p>You stated: “Notice that we set origin: <a href="http://localhost:8081/" rel="nofollow ugc">http://localhost:8081</a>“, but did not provide an explanation of why this is different from the listening port.</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2494" data-commentid="2494" data-postid="2033" data-belowelement="div-comment-2494" data-respondelement="respond" data-replyto="Reply to Milquebits" aria-label="Reply to Milquebits">Reply</a></div></article><ol class="children"><li id="comment-2604" class="comment byuser comment-author-bezkoder bypostauthor odd alt depth-2"><article id="div-comment-2604" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/40150b9299e69015bc46c30598a81888.png" srcset="https://secure.gravatar.com/avatar/40150b9299e69015bc46c30598a81888?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">bezkoder</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2604"><time datetime="2020-05-19T03:28:24+00:00">May 19, 2020 at 3:28 am</time></a></div></footer><div class="comment-content"><p>If you use a REST Client such as Postman, you call API from the same origin <code>http://localhost:8080</code>. It is ok and CORS doesn’t need to work here.</p><p>But when you send HTTP request from another origin (another front-end app with another port: Angular, React, Vue…), for example: <code>http://localhost:8081</code>, you must accept the Cross-origin resource sharing (CORS). It is a mechanism that allows restricted resources on a web page to be requested from another domain outside the domain from which the first resource was served.</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2604" data-commentid="2604" data-postid="2033" data-belowelement="div-comment-2604" data-respondelement="respond" data-replyto="Reply to bezkoder" aria-label="Reply to bezkoder">Reply</a></div></article></li></ol></li><li id="comment-2515" class="comment even thread-even depth-1 parent"><article id="div-comment-2515" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/18b0acd8526f230205bae7200988817a.png" srcset="https://secure.gravatar.com/avatar/18b0acd8526f230205bae7200988817a?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">anis</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2515"><time datetime="2020-05-17T10:10:27+00:00">May 17, 2020 at 10:10 am</time></a></div></footer><div class="comment-content"><p>Hi,</p><p>I am very new to backend. I follow the tutorial and also clone the repo but always showing the message “Coluld not get any response”. Please let me know what should I have to do. do I need to install any software along. like mySql?</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2515" data-commentid="2515" data-postid="2033" data-belowelement="div-comment-2515" data-respondelement="respond" data-replyto="Reply to anis" aria-label="Reply to anis">Reply</a></div></article><ol class="children"><li id="comment-2603" class="comment byuser comment-author-bezkoder bypostauthor odd alt depth-2"><article id="div-comment-2603" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/40150b9299e69015bc46c30598a81888.png" srcset="https://secure.gravatar.com/avatar/40150b9299e69015bc46c30598a81888?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">bezkoder</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2603"><time datetime="2020-05-19T03:24:37+00:00">May 19, 2020 at 3:24 am</time></a></div></footer><div class="comment-content"><p>Hi, the example works with MySQL database, so you MUST install MySQL and configure appropriate db parameters 🙂</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2603" data-commentid="2603" data-postid="2033" data-belowelement="div-comment-2603" data-respondelement="respond" data-replyto="Reply to bezkoder" aria-label="Reply to bezkoder">Reply</a></div></article></li></ol></li><li id="comment-2576" class="comment even thread-odd thread-alt depth-1 parent"><article id="div-comment-2576" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/844209e4c1d3e97ef3d12e736e7c1b85.png" srcset="https://secure.gravatar.com/avatar/844209e4c1d3e97ef3d12e736e7c1b85?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">james swafford</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2576"><time datetime="2020-05-18T14:48:56+00:00">May 18, 2020 at 2:48 pm</time></a></div></footer><div class="comment-content"><p>bezkoder, excellent tutorial. Complete and well thought out.  I’m facing an issue that you have appeared to solve, but for the life of me, I cant replicate from your tutorial into my own code.</p><p>I have react/redux front-end with express.js api.<br> Login works and returns a token.<br> Attempts to access endpoints with the x-access-token fail from localhost, but succeed from PostMan.</p><p>Attempts from localhost give the below error:<br> Access to fetch at ‘https:///dev/buyer’ from origin ‘http://localhost:3000’ has been blocked by CORS policy: Request header field x-access-token is not allowed by Access-Control-Allow-Headers in preflight response.</p><p>I have the below cors configuration</p><pre class=" language-js"><code class=" language-js"><span class="token keyword">let</span> corsOptions <span class="token operator">=</span> <span class="token punctuation">{</span>
  origin<span class="token operator">:</span> <span class="token string">"http://localhost:3000"</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="token function">cors</span><span class="token punctuation">(</span>corsOptions<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>I dont understand why PostMan would work, but my localhost will not.</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2576" data-commentid="2576" data-postid="2033" data-belowelement="div-comment-2576" data-respondelement="respond" data-replyto="Reply to james swafford" aria-label="Reply to james swafford">Reply</a></div></article><ol class="children"><li id="comment-2602" class="comment byuser comment-author-bezkoder bypostauthor odd alt depth-2"><article id="div-comment-2602" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/40150b9299e69015bc46c30598a81888.png" srcset="https://secure.gravatar.com/avatar/40150b9299e69015bc46c30598a81888?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">bezkoder</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2602"><time datetime="2020-05-19T03:22:27+00:00">May 19, 2020 at 3:22 am</time></a></div></footer><div class="comment-content"><p>Hi, your server should return that it accepts custom headers:</p><pre class=" language-js"><code class=" language-js">res<span class="token punctuation">.</span><span class="token method function property-access">header</span><span class="token punctuation">(</span>
  <span class="token string">"Access-Control-Allow-Headers"</span><span class="token punctuation">,</span>
  <span class="token string">"x-access-token, Origin, Content-Type, Accept"</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2602" data-commentid="2602" data-postid="2033" data-belowelement="div-comment-2602" data-respondelement="respond" data-replyto="Reply to bezkoder" aria-label="Reply to bezkoder">Reply</a></div></article></li></ol></li><li id="comment-2622" class="comment even thread-even depth-1 parent"><article id="div-comment-2622" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/b727b66031681cfda13377f8c635aefa.png" srcset="https://secure.gravatar.com/avatar/b727b66031681cfda13377f8c635aefa?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">akhil</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2622"><time datetime="2020-05-19T08:34:34+00:00">May 19, 2020 at 8:34 am</time></a></div></footer><div class="comment-content"><p>Great tutorial, thanks a lot.<br> Can you implement this with refresh token rotation method.<br> Thanks in Advance</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2622" data-commentid="2622" data-postid="2033" data-belowelement="div-comment-2622" data-respondelement="respond" data-replyto="Reply to akhil" aria-label="Reply to akhil">Reply</a></div></article><ol class="children"><li id="comment-2628" class="comment byuser comment-author-bezkoder bypostauthor odd alt depth-2"><article id="div-comment-2628" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/40150b9299e69015bc46c30598a81888.png" srcset="https://secure.gravatar.com/avatar/40150b9299e69015bc46c30598a81888?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">bezkoder</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2628"><time datetime="2020-05-19T09:51:58+00:00">May 19, 2020 at 9:51 am</time></a></div></footer><div class="comment-content"><p>Hi, I will write the tutorial when having time 🙂</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2628" data-commentid="2628" data-postid="2033" data-belowelement="div-comment-2628" data-respondelement="respond" data-replyto="Reply to bezkoder" aria-label="Reply to bezkoder">Reply</a></div></article></li></ol></li><li id="comment-2651" class="comment even thread-odd thread-alt depth-1 parent"><article id="div-comment-2651" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/cd6635eb11ded17ad2eaa71fbb28a424.png" srcset="https://secure.gravatar.com/avatar/cd6635eb11ded17ad2eaa71fbb28a424?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Hassaan</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2651"><time datetime="2020-05-19T18:47:54+00:00">May 19, 2020 at 6:47 pm</time></a></div></footer><div class="comment-content"><p>node run server stuck at:<br> Executing (default): CREATE TABLE IF NOT EXISTS `roles` (`role_id` INTEGER , `role_code` VARCHAR(255), `role_descr` VARCHAR(255), `createdAt` DATETIME NOT NULL, `updatedAt` DATETIME NOT NULL, PRIMARY KEY (`role_id`)) ENGINE=InnoDB;<br> Executing (default): SHOW INDEX FROM `roles`</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2651" data-commentid="2651" data-postid="2033" data-belowelement="div-comment-2651" data-respondelement="respond" data-replyto="Reply to Hassaan" aria-label="Reply to Hassaan">Reply</a></div></article><ol class="children"><li id="comment-2664" class="comment byuser comment-author-bezkoder bypostauthor odd alt depth-2 parent"><article id="div-comment-2664" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/40150b9299e69015bc46c30598a81888.png" srcset="https://secure.gravatar.com/avatar/40150b9299e69015bc46c30598a81888?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">bezkoder</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2664"><time datetime="2020-05-19T22:57:09+00:00">May 19, 2020 at 10:57 pm</time></a></div></footer><div class="comment-content"><p>Hi, please send more log details about the issue.</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2664" data-commentid="2664" data-postid="2033" data-belowelement="div-comment-2664" data-respondelement="respond" data-replyto="Reply to bezkoder" aria-label="Reply to bezkoder">Reply</a></div></article><ol class="children"><li id="comment-2675" class="comment even depth-3 parent"><article id="div-comment-2675" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/cd6635eb11ded17ad2eaa71fbb28a424.png" srcset="https://secure.gravatar.com/avatar/cd6635eb11ded17ad2eaa71fbb28a424?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Hassaan</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2675"><time datetime="2020-05-20T06:59:32+00:00">May 20, 2020 at 6:59 am</time></a></div></footer><div class="comment-content"><p>Thanks for your quick reply but I’ve figured out the issue. server was running fine there was some other error in my code.</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2675" data-commentid="2675" data-postid="2033" data-belowelement="div-comment-2675" data-respondelement="respond" data-replyto="Reply to Hassaan" aria-label="Reply to Hassaan">Reply</a></div></article><ol class="children"><li id="comment-4065" class="comment odd alt depth-4"><article id="div-comment-4065" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/c2848a26347f7111e819ecd08880948f.png" srcset="https://secure.gravatar.com/avatar/c2848a26347f7111e819ecd08880948f?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">indresh</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4065"><time datetime="2020-07-29T20:33:48+00:00">July 29, 2020 at 8:33 pm</time></a></div></footer><div class="comment-content"><p>i also stuck at ‘ SHOW INDEX FROM `user_roles`’ what is solution for that?</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4065" data-commentid="4065" data-postid="2033" data-belowelement="div-comment-4065" data-respondelement="respond" data-replyto="Reply to indresh" aria-label="Reply to indresh">Reply</a></div></article></li></ol></li></ol></li></ol></li><li id="comment-2667" class="comment even thread-even depth-1 parent"><article id="div-comment-2667" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/efe0ee1e7d864aadc9645662f73e45c3.png" srcset="https://secure.gravatar.com/avatar/efe0ee1e7d864aadc9645662f73e45c3?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Reynald Daffa</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2667"><time datetime="2020-05-20T01:18:08+00:00">May 20, 2020 at 1:18 am</time></a></div></footer><div class="comment-content"><p>Hi, great tutorial. btw have u tutorial for logout jwt? and is it good to save jwt in the database?</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2667" data-commentid="2667" data-postid="2033" data-belowelement="div-comment-2667" data-respondelement="respond" data-replyto="Reply to Reynald Daffa" aria-label="Reply to Reynald Daffa">Reply</a></div></article><ol class="children"><li id="comment-2713" class="comment byuser comment-author-bezkoder bypostauthor odd alt depth-2"><article id="div-comment-2713" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/40150b9299e69015bc46c30598a81888.png" srcset="https://secure.gravatar.com/avatar/40150b9299e69015bc46c30598a81888?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">bezkoder</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2713"><time datetime="2020-05-21T04:19:26+00:00">May 21, 2020 at 4:19 am</time></a></div></footer><div class="comment-content"><p>Hi, we’re gonna save the Refresh Token in the database. I will write a tutorial for this when having time 🙂</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2713" data-commentid="2713" data-postid="2033" data-belowelement="div-comment-2713" data-respondelement="respond" data-replyto="Reply to bezkoder" aria-label="Reply to bezkoder">Reply</a></div></article></li></ol></li><li id="comment-2702" class="comment even thread-odd thread-alt depth-1 parent"><article id="div-comment-2702" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/72b1732aa718e794034f82b46d99f3bf.png" srcset="https://secure.gravatar.com/avatar/72b1732aa718e794034f82b46d99f3bf?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">AngieA</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2702"><time datetime="2020-05-20T21:52:33+00:00">May 20, 2020 at 9:52 pm</time></a></div></footer><div class="comment-content"><p>Hi bezkoder!  Been working with some of your tutorials recently, which have been so great, and I’m trying to get a website up on my namecheap hosting server.  When I have the API backend loaded and started server.js, I’m able to successfully register and login through the cPanel terminal using curl commands.</p><p>So today I went through your “Vue.js JWT Authentication with Vuex and Vue Router” tutorial, and everything works in testing when connecting to a MySQL database on my local computer, but after loading my build to the server, I’m getting “net::ERR_CONNECTION_REFUSED”.  At first I was getting a CORS error, so I changed the corsOptions origin value to my domain, thinking that would work.  I’m no longer getting the CORS error message.. just “net::ERR_CONNECTION_REFUSED”.</p><p>Any ideas?  Thank you!!</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2702" data-commentid="2702" data-postid="2033" data-belowelement="div-comment-2702" data-respondelement="respond" data-replyto="Reply to AngieA" aria-label="Reply to AngieA">Reply</a></div></article><ol class="children"><li id="comment-2712" class="comment byuser comment-author-bezkoder bypostauthor odd alt depth-2 parent"><article id="div-comment-2712" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/40150b9299e69015bc46c30598a81888.png" srcset="https://secure.gravatar.com/avatar/40150b9299e69015bc46c30598a81888?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">bezkoder</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2712"><time datetime="2020-05-21T04:17:50+00:00">May 21, 2020 at 4:17 am</time></a></div></footer><div class="comment-content"><p>Hi, please show me your browser console log.</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2712" data-commentid="2712" data-postid="2033" data-belowelement="div-comment-2712" data-respondelement="respond" data-replyto="Reply to bezkoder" aria-label="Reply to bezkoder">Reply</a></div></article><ol class="children"><li id="comment-2734" class="comment even depth-3 parent"><article id="div-comment-2734" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/72b1732aa718e794034f82b46d99f3bf.png" srcset="https://secure.gravatar.com/avatar/72b1732aa718e794034f82b46d99f3bf?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">AngieA</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2734"><time datetime="2020-05-21T17:54:10+00:00">May 21, 2020 at 5:54 pm</time></a></div></footer><div class="comment-content"><p>Thanks for your help!!</p><p><a href="https://auel.dev/dinner-robot/ERR_CONNECTION_REFUSED.png" rel="nofollow ugc">https://auel.dev/dinner-robot/ERR_CONNECTION_REFUSED.png</a></p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2734" data-commentid="2734" data-postid="2033" data-belowelement="div-comment-2734" data-respondelement="respond" data-replyto="Reply to AngieA" aria-label="Reply to AngieA">Reply</a></div></article><ol class="children"><li id="comment-2742" class="comment byuser comment-author-bezkoder bypostauthor odd alt depth-4"><article id="div-comment-2742" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/40150b9299e69015bc46c30598a81888.png" srcset="https://secure.gravatar.com/avatar/40150b9299e69015bc46c30598a81888?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">bezkoder</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2742"><time datetime="2020-05-22T07:29:02+00:00">May 22, 2020 at 7:29 am</time></a></div></footer><div class="comment-content"><p>Hi, the message said that: “username is already in use!”. So did you try to signup with another one?</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2742" data-commentid="2742" data-postid="2033" data-belowelement="div-comment-2742" data-respondelement="respond" data-replyto="Reply to bezkoder" aria-label="Reply to bezkoder">Reply</a></div></article></li></ol></li></ol></li></ol></li><li id="comment-2745" class="comment even thread-even depth-1"><article id="div-comment-2745" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/633d65ea15024bf0072edb8588e9f98d.png" srcset="https://secure.gravatar.com/avatar/633d65ea15024bf0072edb8588e9f98d?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Rakesh</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2745"><time datetime="2020-05-22T11:02:26+00:00">May 22, 2020 at 11:02 am</time></a></div></footer><div class="comment-content"><p>Is this a micro service architecture ?</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-2745" data-commentid="2745" data-postid="2033" data-belowelement="div-comment-2745" data-respondelement="respond" data-replyto="Reply to Rakesh" aria-label="Reply to Rakesh">Reply</a></div></article></li><li id="comment-3038" class="comment odd alt thread-odd thread-alt depth-1"><article id="div-comment-3038" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/83740b57d0a0458a211ec78865e6b9fc.png" srcset="https://secure.gravatar.com/avatar/83740b57d0a0458a211ec78865e6b9fc?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Spookee</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3038"><time datetime="2020-05-30T20:13:54+00:00">May 30, 2020 at 8:13 pm</time></a></div></footer><div class="comment-content"><p>Thank you very much! Very interesting and useful!!</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3038" data-commentid="3038" data-postid="2033" data-belowelement="div-comment-3038" data-respondelement="respond" data-replyto="Reply to Spookee" aria-label="Reply to Spookee">Reply</a></div></article></li><li id="comment-3107" class="comment even thread-even depth-1"><article id="div-comment-3107" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/8bb9eaebf681ceb786bc6b803247a67f.jpeg" srcset="https://secure.gravatar.com/avatar/8bb9eaebf681ceb786bc6b803247a67f?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Rayner</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3107"><time datetime="2020-06-04T14:27:01+00:00">June 4, 2020 at 2:27 pm</time></a></div></footer><div class="comment-content"><p>Thanks for the great tutorial!  I got this working with SQL Server using tedious and express4-tedious.  Didn’t need mysql2 so uninstalled it.  So I have a route set up in express4-tedious that I would like to only be available if a user (ROLE_USER) is logged in:</p><p>app.use(‘/alignments’, require(‘./app/routes/alignments’));<br> (in server.js)</p><p>I have nothing against myql.  Just need to use a mssql database because of some spatial functions that are not available in mysql, for example:</p><p>/* GET alignments listing. */<br> router.get(‘/’, function (req, res) {<br> req.sql(“select id, fid, GeomCol1.AsTextZM() as alignmentwkt, GeomCol1.STSrid as srid, aligngrp1, aligngrp2, alignment, GeomCol1.STLength() as length, lrs.STStartMeasure(GeomCol1) as startm, lrs.STEndMeasure(GeomCol1) as endm, lrs.STMeasureRange(GeomCol1) as measure_range, hascurve, numsegs, thumbnail, mapurl from alignmentstest4 order by aligngrp1 asc, aligngrp2 asc, alignment asc for json path”)<br> .into(res, ‘[]’);<br> });<br> (in routes/alignments.js)</p><p>So how would you go about making this new /alignments route available to only users who are logged in?</p><p>Going further, there will be some POSTs and PUTs that I would like only moderators or admins to be able to get access to:</p><p>/* PUT update station/offset/point. */<br> router.put(‘/ptso/put/update/:ptid’, textParser, function (req, res) {<br> req.sql(“exec update_pt_so_h @ptid, @pts”)<br> .param(‘ptid’, req.params.ptid, TYPES.Int)<br> .param(‘pts’, req.body, TYPES.NVarChar)<br> .exec(res);<br> });</p><p>Any pointers you can give will be appreciated.  I’m very new to Express and have been working with React for a couple of months.</p><p>Thanks again for a great tutorial!</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3107" data-commentid="3107" data-postid="2033" data-belowelement="div-comment-3107" data-respondelement="respond" data-replyto="Reply to Rayner" aria-label="Reply to Rayner">Reply</a></div></article></li><li id="comment-3147" class="comment odd alt thread-odd thread-alt depth-1"><article id="div-comment-3147" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/8bb9eaebf681ceb786bc6b803247a67f.jpeg" srcset="https://secure.gravatar.com/avatar/8bb9eaebf681ceb786bc6b803247a67f?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Rayner</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3147"><time datetime="2020-06-08T15:29:36+00:00">June 8, 2020 at 3:29 pm</time></a></div></footer><div class="comment-content"><p>How would you add another protected route without sequelize?</p><p>I have a route /alignments that I would like to add as a protected route.  I’m trying to get it to work like the user route.  I tried to add it to /user/alignments but that didn’t work either.  Please help!</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3147" data-commentid="3147" data-postid="2033" data-belowelement="div-comment-3147" data-respondelement="respond" data-replyto="Reply to Rayner" aria-label="Reply to Rayner">Reply</a></div></article></li><li id="comment-3164" class="comment even thread-even depth-1"><article id="div-comment-3164" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/37a6153ecaa95ef7f0750e311fe30479.png" srcset="https://secure.gravatar.com/avatar/37a6153ecaa95ef7f0750e311fe30479?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Mark</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3164"><time datetime="2020-06-09T15:59:45+00:00">June 9, 2020 at 3:59 pm</time></a></div></footer><div class="comment-content"><p>If i see well in this app everybody can register as admin.</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3164" data-commentid="3164" data-postid="2033" data-belowelement="div-comment-3164" data-respondelement="respond" data-replyto="Reply to Mark" aria-label="Reply to Mark">Reply</a></div></article></li><li id="comment-3215" class="comment odd alt thread-odd thread-alt depth-1"><article id="div-comment-3215" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/8204354eeb157fe2919f26eb31188ffa.png" srcset="https://secure.gravatar.com/avatar/8204354eeb157fe2919f26eb31188ffa?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Bobby</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3215"><time datetime="2020-06-11T01:08:25+00:00">June 11, 2020 at 1:08 am</time></a></div></footer><div class="comment-content"><p>Hi, first of all, thank you for your guidance. Can you make a tutorial about Node.js Token Based Authentication &amp; Authorization example without ORM Sequelize? Thank you!</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3215" data-commentid="3215" data-postid="2033" data-belowelement="div-comment-3215" data-respondelement="respond" data-replyto="Reply to Bobby" aria-label="Reply to Bobby">Reply</a></div></article></li><li id="comment-3226" class="comment even thread-even depth-1"><article id="div-comment-3226" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/738c38a82ee880beae7a2863a131b817.png" srcset="https://secure.gravatar.com/avatar/738c38a82ee880beae7a2863a131b817?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">hargon</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3226"><time datetime="2020-06-11T14:06:13+00:00">June 11, 2020 at 2:06 pm</time></a></div></footer><div class="comment-content"><p>This article is great.</p><p>The checkDuplicateUserNameOrEmail function check email only when username is already in use. Maybe you should check email only when username is not in use.</p><p>Thanks.</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3226" data-commentid="3226" data-postid="2033" data-belowelement="div-comment-3226" data-respondelement="respond" data-replyto="Reply to hargon" aria-label="Reply to hargon">Reply</a></div></article></li><li id="comment-3295" class="comment odd alt thread-odd thread-alt depth-1 parent"><article id="div-comment-3295" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/6a061a6106ec34db476a3587961d7260.png" srcset="https://secure.gravatar.com/avatar/6a061a6106ec34db476a3587961d7260?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">sady</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3295"><time datetime="2020-06-16T04:05:15+00:00">June 16, 2020 at 4:05 am</time></a></div></footer><div class="comment-content"><p>Great work, quick question, why when i add a new model (table), it still enforces createdAt and updatedAt fields to be there? how can i remove this enforcement pls? much thankkkks</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3295" data-commentid="3295" data-postid="2033" data-belowelement="div-comment-3295" data-respondelement="respond" data-replyto="Reply to sady" aria-label="Reply to sady">Reply</a></div></article><ol class="children"><li id="comment-5538" class="comment even depth-2"><article id="div-comment-5538" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/f88d938bfe8957b261e78d07a545f935.png" srcset="https://secure.gravatar.com/avatar/f88d938bfe8957b261e78d07a545f935?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">rmg</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-5538"><time datetime="2020-11-24T08:00:44+00:00">November 24, 2020 at 8:00 am</time></a></div></footer><div class="comment-content"><p>createdAt: {<br> type: Sequelize.DATE,<br> field: ‘creado’<br> },</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-5538" data-commentid="5538" data-postid="2033" data-belowelement="div-comment-5538" data-respondelement="respond" data-replyto="Reply to rmg" aria-label="Reply to rmg">Reply</a></div></article></li></ol></li><li id="comment-3376" class="comment odd alt thread-even depth-1"><article id="div-comment-3376" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/8bb9eaebf681ceb786bc6b803247a67f.jpeg" srcset="https://secure.gravatar.com/avatar/8bb9eaebf681ceb786bc6b803247a67f?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Rayner</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3376"><time datetime="2020-06-20T15:09:57+00:00">June 20, 2020 at 3:09 pm</time></a></div></footer><div class="comment-content"><p>I got this to work on my local development machine using SQL Server (MSSQL) rather than MySQL.  Also using Tedious and Express4/Tedious.  Now trying to publish the Express app to Azure and unable to get to any of the ‘auth’ routes.  It returns Cannot GET /api/auth/signin and Cannot GET /api/auth/signup.  It does let me have access to the /api/test/user and /api/test/mod and /api/test/admin (these show {“message”:”No token provided!”}) and /api/test/all (shows Public Content.)  All my other routes are protected, so they also show up as {“message”:”No token provided!”}.  How does one go about getting the auth routes to work in Azure?</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3376" data-commentid="3376" data-postid="2033" data-belowelement="div-comment-3376" data-respondelement="respond" data-replyto="Reply to Rayner" aria-label="Reply to Rayner">Reply</a></div></article></li><li id="comment-3398" class="comment even thread-odd thread-alt depth-1"><article id="div-comment-3398" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/791698f1a2fb8411cdbc3ee6b74d3a1e.png" srcset="https://secure.gravatar.com/avatar/791698f1a2fb8411cdbc3ee6b74d3a1e?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Krzysiu</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3398"><time datetime="2020-06-22T10:04:03+00:00">June 22, 2020 at 10:04 am</time></a></div></footer><div class="comment-content"><p>First i want thenks for tutorial – it work great … but i dont have rules. I think i dont create or add something. I have profile component from github like everything else. When i try find ROLES_USER, ROLES_ADMIN or ROLES_MODERATOR i cant find it in my code. If i dont give what i have in my code for you please tell me and i add in next comment. Do you know what i miss ?Sorry i dont add “my” code but i dont know what i should add and want know exacly what create ROLES.</p><p>PS<br> Sorry for my english – i know im terrible 😛</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3398" data-commentid="3398" data-postid="2033" data-belowelement="div-comment-3398" data-respondelement="respond" data-replyto="Reply to Krzysiu" aria-label="Reply to Krzysiu">Reply</a></div></article></li><li id="comment-3527" class="comment odd alt thread-even depth-1"><article id="div-comment-3527" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/07988f83b6adceec05001ff5d3add678.png" srcset="https://secure.gravatar.com/avatar/07988f83b6adceec05001ff5d3add678?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Steffan</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3527"><time datetime="2020-06-29T10:16:09+00:00">June 29, 2020 at 10:16 am</time></a></div></footer><div class="comment-content"><p>Thanks a lot for the Tutorial, it helped me understand a lot I didn’t grasp before. It would be nice if you could make this post a bit clearer:<br> React + Node.js Express: User Authentication with JWT example<br> Scrolling through half the page was a little bit confusing to find the implementation.<br> Besides that I have one question maybe you or someone else here can answer.</p><p>const authJwt = {<br> verifyToken: verifyToken,<br> isAdmin: isAdmin,<br> isModerator: isModerator,<br> isModeratorOrAdmin: isModeratorOrAdmin<br> };</p><p>Everything in these is undefined for me and thus the arrow functions also don’t work. Do you have any idea why that could be the case? I think I’m probably missing something super simple but I don’t know what.</p><p>Thanks again for the great tutorial, even with my fails it was easy for me to follow and made some things clear.</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3527" data-commentid="3527" data-postid="2033" data-belowelement="div-comment-3527" data-respondelement="respond" data-replyto="Reply to Steffan" aria-label="Reply to Steffan">Reply</a></div></article></li><li id="comment-3549" class="comment even thread-odd thread-alt depth-1"><article id="div-comment-3549" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/32c9172c0a6f65e49552899bd7460f2e.png" srcset="https://secure.gravatar.com/avatar/32c9172c0a6f65e49552899bd7460f2e?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">vr14</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3549"><time datetime="2020-06-30T17:40:11+00:00">June 30, 2020 at 5:40 pm</time></a></div></footer><div class="comment-content"><p>Hi greatesolution i tried the CRUD operations and it worked perfectly . I have an error in the api while trying the authentication with mysql. I’m not able to add a new user in both mysql db as well as in server (i.e) in the locahost:8080/api/auth/signup in server . in my db i’m getting the following error<br> Unhandled rejection SequelizeForeignKeyConstraintError: Cannot add or update a child row: a foreign key constraint fails (`mysql`.`user_roles`, CONSTRAINT `user_roles_ibfk_1` FOREIGN KEY (`roleId`) REFERENCES `roles` (`id`) ON DELETE CASCADE ON UPDATE CASCADE)<br> Help needed. Thanks in advance!!!</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3549" data-commentid="3549" data-postid="2033" data-belowelement="div-comment-3549" data-respondelement="respond" data-replyto="Reply to vr14" aria-label="Reply to vr14">Reply</a></div></article></li><li id="comment-3598" class="comment odd alt thread-even depth-1"><article id="div-comment-3598" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/be1d18f056e58ad47f16504b2903062c.png" srcset="https://secure.gravatar.com/avatar/be1d18f056e58ad47f16504b2903062c?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Cris</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3598"><time datetime="2020-07-03T18:25:58+00:00">July 3, 2020 at 6:25 pm</time></a></div></footer><div class="comment-content"><p>amazing, thank you very much greetings from Chile!</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3598" data-commentid="3598" data-postid="2033" data-belowelement="div-comment-3598" data-respondelement="respond" data-replyto="Reply to Cris" aria-label="Reply to Cris">Reply</a></div></article></li><li id="comment-3605" class="comment even thread-odd thread-alt depth-1"><article id="div-comment-3605" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/8103fd7c5a6a53c54891864d40deb4ff.png" srcset="https://secure.gravatar.com/avatar/8103fd7c5a6a53c54891864d40deb4ff?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Diogo</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3605"><time datetime="2020-07-03T22:51:19+00:00">July 3, 2020 at 10:51 pm</time></a></div></footer><div class="comment-content"><p>That’s awesome, thanks!</p><p>One quick note: You’ve created the folder as “middlewares” but it’s importing it later as “middleware”. 🙂</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3605" data-commentid="3605" data-postid="2033" data-belowelement="div-comment-3605" data-respondelement="respond" data-replyto="Reply to Diogo" aria-label="Reply to Diogo">Reply</a></div></article></li><li id="comment-3611" class="comment odd alt thread-even depth-1 parent"><article id="div-comment-3611" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/89ba3f9c1ffb2c92e63bc6378f099199.png" srcset="https://secure.gravatar.com/avatar/89ba3f9c1ffb2c92e63bc6378f099199?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Harish</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3611"><time datetime="2020-07-04T10:34:21+00:00">July 4, 2020 at 10:34 am</time></a></div></footer><div class="comment-content"><p>Hi,<br> I’m getting an error, When I start  the server node server.js. Please find the below error log:<br> D:\Personal\NodeJS\node-js-jwt-auth&gt;node server.js<br> D:\Personal\NodeJS\node-js-jwt-auth\server.js:23<br> db.sequelize.sync();<br> ^<br> TypeError: Cannot read property ‘sync’ of undefined<br> at Object. (D:\Personal\NodeJS\node-js-jwt-auth\server.js:23:14)<br> at Module._compile (internal/modules/cjs/loader.js:1138:30)<br> at Object.Module._extensions..js (internal/modules/cjs/loader.js:1158:10)<br> at Module.load (internal/modules/cjs/loader.js:986:32)<br> at Function.Module._load (internal/modules/cjs/loader.js:879:14)<br> at Function.executeUserEntryPoint [as runMain] (internal/modules/run_main.js:71:12)<br> at internal/main/run_main_module.js:17:47<br> Thanks.<br> Harish</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3611" data-commentid="3611" data-postid="2033" data-belowelement="div-comment-3611" data-respondelement="respond" data-replyto="Reply to Harish" aria-label="Reply to Harish">Reply</a></div></article><ol class="children"><li id="comment-3612" class="comment even depth-2"><article id="div-comment-3612" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/89ba3f9c1ffb2c92e63bc6378f099199.png" srcset="https://secure.gravatar.com/avatar/89ba3f9c1ffb2c92e63bc6378f099199?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Harish</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3612"><time datetime="2020-07-04T10:45:15+00:00">July 4, 2020 at 10:45 am</time></a></div></footer><div class="comment-content"><p>Hi,<br> I don’t know how to do this initialization.<br> If anyone has source code, Kindly the share to me.<br> Thank you so much for these tutorials.</p><p>Thanks,<br> Harish</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3612" data-commentid="3612" data-postid="2033" data-belowelement="div-comment-3612" data-respondelement="respond" data-replyto="Reply to Harish" aria-label="Reply to Harish">Reply</a></div></article></li></ol></li><li id="comment-3617" class="comment odd alt thread-odd thread-alt depth-1 parent"><article id="div-comment-3617" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/021732e699e5a4d7ccc0e761c9f3346f.png" srcset="https://secure.gravatar.com/avatar/021732e699e5a4d7ccc0e761c9f3346f?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Chris</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3617"><time datetime="2020-07-04T22:12:09+00:00">July 4, 2020 at 10:12 pm</time></a></div></footer><div class="comment-content"><p>Everything looks great except I fear many people using this may not realize that adding roles in the signup route is a bad idea. Anyone could hit the api of the site using postgres and create an account with admin privileges if they knew the website used this. I would highly recommend removing removing everything in this if statement and only keeping what is in the else (default User role) in the signup function in auth.user.js</p><pre class=" language-js"><code class=" language-js"><span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">.</span><span class="token property-access">roles</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token maybe-class-name">Role</span><span class="token punctuation">.</span><span class="token method function property-access">findAll</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          where<span class="token operator">:</span> <span class="token punctuation">{</span>
            name<span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token punctuation">[</span><span class="token maybe-class-name">Op</span><span class="token punctuation">.</span><span class="token property-access">or</span><span class="token punctuation">]</span><span class="token operator">:</span> req<span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">.</span><span class="token property-access">roles</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">roles</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
          user<span class="token punctuation">.</span><span class="token method function property-access">setRoles</span><span class="token punctuation">(</span>roles<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
            res<span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span> message<span class="token operator">:</span> <span class="token string">"User was registered successfully!"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// user role = 1</span>
        user<span class="token punctuation">.</span><span class="token method function property-access">setRoles</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
          res<span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span> message<span class="token operator">:</span> <span class="token string">"User was registered successfully!"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
</code><code></code></pre></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3617" data-commentid="3617" data-postid="2033" data-belowelement="div-comment-3617" data-respondelement="respond" data-replyto="Reply to Chris" aria-label="Reply to Chris">Reply</a></div></article><ol class="children"><li id="comment-3623" class="comment byuser comment-author-bezkoder bypostauthor even depth-2 parent"><article id="div-comment-3623" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/40150b9299e69015bc46c30598a81888.png" srcset="https://secure.gravatar.com/avatar/40150b9299e69015bc46c30598a81888?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">bezkoder</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3623"><time datetime="2020-07-05T07:38:33+00:00">July 5, 2020 at 7:38 am</time></a></div></footer><div class="comment-content"><p>Hi, this is just for development and understand how to run authorization. In real app, we don’t accept anybody signup for all roles.</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3623" data-commentid="3623" data-postid="2033" data-belowelement="div-comment-3623" data-respondelement="respond" data-replyto="Reply to bezkoder" aria-label="Reply to bezkoder">Reply</a></div></article><ol class="children"><li id="comment-4241" class="comment odd alt depth-3"><article id="div-comment-4241" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/0de0c8b6b6829ee6bbeedb85d2cec61b.jpeg" srcset="https://secure.gravatar.com/avatar/0de0c8b6b6829ee6bbeedb85d2cec61b?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Malcolm</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4241"><time datetime="2020-08-08T15:41:52+00:00">August 8, 2020 at 3:41 pm</time></a></div></footer><div class="comment-content"><p>Hi,</p><p>For my use case it’s ideal as I expect the admin to do the signups and allocate roles, so the signup route will be admin role protected.</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4241" data-commentid="4241" data-postid="2033" data-belowelement="div-comment-4241" data-respondelement="respond" data-replyto="Reply to Malcolm" aria-label="Reply to Malcolm">Reply</a></div></article></li></ol></li></ol></li><li id="comment-3661" class="comment even thread-even depth-1 parent"><article id="div-comment-3661" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/217b11c07953d255d5a5ba441e02faf9.png" srcset="https://secure.gravatar.com/avatar/217b11c07953d255d5a5ba441e02faf9?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Aak</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3661"><time datetime="2020-07-09T07:22:25+00:00">July 9, 2020 at 7:22 am</time></a></div></footer><div class="comment-content"><p>Do you have similar example using just mysql and not sequilize? Also can the above examples done using mysql?</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3661" data-commentid="3661" data-postid="2033" data-belowelement="div-comment-3661" data-respondelement="respond" data-replyto="Reply to Aak" aria-label="Reply to Aak">Reply</a></div></article><ol class="children"><li id="comment-4240" class="comment odd alt depth-2"><article id="div-comment-4240" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/0de0c8b6b6829ee6bbeedb85d2cec61b.jpeg" srcset="https://secure.gravatar.com/avatar/0de0c8b6b6829ee6bbeedb85d2cec61b?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Malcolm</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4240"><time datetime="2020-08-08T14:58:23+00:00">August 8, 2020 at 2:58 pm</time></a></div></footer><div class="comment-content"><p>Hi Aak,</p><p>I’ve just completed this tutorial by converting to using node-postgres rather than use sequelize, so it will be possible. As I’m new to most of this myself and haven’t used MySql I can’t be specific but it should just be a matter of creating the appropriate SQL statements for each of the database queries required.</p><p>Best regards,</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4240" data-commentid="4240" data-postid="2033" data-belowelement="div-comment-4240" data-respondelement="respond" data-replyto="Reply to Malcolm" aria-label="Reply to Malcolm">Reply</a></div></article></li></ol></li><li id="comment-3695" class="comment even thread-odd thread-alt depth-1 parent"><article id="div-comment-3695" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/8173c2d79789b10e6d7c99214b7ee52d.png" srcset="https://secure.gravatar.com/avatar/8173c2d79789b10e6d7c99214b7ee52d?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Coder</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3695"><time datetime="2020-07-11T16:30:57+00:00">July 11, 2020 at 4:30 pm</time></a></div></footer><div class="comment-content"><p>hi, my token is throwing a 500 internal server error. It’s only the token that’s supposed to go in yeah?</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3695" data-commentid="3695" data-postid="2033" data-belowelement="div-comment-3695" data-respondelement="respond" data-replyto="Reply to Coder" aria-label="Reply to Coder">Reply</a></div></article><ol class="children"><li id="comment-3697" class="comment odd alt depth-2"><article id="div-comment-3697" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/8173c2d79789b10e6d7c99214b7ee52d.png" srcset="https://secure.gravatar.com/avatar/8173c2d79789b10e6d7c99214b7ee52d?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Coder</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3697"><time datetime="2020-07-11T17:38:29+00:00">July 11, 2020 at 5:38 pm</time></a></div></footer><div class="comment-content"><p>fixed it, sorry. Thank you so much for this</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3697" data-commentid="3697" data-postid="2033" data-belowelement="div-comment-3697" data-respondelement="respond" data-replyto="Reply to Coder" aria-label="Reply to Coder">Reply</a></div></article></li></ol></li><li id="comment-3826" class="comment even thread-even depth-1 parent"><article id="div-comment-3826" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/9ad5a7dabdfc5ef190374842a85118ae.png" srcset="https://secure.gravatar.com/avatar/9ad5a7dabdfc5ef190374842a85118ae?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Alex</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3826"><time datetime="2020-07-19T07:39:57+00:00">July 19, 2020 at 7:39 am</time></a></div></footer><div class="comment-content"><p>Hi Bezkoder,</p><p>Thanks for this tutorial, very helpful. But I don’t understand one of the functions.<br> What does ‘getRoles()’ from authJwt.js file do?<br> I cannot see where it is defined or referenced in the project.</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3826" data-commentid="3826" data-postid="2033" data-belowelement="div-comment-3826" data-respondelement="respond" data-replyto="Reply to Alex" aria-label="Reply to Alex">Reply</a></div></article><ol class="children"><li id="comment-3828" class="comment byuser comment-author-bezkoder bypostauthor odd alt depth-2 parent"><article id="div-comment-3828" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/40150b9299e69015bc46c30598a81888.png" srcset="https://secure.gravatar.com/avatar/40150b9299e69015bc46c30598a81888?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">bezkoder</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3828"><time datetime="2020-07-19T09:54:42+00:00">July 19, 2020 at 9:54 am</time></a></div></footer><div class="comment-content"><p>Hi, you can see that we use <code>belongsToMany()</code> so that Sequelize supports the methods <code>getRoles()</code> for model User.</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3828" data-commentid="3828" data-postid="2033" data-belowelement="div-comment-3828" data-respondelement="respond" data-replyto="Reply to bezkoder" aria-label="Reply to bezkoder">Reply</a></div></article><ol class="children"><li id="comment-3842" class="comment even depth-3"><article id="div-comment-3842" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/9ad5a7dabdfc5ef190374842a85118ae.png" srcset="https://secure.gravatar.com/avatar/9ad5a7dabdfc5ef190374842a85118ae?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Alex</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3842"><time datetime="2020-07-20T00:37:27+00:00">July 20, 2020 at 12:37 am</time></a></div></footer><div class="comment-content"><p>Thank you. I just found more info in the docs: <a href="https://sequelize.org/master/class/lib/associations/belongs-to-many.js~BelongsToMany.html" rel="nofollow ugc">https://sequelize.org/master/class/lib/associations/belongs-to-many.js~BelongsToMany.html</a>, after your comment.<br> I am trying my best to deconstruct your project without sequelize because I already have an ERD diagram prepared with views, procedures, triggers. I feel this would be more efficient for the DB.</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-3842" data-commentid="3842" data-postid="2033" data-belowelement="div-comment-3842" data-respondelement="respond" data-replyto="Reply to Alex" aria-label="Reply to Alex">Reply</a></div></article></li></ol></li></ol></li><li id="comment-4239" class="comment odd alt thread-odd thread-alt depth-1"><article id="div-comment-4239" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/0de0c8b6b6829ee6bbeedb85d2cec61b.jpeg" srcset="https://secure.gravatar.com/avatar/0de0c8b6b6829ee6bbeedb85d2cec61b?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Malcolm</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4239"><time datetime="2020-08-08T14:51:44+00:00">August 8, 2020 at 2:51 pm</time></a></div></footer><div class="comment-content"><p>Hi and thanks bezkoder for this tutorial, it has helped me understand this process better considering I’ve rewritten parts to use node-postgres rather than sequelize since I’m more familiar with SQL than working with ORMs. The conversion “forced” me to learn more Postgresql functionality. Now to tackle the React frontend part where I’ll be using material-ui and formik but still following your React Hooks: JWT Authentication (without Redux) example. Excellent work.</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4239" data-commentid="4239" data-postid="2033" data-belowelement="div-comment-4239" data-respondelement="respond" data-replyto="Reply to Malcolm" aria-label="Reply to Malcolm">Reply</a></div></article></li><li id="comment-4281" class="comment even thread-even depth-1"><article id="div-comment-4281" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/0eafdae8b3b4a648407a40ad3f07075e.png" srcset="https://secure.gravatar.com/avatar/0eafdae8b3b4a648407a40ad3f07075e?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">santosh</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4281"><time datetime="2020-08-12T09:14:29+00:00">August 12, 2020 at 9:14 am</time></a></div></footer><div class="comment-content"><p>Hey thanks @bezKoder for such good blog</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4281" data-commentid="4281" data-postid="2033" data-belowelement="div-comment-4281" data-respondelement="respond" data-replyto="Reply to santosh" aria-label="Reply to santosh">Reply</a></div></article></li><li id="comment-4466" class="comment odd alt thread-odd thread-alt depth-1"><article id="div-comment-4466" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/f571029a32c8b4a603292cc4f681232e.png" srcset="https://secure.gravatar.com/avatar/f571029a32c8b4a603292cc4f681232e?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn"><a href="http://none/" rel="external nofollow ugc" class="url">obi</a></b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4466"><time datetime="2020-08-26T04:21:17+00:00">August 26, 2020 at 4:21 am</time></a></div></footer><div class="comment-content"><p>please i need an explanation; whats the setRole() for, is it a sequelize function.</p><p>.then(roles =&gt; {<br> user.setRoles(roles).then(() =&gt; {<br> res.send({ message: “User was registered successfully!” });<br> });<br> });</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4466" data-commentid="4466" data-postid="2033" data-belowelement="div-comment-4466" data-respondelement="respond" data-replyto="Reply to obi" aria-label="Reply to obi">Reply</a></div></article></li><li id="comment-4586" class="comment even thread-even depth-1"><article id="div-comment-4586" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/a37e9a6a357bf46e1625d9bd0f3e706f.jpeg" srcset="https://secure.gravatar.com/avatar/a37e9a6a357bf46e1625d9bd0f3e706f?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">carlo veneziano</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4586"><time datetime="2020-09-02T21:34:04+00:00">September 2, 2020 at 9:34 pm</time></a></div></footer><div class="comment-content"><p>Thank you for this article! you made my day &lt;3</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4586" data-commentid="4586" data-postid="2033" data-belowelement="div-comment-4586" data-respondelement="respond" data-replyto="Reply to carlo veneziano" aria-label="Reply to carlo veneziano">Reply</a></div></article></li><li id="comment-4604" class="comment odd alt thread-odd thread-alt depth-1 parent"><article id="div-comment-4604" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/759ca5a8539402f4f128116f1680c6a7.png" srcset="https://secure.gravatar.com/avatar/759ca5a8539402f4f128116f1680c6a7?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Sebastian</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4604"><time datetime="2020-09-04T14:32:23+00:00">September 4, 2020 at 2:32 pm</time></a></div></footer><div class="comment-content"><p>Hi copied your repository and ran it but I got no entries on roles table</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4604" data-commentid="4604" data-postid="2033" data-belowelement="div-comment-4604" data-respondelement="respond" data-replyto="Reply to Sebastian" aria-label="Reply to Sebastian">Reply</a></div></article><ol class="children"><li id="comment-4606" class="comment byuser comment-author-bezkoder bypostauthor even depth-2 parent"><article id="div-comment-4606" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/40150b9299e69015bc46c30598a81888.png" srcset="https://secure.gravatar.com/avatar/40150b9299e69015bc46c30598a81888?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">bezkoder</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4606"><time datetime="2020-09-05T02:41:08+00:00">September 5, 2020 at 2:41 am</time></a></div></footer><div class="comment-content"><p>Hi, you should change the code in <em>server.js</em> to:</p><pre class=" language-js"><code class=" language-js"><span class="token comment">// db.sequelize.sync();</span>
<span class="token comment">// force: true will drop the table if it already exists</span>
db<span class="token punctuation">.</span><span class="token property-access">sequelize</span><span class="token punctuation">.</span><span class="token method function property-access">sync</span><span class="token punctuation">(</span><span class="token punctuation">{</span>force<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'Drop and Resync Database with { force: true }'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">initial</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>It will create 3 necessary rows first. 🙂</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4606" data-commentid="4606" data-postid="2033" data-belowelement="div-comment-4606" data-respondelement="respond" data-replyto="Reply to bezkoder" aria-label="Reply to bezkoder">Reply</a></div></article><ol class="children"><li id="comment-4610" class="comment odd alt depth-3"><article id="div-comment-4610" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/759ca5a8539402f4f128116f1680c6a7.png" srcset="https://secure.gravatar.com/avatar/759ca5a8539402f4f128116f1680c6a7?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Sebastian</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4610"><time datetime="2020-09-06T02:12:20+00:00">September 6, 2020 at 2:12 am</time></a></div></footer><div class="comment-content"><p>thanks, great tutorial 🙂</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4610" data-commentid="4610" data-postid="2033" data-belowelement="div-comment-4610" data-respondelement="respond" data-replyto="Reply to Sebastian" aria-label="Reply to Sebastian">Reply</a></div></article></li></ol></li></ol></li><li id="comment-4671" class="comment even thread-even depth-1 parent"><article id="div-comment-4671" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/d294a5ab3371f6807a565ce9976347ef.png" srcset="https://secure.gravatar.com/avatar/d294a5ab3371f6807a565ce9976347ef?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">khoi tran</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4671"><time datetime="2020-09-10T07:08:46+00:00">September 10, 2020 at 7:08 am</time></a></div></footer><div class="comment-content"><p>UnhandledPromiseRejectionWarning: SequelizeDatabaseError: Cannot drop table ‘roles’ referenced by a foreign key constraint ‘user_roles_ibfk_1’ on table ‘user_roles’. .  this is happen when i try to execute server.js . I know this is an error when i try to delete table that has foreign key , how to fix this in node js .</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4671" data-commentid="4671" data-postid="2033" data-belowelement="div-comment-4671" data-respondelement="respond" data-replyto="Reply to khoi tran" aria-label="Reply to khoi tran">Reply</a></div></article><ol class="children"><li id="comment-4674" class="comment byuser comment-author-bezkoder bypostauthor odd alt depth-2"><article id="div-comment-4674" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/40150b9299e69015bc46c30598a81888.png" srcset="https://secure.gravatar.com/avatar/40150b9299e69015bc46c30598a81888?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">bezkoder</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4674"><time datetime="2020-09-10T15:29:59+00:00">September 10, 2020 at 3:29 pm</time></a></div></footer><div class="comment-content"><p>Hi, try to drop <code>user_roles</code> table first.</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4674" data-commentid="4674" data-postid="2033" data-belowelement="div-comment-4674" data-respondelement="respond" data-replyto="Reply to bezkoder" aria-label="Reply to bezkoder">Reply</a></div></article></li></ol></li><li id="comment-4767" class="comment even thread-odd thread-alt depth-1 parent"><article id="div-comment-4767" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/16b1dd10e65b3cb8c0cf5db4035e6d8e.png" srcset="https://secure.gravatar.com/avatar/16b1dd10e65b3cb8c0cf5db4035e6d8e?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Bojan</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4767"><time datetime="2020-09-17T12:37:13+00:00">September 17, 2020 at 12:37 pm</time></a></div></footer><div class="comment-content"><p>How you get roles in middlewares/authJwt.js, since you don’t include const Role?</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4767" data-commentid="4767" data-postid="2033" data-belowelement="div-comment-4767" data-respondelement="respond" data-replyto="Reply to Bojan" aria-label="Reply to Bojan">Reply</a></div></article><ol class="children"><li id="comment-4772" class="comment byuser comment-author-bezkoder bypostauthor odd alt depth-2"><article id="div-comment-4772" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/40150b9299e69015bc46c30598a81888.png" srcset="https://secure.gravatar.com/avatar/40150b9299e69015bc46c30598a81888?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">bezkoder</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4772"><time datetime="2020-09-18T00:24:35+00:00">September 18, 2020 at 12:24 am</time></a></div></footer><div class="comment-content"><p>Hi, please look at how we define Sequelize Associations in <code>app/models/index.js</code>. The method <code>user.getRoles()</code> is supported without our implementation.</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4772" data-commentid="4772" data-postid="2033" data-belowelement="div-comment-4772" data-respondelement="respond" data-replyto="Reply to bezkoder" aria-label="Reply to bezkoder">Reply</a></div></article></li></ol></li><li id="comment-4810" class="comment even thread-even depth-1 parent"><article id="div-comment-4810" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/f4a409f5fcadb8a0edfbb54991e6f7cb.png" srcset="https://secure.gravatar.com/avatar/f4a409f5fcadb8a0edfbb54991e6f7cb?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">James</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4810"><time datetime="2020-09-22T00:53:48+00:00">September 22, 2020 at 12:53 am</time></a></div></footer><div class="comment-content"><p>Great guide thank you!<br> Posting this again as you may have missed it.</p><p>In your explanation of folder stucture, you have “middleware”.<br> However you refer to this folder throughout the guide as “middlewares” (plural), when we are creating the files authJwt, index, and verifySignUp.</p><p>But, inside the code, you are importing files from the folder “middleware” (singular).</p><p>Would advise changing to avoid any confusion on why code isn’t working if people are not checking this.</p><p>Again, love all the guides and options you are providing for different stacks.<br> Best,</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4810" data-commentid="4810" data-postid="2033" data-belowelement="div-comment-4810" data-respondelement="respond" data-replyto="Reply to James" aria-label="Reply to James">Reply</a></div></article><ol class="children"><li id="comment-4813" class="comment byuser comment-author-bezkoder bypostauthor odd alt depth-2"><article id="div-comment-4813" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/40150b9299e69015bc46c30598a81888.png" srcset="https://secure.gravatar.com/avatar/40150b9299e69015bc46c30598a81888?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">bezkoder</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4813"><time datetime="2020-09-22T08:27:34+00:00">September 22, 2020 at 8:27 am</time></a></div></footer><div class="comment-content"><p>Hi, thank you for you comment. I’ve just fixed that typo 🙂</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4813" data-commentid="4813" data-postid="2033" data-belowelement="div-comment-4813" data-respondelement="respond" data-replyto="Reply to bezkoder" aria-label="Reply to bezkoder">Reply</a></div></article></li><li id="comment-4826" class="comment even depth-2 parent"><article id="div-comment-4826" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/f4a409f5fcadb8a0edfbb54991e6f7cb.png" srcset="https://secure.gravatar.com/avatar/f4a409f5fcadb8a0edfbb54991e6f7cb?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">James</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4826"><time datetime="2020-09-24T00:48:00+00:00">September 24, 2020 at 12:48 am</time></a></div></footer><div class="comment-content"><p>I also wanted to add to this as I had an issue with the correct board being displayed per the users role.<br> (User, Moderator, Admin)<br> In the auth-header.js file you have the following object being returned to the user.service.js GET requests:</p><p>return { Authorization: “Bearer ” + user.accessToken };</p><p>This results in an error of “No token provided”. as it is looking for the header “x-access-token”, not Authorization.bearer</p><p>I have changed it to reflect the following, which resulted in a correct display of the board being viewed by the users role.</p><p>return { “x-access-token” : user.accessToken };</p><p>If the way in which you have described the object in the guide is correct, could you explain a bit further on how that works?<br> Because I received the error stated above, I have kept my chgange I made until further notice.</p><p>Again, thank you!! 🙂</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4826" data-commentid="4826" data-postid="2033" data-belowelement="div-comment-4826" data-respondelement="respond" data-replyto="Reply to James" aria-label="Reply to James">Reply</a></div></article><ol class="children"><li id="comment-4830" class="comment byuser comment-author-bezkoder bypostauthor odd alt depth-3"><article id="div-comment-4830" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/40150b9299e69015bc46c30598a81888.png" srcset="https://secure.gravatar.com/avatar/40150b9299e69015bc46c30598a81888?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">bezkoder</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4830"><time datetime="2020-09-24T09:27:43+00:00">September 24, 2020 at 9:27 am</time></a></div></footer><div class="comment-content"><p>Hi, it is because I use the frontend for 2 backend:<br> – Spring Boot: using Bearer token<br> – Node.js: using x-access-token</p><p>I write this notification in the frontend tutorial.</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4830" data-commentid="4830" data-postid="2033" data-belowelement="div-comment-4830" data-respondelement="respond" data-replyto="Reply to bezkoder" aria-label="Reply to bezkoder">Reply</a></div></article></li></ol></li></ol></li><li id="comment-4835" class="comment even thread-odd thread-alt depth-1"><article id="div-comment-4835" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/8b75e9d0ee2d83aaae2cbdf7445f20d2.png" srcset="https://secure.gravatar.com/avatar/8b75e9d0ee2d83aaae2cbdf7445f20d2?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Moses</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4835"><time datetime="2020-09-24T15:12:40+00:00">September 24, 2020 at 3:12 pm</time></a></div></footer><div class="comment-content"><p>hey bezkoder,</p><p>I have this error :</p><p>TypeError: Cannot read property ‘username’ of undefined<br> at exports.signin (C:\Users\me\Desktop\env_node\JWT_mysql_node_tut\app\controllers\auth.controller.js:46:26)<br> at Layer.handle [as handle_request] (C:\Users\me\Desktop\env_node\JWT_mysql_node_tut\node_modules\express\lib\router\layer.js:95:5)<br> at next (C:\Users\me\Desktop\env_node\JWT_mysql_node_tut\node_modules\express\lib\router\route.js:137:13)<br> at Route.dispatch (C:\Users\me\Desktop\env_node\JWT_mysql_node_tut\node_modules\express\lib\router\route.js:112:3)<br> at Layer.handle [as handle_request] (C:\Users\me\Desktop\env_node\JWT_mysql_node_tut\node_modules\express\lib\router\layer.js:95:5)<br> at C:\Users\me\Desktop\env_node\JWT_mysql_node_tut\node_modules\express\lib\router\index.js:281:22<br> at Function.process_params (C:\Users\me\Desktop\env_node\JWT_mysql_node_tut\node_modules\express\lib\router\index.js:335:12)<br> at next (C:\Users\me\Desktop\env_node\JWT_mysql_node_tut\node_modules\express\lib\router\index.js:275:10)<br> at C:\Users\me\Desktop\env_node\JWT_mysql_node_tut\app\routes\auth.routes.js:10:5<br> at Layer.handle [as handle_request] (C:\Users\me\Desktop\env_node\JWT_mysql_node_tut\node_modules\express\lib\router\layer.js:95:5)</p><p>and unable to solve it till now. Any solution would be appreciated. Thank you!</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4835" data-commentid="4835" data-postid="2033" data-belowelement="div-comment-4835" data-respondelement="respond" data-replyto="Reply to Moses" aria-label="Reply to Moses">Reply</a></div></article></li><li id="comment-4884" class="comment odd alt thread-even depth-1"><article id="div-comment-4884" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/76e5d653f2fd9a962291e4052b5e0951.png" srcset="https://secure.gravatar.com/avatar/76e5d653f2fd9a962291e4052b5e0951?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Serena Martin</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4884"><time datetime="2020-09-29T04:56:39+00:00">September 29, 2020 at 4:56 am</time></a></div></footer><div class="comment-content"><p>This was incredibly useful. I’ve recently started learning NodeJs. It’s an awesome framework.</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4884" data-commentid="4884" data-postid="2033" data-belowelement="div-comment-4884" data-respondelement="respond" data-replyto="Reply to Serena Martin" aria-label="Reply to Serena Martin">Reply</a></div></article></li><li id="comment-4914" class="comment even thread-odd thread-alt depth-1 parent"><article id="div-comment-4914" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/8279a93ffd987253e9e7237a0f9d07a8.png" srcset="https://secure.gravatar.com/avatar/8279a93ffd987253e9e7237a0f9d07a8?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Ahsan</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4914"><time datetime="2020-10-03T08:32:17+00:00">October 3, 2020 at 8:32 am</time></a></div></footer><div class="comment-content"><p>When i use post api -&gt; localhost:8080/api/auth/signup</p><p>{<br> “username” : “ahmad”,<br> “email” : “ahmad@gmail.com”,<br> “password”: “1245678”,<br> “roles” : [“admin”, “user”]<br> }</p><p>I face this error</p><p>Unhandled rejection Error: WHERE parameter “username” has invalid “undefined” value<br> at MySQLQueryGenerator.whereItemQuery (E:\test\node-js-jwt-auth-master\node_modules\sequelize\lib\dialects\abstract\query-generator.js:2184:13)<br> at E:\test\node-js-jwt-auth-master\node_modules\sequelize\lib\dialects\abstract\query-generator.js:2173:25<br> at Array.forEach ()<br> at MySQLQueryGenerator.whereItemsQuery (E:\test\node-js-jwt-auth-master\node_modules\sequelize\lib\dialects\abstract\query-generator.js:2171:35)<br> at MySQLQueryGenerator.getWhereConditions (E:\test\node-js-jwt-auth-master\node_modules\sequelize\lib\dialects\abstract\query-generator.js:2583:19)<br> at MySQLQueryGenerator.selectQuery (E:\test\node-js-jwt-auth-master\node_modules\sequelize\lib\dialects\abstract\query-generator.js:1315:28)<br> at QueryInterface.select (E:\test\node-js-jwt-auth-master\node_modules\sequelize\lib\query-interface.js:1127:27)<br> at E:\test\node-js-jwt-auth-master\node_modules\sequelize\lib\model.js:1759:34<br> at tryCatcher (E:\test\node-js-jwt-auth-master\node_modules\bluebird\js\release\util.js:16:23)<br> at Promise._settlePromiseFromHandler (E:\test\node-js-jwt-auth-master\node_modules\bluebird\js\release\promise.js:547:31)<br> at Promise._settlePromise (E:\test\node-js-jwt-auth-master\node_modules\bluebird\js\release\promise.js:604:18)<br> at Promise._settlePromise0 (E:\test\node-js-jwt-auth-master\node_modules\bluebird\js\release\promise.js:649:10)<br> at Promise._settlePromises (E:\test\node-js-jwt-auth-master\node_modules\bluebird\js\release\promise.js:729:18)<br> at _drainQueueStep (E:\test\node-js-jwt-auth-master\node_modules\bluebird\js\release\async.js:93:12)<br> at _drainQueue (E:\test\node-js-jwt-auth-master\node_modules\bluebird\js\release\async.js:86:9)<br> at Async._drainQueues (E:\test\node-js-jwt-auth-master\node_modules\bluebird\js\release\async.js:102:5)<br> at Immediate.Async.drainQueues [as _onImmediate] (E:\test\node-js-jwt-auth-master\node_modules\bluebird\js\release\async.js:15:14)<br> at processImmediate (internal/timers.js:456:21)</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4914" data-commentid="4914" data-postid="2033" data-belowelement="div-comment-4914" data-respondelement="respond" data-replyto="Reply to Ahsan" aria-label="Reply to Ahsan">Reply</a></div></article><ol class="children"><li id="comment-4917" class="comment odd alt depth-2 parent"><article id="div-comment-4917" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/8279a93ffd987253e9e7237a0f9d07a8.png" srcset="https://secure.gravatar.com/avatar/8279a93ffd987253e9e7237a0f9d07a8?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Ahsan</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4917"><time datetime="2020-10-04T03:33:22+00:00">October 4, 2020 at 3:33 am</time></a></div></footer><div class="comment-content"><p>Hi!</p><p>I have found solution. When I chose raw option then I selected Text instead of Json option.</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4917" data-commentid="4917" data-postid="2033" data-belowelement="div-comment-4917" data-respondelement="respond" data-replyto="Reply to Ahsan" aria-label="Reply to Ahsan">Reply</a></div></article><ol class="children"><li id="comment-5008" class="comment even depth-3"><article id="div-comment-5008" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/17742d17443203772dd6677012b0bb1a.png" srcset="https://secure.gravatar.com/avatar/17742d17443203772dd6677012b0bb1a?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">James Lee</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-5008"><time datetime="2020-10-12T13:44:12+00:00">October 12, 2020 at 1:44 pm</time></a></div></footer><div class="comment-content"><p>Ok buddy, that’s good</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-5008" data-commentid="5008" data-postid="2033" data-belowelement="div-comment-5008" data-respondelement="respond" data-replyto="Reply to James Lee" aria-label="Reply to James Lee">Reply</a></div></article></li></ol></li></ol></li><li id="comment-4958" class="comment odd alt thread-even depth-1"><article id="div-comment-4958" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/762a313a80ff88c010ecf7ca7d4965bf.png" srcset="https://secure.gravatar.com/avatar/762a313a80ff88c010ecf7ca7d4965bf?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Jirka</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4958"><time datetime="2020-10-08T08:55:47+00:00">October 8, 2020 at 8:55 am</time></a></div></footer><div class="comment-content"><p>Hi and thx for very nice tutorial!<br> I have problem when I try to login with non-existing user – the node screams about UnhandledPromiseRejectionWarning but I don’t know how and what block should I put inside the try-catch to satisfy node. Do I have to somehow modify app.post(“/api/auth/signin”, controller.signin); ? The findOne already has catch. When I change the exports.signin into exports.signin = async (req, res) =&gt; {try {…} catch (err) {..} it isn’t solving the problem. Thank you very much!</p><p>Executing (default): SELECT “id”, “username”, “email”, “password”, “createdAt”, “updatedAt” FROM “users” AS “users” WHERE “users”.”username” = ‘testuser’ LIMIT 1;<br> (node:19868) UnhandledPromiseRejectionWarning: Error: WHERE parameter “email” has invalid “undefined” value (…)<br> at async Function.findOne (node_modules\sequelize\lib\model.js:1917:12)<br> (node:19868) UnhandledPromiseRejectionWarning: Unhandled promise rejection. This error originated either by throwing inside of an async function without a catch block, or by rejecting a promise which was not handled with .catch(). To terminate the node process on unhandled promise rejection, use the CLI flag `–unhandled-rejections=strict` (see <a href="https://nodejs.org/api/cli.html#cli_unhandled_rejections_mode" rel="nofollow ugc">https://nodejs.org/api/cli.html#cli_unhandled_rejections_mode</a>). (rejection id: 2)<br> (node:19868) [DEP0018] DeprecationWarning: Unhandled promise rejections are deprecated. In the future, promise rejections that are not handled will terminate the Node.js process with a non-zero exit code.</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4958" data-commentid="4958" data-postid="2033" data-belowelement="div-comment-4958" data-respondelement="respond" data-replyto="Reply to Jirka" aria-label="Reply to Jirka">Reply</a></div></article></li><li id="comment-4993" class="comment even thread-odd thread-alt depth-1"><article id="div-comment-4993" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/a433857e4057c188191dcc835f500489.jpeg" srcset="https://secure.gravatar.com/avatar/a433857e4057c188191dcc835f500489?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Yugesh Devtare</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4993"><time datetime="2020-10-11T07:40:07+00:00">October 11, 2020 at 7:40 am</time></a></div></footer><div class="comment-content"><p>Hey, great work!<br> I had a question, How can we directly set roles for the user using a form from the frontend rather than using postman?</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4993" data-commentid="4993" data-postid="2033" data-belowelement="div-comment-4993" data-respondelement="respond" data-replyto="Reply to Yugesh Devtare" aria-label="Reply to Yugesh Devtare">Reply</a></div></article></li><li id="comment-4998" class="comment odd alt thread-even depth-1"><article id="div-comment-4998" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/347ec7653914141676d823cfdce2e15f.png" srcset="https://secure.gravatar.com/avatar/347ec7653914141676d823cfdce2e15f?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Yugesh Devtare</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4998"><time datetime="2020-10-11T20:25:22+00:00">October 11, 2020 at 8:25 pm</time></a></div></footer><div class="comment-content"><p>How can we directly set roles for the user using a form from the frontend rather than using postman?</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-4998" data-commentid="4998" data-postid="2033" data-belowelement="div-comment-4998" data-respondelement="respond" data-replyto="Reply to Yugesh Devtare" aria-label="Reply to Yugesh Devtare">Reply</a></div></article></li><li id="comment-5007" class="comment even thread-odd thread-alt depth-1"><article id="div-comment-5007" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/c30b0731f7cbc0eec679ee55a1ec24f8.png" srcset="https://secure.gravatar.com/avatar/c30b0731f7cbc0eec679ee55a1ec24f8?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">mave</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-5007"><time datetime="2020-10-12T09:55:46+00:00">October 12, 2020 at 9:55 am</time></a></div></footer><div class="comment-content"><p>Running Ubuntu 20.04</p><p>It returns Cannot GET /api/auth/signin and Cannot GET /api/auth/signup. It does let me have access to the /api/test/user and /api/test/mod and /api/test/admin (these show {“message”:”No token provided!”}) and /api/test/all (shows Public Content.)</p><p>Does anyone know the issue?</p><p>Been trying to integrate the <a href="https://bezkoder.com/angular-10-jwt-auth/" rel="nofollow ugc">https://bezkoder.com/angular-10-jwt-auth/</a> into this. Does anyone know how to do it? Please share if you have any example?</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-5007" data-commentid="5007" data-postid="2033" data-belowelement="div-comment-5007" data-respondelement="respond" data-replyto="Reply to mave" aria-label="Reply to mave">Reply</a></div></article></li><li id="comment-5178" class="comment odd alt thread-even depth-1"><article id="div-comment-5178" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/899cdef2a458d6763048269db979f40f.png" srcset="https://secure.gravatar.com/avatar/899cdef2a458d6763048269db979f40f?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Lee Soon Fatt</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-5178"><time datetime="2020-10-24T08:22:00+00:00">October 24, 2020 at 8:22 am</time></a></div></footer><div class="comment-content"><p>hi there,</p><p>i have an error for “message”: “No token provided!” and inside my postman there is no x-access token. is there something that I am missing ? on my postman there is content-type but not x-access</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-5178" data-commentid="5178" data-postid="2033" data-belowelement="div-comment-5178" data-respondelement="respond" data-replyto="Reply to Lee Soon Fatt" aria-label="Reply to Lee Soon Fatt">Reply</a></div></article></li><li id="comment-5233" class="comment even thread-odd thread-alt depth-1"><article id="div-comment-5233" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/a433857e4057c188191dcc835f500489.jpeg" srcset="https://secure.gravatar.com/avatar/a433857e4057c188191dcc835f500489?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Yugesh Devtare</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-5233"><time datetime="2020-10-29T07:46:06+00:00">October 29, 2020 at 7:46 am</time></a></div></footer><div class="comment-content"><p>hello, how can retrieve a list of all the “mod” or “superadmin” from the table?</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-5233" data-commentid="5233" data-postid="2033" data-belowelement="div-comment-5233" data-respondelement="respond" data-replyto="Reply to Yugesh Devtare" aria-label="Reply to Yugesh Devtare">Reply</a></div></article></li><li id="comment-5260" class="comment odd alt thread-even depth-1 parent"><article id="div-comment-5260" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/39227c60ab608ccb3134d95a726bb0d1.png" srcset="https://secure.gravatar.com/avatar/39227c60ab608ccb3134d95a726bb0d1?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Helmindra</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-5260"><time datetime="2020-11-01T17:43:24+00:00">November 1, 2020 at 5:43 pm</time></a></div></footer><div class="comment-content"><p>Hello, I;m stuck in “Unhandled rejection Error: WHERE parameter “username” has invalid “undefined” value”<br> i do :<br> // parse requests of content-type – application/json<br> app.use(bodyParser.json());</p><p>// parse requests of content-type – application/x-www-form-urlencoded<br> app.use(bodyParser.urlencoded({ extended: true }));</p><p>And below it i put :</p><p>// routes<br> require(‘./app/routes/auth.routes’)(app);<br> require(‘./app/routes/user.routes’)(app);</p><p>Trying restart “node server.js” several times like a mention in comment before ,but still no luck still getting that error , maybe someone can help to resolve it ?. – Thanks –</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-5260" data-commentid="5260" data-postid="2033" data-belowelement="div-comment-5260" data-respondelement="respond" data-replyto="Reply to Helmindra" aria-label="Reply to Helmindra">Reply</a></div></article><ol class="children"><li id="comment-5672" class="comment even depth-2"><article id="div-comment-5672" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/f9c30020440476c1c939edeeeeca1796.png" srcset="https://secure.gravatar.com/avatar/f9c30020440476c1c939edeeeeca1796?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">DCespedesH</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-5672"><time datetime="2020-12-06T00:52:13+00:00">December 6, 2020 at 12:52 am</time></a></div></footer><div class="comment-content"><p>Hi, as mentioned by Ahsan some days ago, in postman you should change the input from raw text to raw JSON and then you’ll have a success message.</p><p>I was stuck with this some time until noticed that.</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-5672" data-commentid="5672" data-postid="2033" data-belowelement="div-comment-5672" data-respondelement="respond" data-replyto="Reply to DCespedesH" aria-label="Reply to DCespedesH">Reply</a></div></article></li></ol></li><li id="comment-5266" class="comment odd alt thread-odd thread-alt depth-1 parent"><article id="div-comment-5266" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/002397392fb55df798ddc4f7bd5a93dc.png" srcset="https://secure.gravatar.com/avatar/002397392fb55df798ddc4f7bd5a93dc?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Erick</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-5266"><time datetime="2020-11-02T15:13:19+00:00">November 2, 2020 at 3:13 pm</time></a></div></footer><div class="comment-content"><p>Thank you for this tutorial. I’m facing these messages when I try to restart node server.js:<br> (node:14036) [SEQUELIZE0004] DeprecationWarning: A boolean value was passed to options.operatorsAliases. This is a no-op with v5 and should be removed.</p><p>Server is running on port 8080.</p><p>(node:14036) UnhandledPromiseRejectionWarning: SequelizeConnectionRefusedError: connect ECONNREFUSED 127.0.0.1:3306<br> at ConnectionManager.connect (C:\Users\RARibeiro\OneDrive\ECOSTEEL\node-js-jwt-auth\node_modules\sequelize\lib\dialects\mysql\connection-manager.js:116:17)<br> at processTicksAndRejections (internal/process/task_queues.js:97:5)</p><p>(node:14036) UnhandledPromiseRejectionWarning: Unhandled promise rejection. This error originated either by throwing inside of an async function without a catch block, or by rejecting a promise which was not handled with .catch(). To terminate the node process on unhandled promise rejection, use the CLI flag `–unhandled-rejections=strict` (see <a href="https://nodejs.org/api/cli.html#cli_unhandled_rejections_mode" rel="nofollow ugc">https://nodejs.org/api/cli.html#cli_unhandled_rejections_mode</a>). (rejection id: 1)</p><p>(node:14036) [DEP0018] DeprecationWarning: Unhandled promise rejections are deprecated. In the future, promise rejections that are not handled will terminate the Node.js process with a non-zero exit code.</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-5266" data-commentid="5266" data-postid="2033" data-belowelement="div-comment-5266" data-respondelement="respond" data-replyto="Reply to Erick" aria-label="Reply to Erick">Reply</a></div></article><ol class="children"><li id="comment-5856" class="comment even depth-2 parent"><article id="div-comment-5856" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/5b7b7bbfd6310b60f7d2267fa9903240.png" srcset="https://secure.gravatar.com/avatar/5b7b7bbfd6310b60f7d2267fa9903240?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">mark</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-5856"><time datetime="2020-12-20T08:19:55+00:00">December 20, 2020 at 8:19 am</time></a></div></footer><div class="comment-content"><p>I run into the same issue. This shows up when trying to setup the alternative postgres project.</p><p>Haven’t found a solution yet.</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-5856" data-commentid="5856" data-postid="2033" data-belowelement="div-comment-5856" data-respondelement="respond" data-replyto="Reply to mark" aria-label="Reply to mark">Reply</a></div></article><ol class="children"><li id="comment-5866" class="comment byuser comment-author-bezkoder bypostauthor odd alt depth-3"><article id="div-comment-5866" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/40150b9299e69015bc46c30598a81888.png" srcset="https://secure.gravatar.com/avatar/40150b9299e69015bc46c30598a81888?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">bezkoder</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-5866"><time datetime="2020-12-21T07:10:40+00:00">December 21, 2020 at 7:10 am</time></a></div></footer><div class="comment-content"><p>Hi, for Postgres, please visit:<br> <a href="https://bezkoder.com/node-js-jwt-authentication-postgresql/">Node.js JWT Authentication with PostgreSQL example</a></p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-5866" data-commentid="5866" data-postid="2033" data-belowelement="div-comment-5866" data-respondelement="respond" data-replyto="Reply to bezkoder" aria-label="Reply to bezkoder">Reply</a></div></article></li></ol></li></ol></li><li id="comment-5637" class="comment even thread-even depth-1"><article id="div-comment-5637" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/d6e310274b2126fe81d4361dfbecc09a.png" srcset="https://secure.gravatar.com/avatar/d6e310274b2126fe81d4361dfbecc09a?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Subash</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-5637"><time datetime="2020-12-03T09:11:46+00:00">December 3, 2020 at 9:11 am</time></a></div></footer><div class="comment-content"><p>Hello  bezkoder, when I try to signup users using Postman, I get a error response saying socket hang up or read Econnreset. Can you help me with it?<br> All other get requests work perfectly fine.</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-5637" data-commentid="5637" data-postid="2033" data-belowelement="div-comment-5637" data-respondelement="respond" data-replyto="Reply to Subash" aria-label="Reply to Subash">Reply</a></div></article></li><li id="comment-5692" class="comment odd alt thread-odd thread-alt depth-1"><article id="div-comment-5692" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/f5769b1b517ebeef4e8262aa8905efc8.png" srcset="https://secure.gravatar.com/avatar/f5769b1b517ebeef4e8262aa8905efc8?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Carlos</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-5692"><time datetime="2020-12-08T17:31:58+00:00">December 8, 2020 at 5:31 pm</time></a></div></footer><div class="comment-content"><p>Hello bezkoder … Thanks for this post … Congrats from Colombia!</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-5692" data-commentid="5692" data-postid="2033" data-belowelement="div-comment-5692" data-respondelement="respond" data-replyto="Reply to Carlos" aria-label="Reply to Carlos">Reply</a></div></article></li><li id="comment-5943" class="comment even thread-even depth-1"><article id="div-comment-5943" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/ab4605229392f47406e914d6a7be325a.png" srcset="https://secure.gravatar.com/avatar/ab4605229392f47406e914d6a7be325a?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">Alan</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-5943"><time datetime="2020-12-28T01:14:26+00:00">December 28, 2020 at 1:14 am</time></a></div></footer><div class="comment-content"><p>Excellent tutorial. I am trying to convert to typescript, but it has a lot of errors. Do you have any examples with TS?<br> Thanks,</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-5943" data-commentid="5943" data-postid="2033" data-belowelement="div-comment-5943" data-respondelement="respond" data-replyto="Reply to Alan" aria-label="Reply to Alan">Reply</a></div></article></li><li id="comment-6238" class="comment odd alt thread-odd thread-alt depth-1"><article id="div-comment-6238" class="comment-body"><footer class="comment-meta"><div class="comment-author vcard"> <img alt="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/c3ed6dca6a00a638b3bbba09047eb7de.png" srcset="https://secure.gravatar.com/avatar/c3ed6dca6a00a638b3bbba09047eb7de?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy"> <b class="fn">thanhps</b> <span class="says">says:</span></div><div class="comment-metadata"> <a href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-6238"><time datetime="2021-01-14T07:15:10+00:00">January 14, 2021 at 7:15 am</time></a></div></footer><div class="comment-content"><p>Hi, great tutorial. I have one question how to inital roleId &amp; userId ?</p></div><div class="reply"><a rel="nofollow" class="comment-reply-link btn btn-sm btn-default" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#comment-6238" data-commentid="6238" data-postid="2033" data-belowelement="div-comment-6238" data-respondelement="respond" data-replyto="Reply to thanhps" aria-label="Reply to thanhps">Reply</a></div></article></li></ol><div id="respond" class="comment-respond"><h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="https://bezkoder.com/node-js-jwt-authentication-mysql/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://bezkoder.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate=""><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">Comment</label><textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" required="required"></p><p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" aria-describedby="email-notes" required="required"></p><p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200"></p><p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes"> <label for="wp-comment-cookies-consent">Save my name, email, and website in this browser for the next time I comment.</label></p><p class="form-submit"><input name="submit" type="submit" id="submit" class="submit btn btn-default" value="Post Comment"> <input type="hidden" name="comment_post_ID" value="2033" id="comment_post_ID"> <input type="hidden" name="comment_parent" id="comment_parent" value="0"></p></form></div></div><nav class="navigation post-navigation" role="navigation" aria-label="Posts"><h2 class="screen-reader-text">Post navigation</h2><div class="nav-links"><div class="nav-previous"><a href="https://bezkoder.com/vue-firebase-realtime-database/" rel="prev"><i class="fa fa-chevron-left"></i> <span class="post-title">Vue Firebase Realtime Database: CRUD example</span></a></div><div class="nav-next"><a href="https://bezkoder.com/vue-firestore-crud/" rel="next"><span class="post-title">Vue Firestore: Build a CRUD App example <i class="fa fa-chevron-right"></i></span></a></div></div></nav></main></div></div><div id="secondary" class="widget-area col-sm-12 col-md-4" role="complementary"><div class="well q2w3-fixed-widget-container" style=""><aside id="search-4" class="widget widget_search"><form role="search" method="get" class="form-search" action="https://bezkoder.com/"><div class="input-group"> <label class="screen-reader-text" for="s">Search for:</label> <input type="text" class="form-control search-query" placeholder="Search…" value="" name="s" title="Search for:"> <span class="input-group-btn"> <button type="submit" class="btn btn-default" name="submit" id="searchsubmit" value="Search"><span class="glyphicon glyphicon-search"></span></button> </span></div></form></aside><aside id="custom_html-2" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><script async="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/f.txt"></script> <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9222145312954144" data-ad-slot="2898318826" data-ad-format="auto" data-full-width-responsive="true"></ins> <script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div></aside><aside id="custom_html-8" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><script async="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/f.txt"></script> <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9222145312954144" data-ad-slot="9463360895" data-ad-format="auto" data-full-width-responsive="true"></ins> <script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div></aside><aside id="custom_html-3" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><div class="aicp"> <script async="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/f.txt"></script> <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9222145312954144" data-ad-slot="2454970851" data-ad-format="auto" data-full-width-responsive="true"></ins> <script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div></div></aside><aside id="custom_html-4" class="widget_text widget widget_custom_html" style=""><div class="textwidget custom-html-widget"><div class="aicp"> <script async="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/f.txt"></script> <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-9222145312954144" data-ad-slot="2128162633" data-ad-format="auto" data-full-width-responsive="true"></ins> <script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div></div></aside></div></div></div></div></div><div id="footer-area" style="margin-top: 50px;"><div class="container footer-inner"><div class="row"><div class="footer-widget-area"><div class="col-sm-4 footer-widget" role="complementary"><div id="sparkling-social-3" class="widget sparkling-social"><h3 class="widgettitle">Follow us</h3><div class="social-icons sticky-sidebar-social"><nav id="menu-social" class="social-icons"><ul id="menu-social-items" class="social-menu"><li id="menu-item-32" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-32"><a href="https://facebook.com/bezkoder"><i class="social_icon"><span>Facebook</span></i></a></li><li id="menu-item-37" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-37"><a href="https://www.youtube.com/channel/UCp0mx9RH0JxaFsmMvKXA86Q"><i class="social_icon"><span>Youtube</span></i></a></li><li id="menu-item-1212" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1212"><a href="https://github.com/bezkoder"><i class="social_icon"><span>Github</span></i></a></li></ul></nav></div></div></div><div class="col-sm-4 footer-widget" role="complementary"><div id="nav_menu-2" class="widget widget_nav_menu"><h3 class="widgettitle">Tools</h3><div class="menu-tools-container"><ul id="menu-tools" class="menu"><li id="menu-item-2008" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2008"><a href="https://bezkoder.com/json-formatter/">Json Formatter</a></li></ul></div></div></div><div class="col-sm-4 footer-widget" role="complementary"><div id="custom_html-9" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><a href="https://www.dmca.com/Protection/Status.aspx?ID=3f543dd5-c6d8-4208-9a6b-0e92057fd597&amp;refurl=https://bezkoder.com/node-js-jwt-authentication-mysql/" title="DMCA.com Protection Status" class="dmca-badge"> <img src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/dmca-badge-w150-5x1-08.png" alt="DMCA.com Protection Status"></a> <script src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/DMCABadgeHelper.min.js.download"></script></div></div></div></div></div></div><footer id="colophon" class="site-footer" role="contentinfo"><div class="site-info container"><div class="row"><nav role="navigation" class="col-md-6"><ul id="menu-footer-links" class="nav footer-nav clearfix"><li id="menu-item-131" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-131"><a href="https://bezkoder.com/">Home</a></li><li id="menu-item-130" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-privacy-policy menu-item-130"><a href="https://bezkoder.com/privacy-policy/">Privacy Policy</a></li><li id="menu-item-142" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-142"><a href="https://bezkoder.com/contact-us/">Contact Us</a></li><li id="menu-item-141" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-141"><a href="https://bezkoder.com/about/">About Us</a></li></ul></nav><div class="copyright col-md-6"> BezKoder 2019</div></div></div><div class="scroll-to-top" style="display: block;"><i class="fa fa-angle-up"></i></div></footer></div></div> <script type="text/javascript">jQuery(document).ready(function ($) {
 if ($(window).width() >= 767) {
 $('.navbar-nav > li.menu-item > a').click(function () {
 if ($(this).attr('target') !== '_blank') {
 window.location = $(this).attr('href')
 }
 })
 }
 })</script><div id="cookie-law-info-bar" data-nosnippet="true" style="background-color: rgb(255, 255, 255); color: rgb(56, 56, 56); font-family: inherit; bottom: 0px; position: fixed; display: block;"><span>We use cookies to improve your experience with the site. To find out more, you can read the full <a href="https://bezkoder.com/privacy-policy/" id="CONSTANT_OPEN_URL" target="_blank" class="cli-plugin-main-link" style="display: inline-block; margin: 5px 20px 5px 0px; color: rgb(221, 51, 51);">Privacy &amp; Policy</a><a role="button" tabindex="0" data-cli_action="accept" id="cookie_action_close_header" class="medium cli-plugin-button cli-plugin-main-button cookie_action_close_header cli_action_button" style="display: inline-block; margin: 5px; color: rgb(221, 51, 51); background-color: rgb(234, 234, 234);">Accept</a></span></div><div id="cookie-law-info-again" style="display: none; background-color: rgb(255, 255, 255); color: rgb(56, 56, 56); position: fixed; font-family: inherit; width: auto; bottom: 0px; right: 100px;" data-nosnippet="true"><span id="cookie_hdr_showagain">Privacy &amp; Cookies Policy</span></div><div class="cli-modal" data-nosnippet="true" id="cliSettingsPopup" tabindex="-1" role="dialog" aria-labelledby="cliSettingsPopup" aria-hidden="true"><div class="cli-modal-dialog" role="document"><div class="cli-modal-content cli-bar-popup"> <button type="button" class="cli-modal-close" id="cliModalClose"> <svg class="" viewBox="0 0 24 24"><path d="M19 6.41l-1.41-1.41-5.59 5.59-5.59-5.59-1.41 1.41 5.59 5.59-5.59 5.59 1.41 1.41 5.59-5.59 5.59 5.59 1.41-1.41-5.59-5.59z"></path><path d="M0 0h24v24h-24z" fill="none"></path></svg> <span class="wt-cli-sr-only">Close</span> </button><div class="cli-modal-body"><div class="cli-container-fluid cli-tab-container"><div class="cli-row"><div class="cli-col-12 cli-align-items-stretch cli-px-0"><div class="cli-privacy-overview"><h4>Privacy Overview</h4><div class="cli-privacy-content"><div class="cli-privacy-content-text">This website uses cookies to improve your experience while you navigate through the website. Out of these cookies, the cookies that are categorized as necessary are stored on your browser as they are essential for the working of basic functionalities...</div></div> <a class="cli-privacy-readmore" data-readmore-text="Show more" data-readless-text="Show less"></a></div></div><div class="cli-col-12 cli-align-items-stretch cli-px-0 cli-tab-section-container"><div class="cli-tab-section"><div class="cli-tab-header"> <a role="button" tabindex="0" class="cli-nav-link cli-settings-mobile" data-target="necessary" data-toggle="cli-toggle-tab"> Necessary </a><div class="wt-cli-necessary-checkbox"> <input type="checkbox" class="cli-user-preference-checkbox" id="wt-cli-checkbox-necessary" data-id="checkbox-necessary" checked="checked"> <label class="form-check-label" for="wt-cli-checkbox-necessary">Necessary</label></div> <span class="cli-necessary-caption">Always Enabled</span></div><div class="cli-tab-content"><div class="cli-tab-pane cli-fade" data-id="necessary"><p>Necessary cookies are absolutely essential for the website to function properly. This category only includes cookies that ensures basic functionalities and security features of the website. These cookies do not store any personal information.</p></div></div></div><div class="cli-tab-section"><div class="cli-tab-header"> <a role="button" tabindex="0" class="cli-nav-link cli-settings-mobile" data-target="non-necessary" data-toggle="cli-toggle-tab"> Non-necessary </a><div class="cli-switch"> <input type="checkbox" id="wt-cli-checkbox-non-necessary" class="cli-user-preference-checkbox" data-id="checkbox-non-necessary" checked="checked"> <label for="wt-cli-checkbox-non-necessary" class="cli-slider" data-cli-enable="Enabled" data-cli-disable="Disabled"><span class="wt-cli-sr-only">Non-necessary</span></label></div></div><div class="cli-tab-content"><div class="cli-tab-pane cli-fade" data-id="non-necessary"><p>Any cookies that may not be particularly necessary for the website to function and is used specifically to collect user personal data via analytics, ads, other embedded contents are termed as non-necessary cookies. It is mandatory to procure user consent prior to running these cookies on your website.</p></div></div></div></div></div></div></div></div></div></div><div class="cli-modal-backdrop cli-fade cli-settings-overlay"></div><div class="cli-modal-backdrop cli-fade cli-popupbar-overlay"></div> <script type="text/javascript" id="toc-front-js-extra">var tocplus = {"visibility_show":"show","visibility_hide":"hide","width":"Auto"};</script> <script type="text/javascript" id="q2w3_fixed_widget-js-extra">var q2w3_sidebar_options = [{"sidebar":"sidebar-1","margin_top":10,"margin_bottom":500,"stop_id":"fixed-sidebar-widget","screen_max_width":900,"screen_max_height":0,"width_inherit":false,"refresh_interval":1500,"window_load_hook":false,"disable_mo_api":false,"widgets":["custom_html-4"]}];</script> <script defer="" src="./Node.js Express_ JWT example _ Token Based Authentication &amp; Authorization - BezKoder_files/autoptimize_82a13780e78c3080235576ad9b83ac5e.js.download"></script></body></html>